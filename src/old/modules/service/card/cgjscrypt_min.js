function cgjsCrypt(){function b(c){if(!c){c=8}var d=new Array(c);var f=[];for(var e=0;e<256;e++){f[e]=e}for(e=0;e<d.length;e++){d[e]=f[Math.floor(Math.random()*f.length)]}return d}this.setDefaults=function(){this.params.nBits=256;this.params.salt=b(8);this.params.salt=cgjsCryptUtil.byteArray2String(this.params.salt);this.params.salt=cgjsCryptUtil.convertToHex(this.params.salt);this.params.blockSize=16;this.params.UTF8=true;this.params.A0_PAD=true};this.debug=true;this.params={};this.params.dataIn="";this.params.dataOut="";this.params.decryptIn="";this.params.decryptOut="";this.params.encryptIn="";this.params.encryptOut="";this.params.key="";this.params.iv="";this.params.clear=true;this.setDefaults();this.errors="";this.warnings="";this.infos="";this.debugMsg="";this.setParams=function(d){if(!d){d={}}for(var c in d){this.params[c]=d[c]}};this.getParams=function(){return this.params};this.getParam=function(c){return this.params[c]||""};this.clearParams=function(){this.params={}};this.getNBits=function(){return this.params.nBits};this.getOutput=function(){return this.params.dataOut};this.setError=function(c){this.error=c};this.appendError=function(c){this.errors+=c;return""};this.getErrors=function(){return this.errors};this.isError=function(){if(this.errors.length>0){return true}return false};this.appendInfo=function(c){this.infos+=c;return""};this.getInfos=function(){return this.infos};this.setDebug=function(c){this.debug=c};this.appendDebug=function(c){this.debugMsg+=c;return""};this.isDebug=function(){return this.debug};this.getAllMessages=function(e){var i={lf:"\n",clr_mes:false,verbose:15};if(!e){e=i}for(var j in i){if(typeof(e[j])=="undefined"){e[j]=i[j]}}var c="";var f="";for(var h in this.params){switch(h){case"encryptOut":f=cgjsCryptUtil.toByteArray(this.params[h].toString());f=cgjsCryptUtil.fragment(f.join(),64,e.lf);break;case"key":case"iv":f=cgjsCryptUtil.formatHex(this.params[h],48);break;default:f=cgjsCryptUtil.fragment(this.params[h].toString(),64,e.lf)}c+="<p><b>"+h+"</b>:<pre>"+f+"</pre></p>"}if(this.debug){c+="debug: "+this.debug+e.lf}if(this.errors.length>0&&((e.verbose&1)==1)){c+="Errors:"+e.lf+this.errors+e.lf}if(this.warnings.length>0&&((e.verbose&2)==2)){c+="Warnings:"+e.lf+this.warnings+e.lf}if(this.infos.length>0&&((e.verbose&4)==4)){c+="Infos:"+e.lf+this.infos+e.lf}if(this.debug&&((e.verbose&8)==8)){c+="Debug messages:"+e.lf+this.debugMsg+e.lf}if(e.clr_mes){this.errors=this.infos=this.warnings=this.debug=""}return c};this.getRandomBytes=function(c){return b(c)}}cgjsCryptUtil={};cgjsCryptUtil.encodeBase64=function(v,y){if(!v){v=""}var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";y=(typeof y=="undefined")?false:y;var h,d,b,B,w,o,n,j,m=[],f="",u,A,r;A=y?cgjsCryptUtil.encodeUTF8(v):v;u=A.length%3;if(u>0){while(u++<3){f+="=";A+="\0"}}for(u=0;u<A.length;u+=3){h=A.charCodeAt(u);d=A.charCodeAt(u+1);b=A.charCodeAt(u+2);B=h<<16|d<<8|b;w=B>>18&63;o=B>>12&63;n=B>>6&63;j=B&63;m[u/3]=i.charAt(w)+i.charAt(o)+i.charAt(n)+i.charAt(j)}r=m.join("");r=r.slice(0,r.length-f.length)+f;return r};cgjsCryptUtil.decodeBase64=function(v,f){if(!v){v=""}var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";f=(typeof f=="undefined")?false:f;var h,e,b,w,o,m,j,A,n=[],y,u;u=f?cgjsCryptUtil.decodeUTF8(v):v;for(var r=0;r<u.length;r+=4){w=i.indexOf(u.charAt(r));o=i.indexOf(u.charAt(r+1));m=i.indexOf(u.charAt(r+2));j=i.indexOf(u.charAt(r+3));A=w<<18|o<<12|m<<6|j;h=A>>>16&255;e=A>>>8&255;b=A&255;n[r/4]=String.fromCharCode(h,e,b);if(j==64){n[r/4]=String.fromCharCode(h,e)}if(m==64){n[r/4]=String.fromCharCode(h)}}y=n.join("");y=f?cgjsCryptUtil.decodeUTF8(y):y;return y};cgjsCryptUtil.encodeUTF8=function(b){if(!b){b=""}b=b.replace(/[\u0080-\u07ff]/g,function(e){var d=e.charCodeAt(0);return String.fromCharCode(192|d>>6,128|d&63)});b=b.replace(/[\u0800-\uffff]/g,function(e){var d=e.charCodeAt(0);return String.fromCharCode(224|d>>12,128|d>>6&63,128|d&63)});return b};cgjsCryptUtil.decodeUTF8=function(b){if(!b){b=""
}b=b.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(e){var d=(e.charCodeAt(0)&31)<<6|e.charCodeAt(1)&63;return String.fromCharCode(d)});b=b.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(e){var d=((e.charCodeAt(0)&15)<<12)|((e.charCodeAt(1)&63)<<6)|(e.charCodeAt(2)&63);return String.fromCharCode(d)});return b};cgjsCryptUtil.convertToHex=function(e){if(!e){e=""}var d="";var b="";for(var c=0;c<e.length;c++){b=e.charCodeAt(c).toString(16);d+=(b.length==1)?"0"+b:b}return d};cgjsCryptUtil.convertFromHex=function(d){if(!d){d=""}var c="";for(var b=0;b<d.length;b+=2){c+=String.fromCharCode(parseInt(d.substring(b,b+2),16))}return c};cgjsCryptUtil.stripLineFeeds=function(c){if(!c){c=""}var b="";b=c.replace(/\n/g,"");b=b.replace(/\r/g,"");return b};cgjsCryptUtil.toByteArray=function(c){if(!c){c=""}var d=[];for(var b=0;b<c.length;b++){d[b]=c.charCodeAt(b)}return d};cgjsCryptUtil.fragment=function(f,e,b){if(!f){f=""}if(!e||e>=f.length){return f}if(!b){b="\n"}var d="";for(var c=0;c<f.length;c+=e){d+=f.substr(c,e)+b}return d};cgjsCryptUtil.formatHex=function(h,f){if(!h){h=""}if(!f){f=45}var b="";var c=0;var e=h.toLowerCase();for(var d=0;d<e.length;d+=2){b+=e.substr(d,2)+":"}e=this.fragment(b,f);return e};cgjsCryptUtil.byteArray2String=function(c){var e="";for(var d=0;d<c.length;d++){e+=String.fromCharCode(c[d])}return e};function Stream(b,c){if(b instanceof Stream){this.enc=b.enc;this.pos=b.pos}else{this.enc=b;this.pos=c}}Stream.prototype.parseStringHex=function(f,b){if(typeof(b)=="undefined"){b=this.enc.length}var e="";for(var c=f;c<b;++c){var d=this.get(c);e+=this.hexDigits.charAt(d>>4)+this.hexDigits.charAt(d&15)}return e};Stream.prototype.get=function(b){if(b==undefined){b=this.pos++}if(b>=this.enc.length){throw"Requesting byte offset "+b+" on a stream of length "+this.enc.length}return this.enc[b]};Stream.prototype.hexDigits="0123456789ABCDEF";Stream.prototype.hexDump=function(f,b){var e="";for(var c=f;c<b;++c){var d=this.get(c);e+=this.hexDigits.charAt(d>>4)+this.hexDigits.charAt(d&15);if((c&15)==7){e+=" "}e+=((c&15)==15)?"\n":" "}return e};Stream.prototype.parseStringISO=function(e,b){var d="";for(var c=e;c<b;++c){d+=String.fromCharCode(this.get(c))}return d};Stream.prototype.parseStringUTF=function(h,b){var e="",f=0;for(var d=h;d<b;){var f=this.get(d++);if(f<128){e+=String.fromCharCode(f)}else{if((f>191)&&(f<224)){e+=String.fromCharCode(((f&31)<<6)|(this.get(d++)&63))}else{e+=String.fromCharCode(((f&15)<<12)|((this.get(d++)&63)<<6)|(this.get(d++)&63))}}}return e};Stream.prototype.reTime=/^((?:1[89]|2\d)?\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/;Stream.prototype.parseTime=function(e,c){var d=this.parseStringISO(e,c);var b=this.reTime.exec(d);if(!b){return"Unrecognized time: "+d}d=b[1]+"-"+b[2]+"-"+b[3]+" "+b[4];if(b[5]){d+=":"+b[5];if(b[6]){d+=":"+b[6];if(b[7]){d+="."+b[7]}}}if(b[8]){d+=" UTC";if(b[8]!="Z"){d+=b[8];if(b[9]){d+=":"+b[9]}}}return d};Stream.prototype.parseInteger=function(e,b){if((b-e)>4){return undefined}var d=0;for(var c=e;c<b;++c){d=(d<<8)|this.get(c)}return d};Stream.prototype.parseOID=function(j,b){var e,h=0,f=0;for(var d=j;d<b;++d){var c=this.get(d);h=(h<<7)|(c&127);f+=7;if(!(c&128)){if(e==undefined){e=parseInt(h/40)+"."+(h%40)}else{e+="."+((f>=31)?"big":h)}h=f=0}e+=String.fromCharCode()}return e};if(typeof(cgjsCrypt)!="undefined"){cgjsCrypt.ASN1=function(e,f,d,b,c){this.stream=e;this.header=f;this.length=d;this.tag=b;this.sub=c};cgjsCrypt.ASN1.prototype.toHexTree=function(){var d={};d.type=this.typeName();if(d.type!="SEQUENCE"){d.value=this.stream.parseStringHex(this.posContent(),this.posEnd())}if(this.sub!=null){d.sub=[];for(var c=0,b=this.sub.length;c<b;++c){d.sub[c]=this.sub[c].toHexTree()}}return d};cgjsCrypt.ASN1.prototype.typeName=function(){if(this.tag==undefined){return"unknown"}var d=this.tag>>6;var b=(this.tag>>5)&1;var c=this.tag&31;switch(d){case 0:switch(c){case 0:return"EOC";case 1:return"BOOLEAN";
case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString";default:return"Universal_"+c.toString(16)}case 1:return"Application_"+c.toString(16);case 2:return"["+c+"]";case 3:return"Private_"+c.toString(16)}};cgjsCrypt.ASN1.prototype.content=function(){if(this.tag==undefined){return null}var e=this.tag>>6;if(e!=0){return null}var c=this.tag&31;var d=this.posContent();var b=Math.abs(this.length);switch(c){case 1:return(this.stream.get(d)==0)?"false":"true";case 2:return this.stream.parseInteger(d,d+b);case 6:return this.stream.parseOID(d,d+b);case 12:return this.stream.parseStringUTF(d,d+b);case 18:case 19:case 20:case 21:case 22:case 26:return this.stream.parseStringISO(d,d+b);case 23:case 24:return this.stream.parseTime(d,d+b)}return null};cgjsCrypt.ASN1.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+((this.sub==null)?"null":this.sub.length)+"]"};cgjsCrypt.ASN1.prototype.print=function(c){if(c==undefined){c=""}document.writeln(c+this);if(this.sub!=null){c+="  ";for(var d=0,b=this.sub.length;d<b;++d){this.sub[d].print(c)}}};cgjsCrypt.ASN1.prototype.toPrettyString=function(c){if(c==undefined){c=""}var e=c+this.typeName()+" @"+this.stream.pos;if(this.length>=0){e+="+"}e+=this.length;if(this.tag&32){e+=" (constructed)"}else{if(((this.tag==3)||(this.tag==4))&&(this.sub!=null)){e+=" (encapsulates)"}}e+="\n";if(this.sub!=null){c+="  ";for(var d=0,b=this.sub.length;d<b;++d){e+=this.sub[d].toPrettyString(c)}}return e};cgjsCrypt.ASN1.prototype.toDOM=function(){var c=document.createElement("div");c.className="node";c.asn1=this;var j=document.createElement("div");j.className="head";var n=this.typeName();j.innerHTML=n;c.appendChild(j);this.head=j;var m=document.createElement("div");m.className="value";n="Offset: "+this.stream.pos+"<br/>";n+="Length: "+this.header+"+";if(this.length>=0){n+=this.length}else{n+=(-this.length)+" (undefined)"}if(this.tag&32){n+="<br/>(constructed)"}else{if(((this.tag==3)||(this.tag==4))&&(this.sub!=null)){n+="<br/>(encapsulates)"}}var f=this.content();if(f!=null){n+="<br/>Value:<br/><b>"+f+"</b>";if((typeof(oids)=="object")&&(this.tag==6)){var d=oids[f];if(d){if(d.d){n+="<br/>"+d.d}if(d.c){n+="<br/>"+d.c}if(d.w){n+="<br/>(warning!)"}}}}m.innerHTML=n;c.appendChild(m);var b=document.createElement("div");b.className="sub";if(this.sub!=null){for(var e=0,h=this.sub.length;e<h;++e){b.appendChild(this.sub[e].toDOM())}}c.appendChild(b);j.switchNode=c;j.onclick=function(){var i=this.switchNode;i.className=(i.className=="node collapsed")?"node":"node collapsed"};return c};cgjsCrypt.ASN1.prototype.posStart=function(){return this.stream.pos};cgjsCrypt.ASN1.prototype.posContent=function(){return this.stream.pos+this.header};cgjsCrypt.ASN1.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)};cgjsCrypt.ASN1.prototype.toHexDOM_sub=function(e,d,f,h,b){if(h>=b){return}var c=document.createElement("span");c.className=d;c.appendChild(document.createTextNode(f.hexDump(h,b)));e.appendChild(c)};cgjsCrypt.ASN1.prototype.toHexDOM=function(){var e=document.createElement("span");e.className="hex";this.head.hexNode=e;this.head.onmouseover=function(){this.hexNode.className="hexCurrent"};this.head.onmouseout=function(){this.hexNode.className="hex"};this.toHexDOM_sub(e,"tag",this.stream,this.posStart(),this.posStart()+1);
this.toHexDOM_sub(e,(this.length>=0)?"dlen":"ulen",this.stream,this.posStart()+1,this.posContent());if(this.sub==null){e.appendChild(document.createTextNode(this.stream.hexDump(this.posContent(),this.posEnd())))}else{if(this.sub.length>0){var f=this.sub[0];var d=this.sub[this.sub.length-1];this.toHexDOM_sub(e,"intro",this.stream,this.posContent(),f.posStart());for(var c=0,b=this.sub.length;c<b;++c){e.appendChild(this.sub[c].toHexDOM())}this.toHexDOM_sub(e,"outro",this.stream,d.posEnd(),this.posEnd())}}return e};cgjsCrypt.ASN1.decodeLength=function(e){var c=e.get();var b=c&127;if(b==c){return b}if(b>3){throw"Length over 24 bits not supported at position "+(e.pos-1)}if(b==0){return -1}c=0;for(var d=0;d<b;++d){c=(c<<8)|e.get()}return c};cgjsCrypt.ASN1.hasContent=function(c,b,i){if(c&32){return true}if((c<3)||(c>4)){return false}var h=new Stream(i);if(c==3){h.get()}var f=h.get();if((f>>6)&1){return false}try{var e=cgjsCrypt.ASN1.decodeLength(h);return((h.pos-i.pos)+e==b)}catch(d){return false}};cgjsCrypt.ASN1.decode=function(m){if(!(m instanceof Stream)){m=new Stream(m,0)}var j=new Stream(m);var o=m.get();var h=cgjsCrypt.ASN1.decodeLength(m);var f=m.pos-j.pos;var b=null;if(cgjsCrypt.ASN1.hasContent(o,h,m)){var c=m.pos;if(o==3){m.get()}b=[];if(h>=0){var d=c+h;while(m.pos<d){b[b.length]=cgjsCrypt.ASN1.decode(m)}if(m.pos!=d){throw"Content size is not correct for container starting at offset "+c}}else{try{for(;;){var n=cgjsCrypt.ASN1.decode(m);if(n.tag==0){break}b[b.length]=n}h=c-m.pos}catch(i){throw"Exception while decoding undefined length content: "+i}}}else{m.pos+=h}return new cgjsCrypt.ASN1(j,f,h,o,b)};cgjsCrypt.ASN1.test=function(){var h=[{value:[39],expected:39},{value:[129,201],expected:201},{value:[131,254,220,186],expected:16702650}];for(var d=0,b=h.length;d<b;++d){var f=0;var e=new Stream(h[d].value,0);var c=cgjsCrypt.ASN1.decodeLength(e);if(c!=h[d].expected){document.write("In test["+d+"] expected "+h[d].expected+" got "+c+"\n")}}}}var dbits;var canary=244837814094590;var j_lm=((canary&16777215)==15715070);function BigInteger(e,d,f){if(e!=null){if("number"==typeof e){this.fromNumber(e,d,f)}else{if(d==null&&"string"!=typeof e){this.fromString(e,256)}else{this.fromString(e,d)}}}}function nbi(){return new BigInteger(null)}function am1(h,b,d,f,o,m){while(--m>=0){var e=b*this[h++]+d[f]+o;o=Math.floor(e/67108864);d[f++]=e&67108863}return o}function am2(o,A,B,f,v,b){var u=A&32767,y=A>>15;while(--b>=0){var e=this[o]&32767;var r=this[o++]>>15;var d=y*e+r*u;e=u*e+((d&32767)<<15)+B[f]+(v&1073741823);v=(e>>>30)+(d>>>15)+y*r+(v>>>30);B[f++]=e&1073741823}return v}function am3(o,A,B,f,v,b){var u=A&16383,y=A>>14;while(--b>=0){var e=this[o]&16383;var r=this[o++]>>14;var d=y*e+r*u;e=u*e+((d&16383)<<14)+B[f]+v;v=(e>>28)+(d>>14)+y*r;B[f++]=e&268435455}return v}if(j_lm&&(navigator.appName=="Microsoft Internet Explorer")){BigInteger.prototype.am=am2;dbits=30}else{if(j_lm&&(navigator.appName!="Netscape")){BigInteger.prototype.am=am1;dbits=26}else{BigInteger.prototype.am=am3;dbits=28}}BigInteger.prototype.DB=dbits;BigInteger.prototype.DM=((1<<dbits)-1);BigInteger.prototype.DV=(1<<dbits);var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP);BigInteger.prototype.F1=BI_FP-dbits;BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz";var BI_RC=new Array();var rr,vv;rr="0".charCodeAt(0);for(vv=0;vv<=9;++vv){BI_RC[rr++]=vv}rr="a".charCodeAt(0);for(vv=10;vv<36;++vv){BI_RC[rr++]=vv}rr="A".charCodeAt(0);for(vv=10;vv<36;++vv){BI_RC[rr++]=vv}function int2char(b){return BI_RM.charAt(b)}function intAt(d,b){var e=BI_RC[d.charCodeAt(b)];return(e==null)?-1:e}function bnpCopyTo(c){for(var b=this.t-1;b>=0;--b){c[b]=this[b]}c.t=this.t;c.s=this.s}function bnpFromInt(b){this.t=1;this.s=(b<0)?-1:0;if(b>0){this[0]=b}else{if(b<-1){this[0]=b+DV}else{this.t=0}}}function nbv(b){var c=nbi();c.fromInt(b);return c}function bnpFromString(m,d){var f;if(d==16){f=4}else{if(d==8){f=3}else{if(d==256){f=8}else{if(d==2){f=1}else{if(d==32){f=5}else{if(d==4){f=2
}else{this.fromRadix(m,d);return}}}}}}this.t=0;this.s=0;var j=m.length,e=false,h=0;while(--j>=0){var c=(f==8)?m[j]&255:intAt(m,j);if(c<0){if(m.charAt(j)=="-"){e=true}continue}e=false;if(h==0){this[this.t++]=c}else{if(h+f>this.DB){this[this.t-1]|=(c&((1<<(this.DB-h))-1))<<h;this[this.t++]=(c>>(this.DB-h))}else{this[this.t-1]|=c<<h}}h+=f;if(h>=this.DB){h-=this.DB}}if(f==8&&(m[0]&128)!=0){this.s=-1;if(h>0){this[this.t-1]|=((1<<(this.DB-h))-1)<<h}}this.clamp();if(e){BigInteger.ZERO.subTo(this,this)}}function bnpClamp(){var b=this.s&this.DM;while(this.t>0&&this[this.t-1]==b){--this.t}}function bnToString(e){if(this.s<0){return"-"+this.negate().toString(e)}var f;if(e==16){f=4}else{if(e==8){f=3}else{if(e==2){f=1}else{if(e==32){f=5}else{if(e==4){f=2}else{return this.toRadix(e)}}}}}var j=(1<<f)-1,u,c=false,n="",h=this.t;var o=this.DB-(h*this.DB)%f;if(h-->0){if(o<this.DB&&(u=this[h]>>o)>0){c=true;n=int2char(u)}while(h>=0){if(o<f){u=(this[h]&((1<<o)-1))<<(f-o);u|=this[--h]>>(o+=this.DB-f)}else{u=(this[h]>>(o-=f))&j;if(o<=0){o+=this.DB;--h}}if(u>0){c=true}if(c){n+=int2char(u)}}}return c?n:"0"}function bnNegate(){var b=nbi();BigInteger.ZERO.subTo(this,b);return b}function bnAbs(){return(this.s<0)?this.negate():this}function bnCompareTo(b){var d=this.s-b.s;if(d!=0){return d}var c=this.t;d=c-b.t;if(d!=0){return d}while(--c>=0){if((d=this[c]-b[c])!=0){return d}}return 0}function nbits(b){var d=1,c;if((c=b>>>16)!=0){b=c;d+=16}if((c=b>>8)!=0){b=c;d+=8}if((c=b>>4)!=0){b=c;d+=4}if((c=b>>2)!=0){b=c;d+=2}if((c=b>>1)!=0){b=c;d+=1}return d}function bnBitLength(){if(this.t<=0){return 0}return this.DB*(this.t-1)+nbits(this[this.t-1]^(this.s&this.DM))}function bnpDLShiftTo(d,c){var b;for(b=this.t-1;b>=0;--b){c[b+d]=this[b]}for(b=d-1;b>=0;--b){c[b]=0}c.t=this.t+d;c.s=this.s}function bnpDRShiftTo(d,c){for(var b=d;b<this.t;++b){c[b-d]=this[b]}c.t=Math.max(this.t-d,0);c.s=this.s}function bnpLShiftTo(o,f){var d=o%this.DB;var b=this.DB-d;var j=(1<<b)-1;var h=Math.floor(o/this.DB),m=(this.s<<d)&this.DM,e;for(e=this.t-1;e>=0;--e){f[e+h+1]=(this[e]>>b)|m;m=(this[e]&j)<<d}for(e=h-1;e>=0;--e){f[e]=0}f[h]=m;f.t=this.t+h+1;f.s=this.s;f.clamp()}function bnpRShiftTo(j,e){e.s=this.s;var f=Math.floor(j/this.DB);if(f>=this.t){e.t=0;return}var c=j%this.DB;var b=this.DB-c;var h=(1<<c)-1;e[0]=this[f]>>c;for(var d=f+1;d<this.t;++d){e[d-f-1]|=(this[d]&h)<<b;e[d-f]=this[d]>>c}if(c>0){e[this.t-f-1]|=(this.s&h)<<b}e.t=this.t-f;e.clamp()}function bnpSubTo(d,f){var e=0,h=0,b=Math.min(d.t,this.t);while(e<b){h+=this[e]-d[e];f[e++]=h&this.DM;h>>=this.DB}if(d.t<this.t){h-=d.s;while(e<this.t){h+=this[e];f[e++]=h&this.DM;h>>=this.DB}h+=this.s}else{h+=this.s;while(e<d.t){h-=d[e];f[e++]=h&this.DM;h>>=this.DB}h-=d.s}f.s=(h<0)?-1:0;if(h<-1){f[e++]=this.DV+h}else{if(h>0){f[e++]=h}}f.t=e;f.clamp()}function bnpMultiplyTo(c,e){var b=this.abs(),f=c.abs();var d=b.t;e.t=d+f.t;while(--d>=0){e[d]=0}for(d=0;d<f.t;++d){e[d+b.t]=b.am(0,f[d],e,d,0,b.t)}e.s=0;e.clamp();if(this.s!=c.s){BigInteger.ZERO.subTo(e,e)}}function bnpSquareTo(e){var b=this.abs();var d=e.t=2*b.t;while(--d>=0){e[d]=0}for(d=0;d<b.t-1;++d){var f=b.am(d,b[d],e,2*d,0,1);if((e[d+b.t]+=b.am(d+1,2*b[d],e,2*d+1,f,b.t-d-1))>=b.DV){e[d+b.t]-=b.DV;e[d+b.t+1]=1}}if(e.t>0){e[e.t-1]+=b.am(d,b[d],e,2*d,0,1)}e.s=0;e.clamp()}function bnpDivRemTo(w,o,n){var F=w.abs();if(F.t<=0){return}var u=this.abs();if(u.t<F.t){if(o!=null){o.fromInt(0)}if(n!=null){this.copyTo(n)}return}if(n==null){n=nbi()}var f=nbi(),b=this.s,v=w.s;var E=this.DB-nbits(F[F.t-1]);if(E>0){F.lShiftTo(E,f);u.lShiftTo(E,n)}else{F.copyTo(f);u.copyTo(n)}var B=f.t;var c=f[B-1];if(c==0){return}var A=c*(1<<this.F1)+((B>1)?f[B-2]>>this.F2:0);var I=this.FV/A,H=(1<<this.F1)/A,G=1<<this.F2;var D=n.t,C=D-B,h=(o==null)?nbi():o;f.dlShiftTo(C,h);if(n.compareTo(h)>=0){n[n.t++]=1;n.subTo(h,n)}BigInteger.ONE.dlShiftTo(B,h);h.subTo(f,f);while(f.t<B){f[f.t++]=0}while(--C>=0){var d=(n[--D]==c)?this.DM:Math.floor(n[D]*I+(n[D-1]+G)*H);if((n[D]+=f.am(0,d,n,C,0,B))<d){f.dlShiftTo(C,h);n.subTo(h,n);while(n[D]<--d){n.subTo(h,n)
}}}if(o!=null){n.drShiftTo(B,o);if(b!=v){BigInteger.ZERO.subTo(o,o)}}n.t=B;n.clamp();if(E>0){n.rShiftTo(E,n)}if(b<0){BigInteger.ZERO.subTo(n,n)}}function bnMod(b){var c=nbi();this.abs().divRemTo(b,null,c);if(this.s<0&&c.compareTo(BigInteger.ZERO)>0){b.subTo(c,c)}return c}function Classic(b){this.m=b}function cConvert(b){if(b.s<0||b.compareTo(this.m)>=0){return b.mod(this.m)}else{return b}}function cRevert(b){return b}function cReduce(b){b.divRemTo(this.m,null,b)}function cMulTo(b,d,c){b.multiplyTo(d,c);this.reduce(c)}function cSqrTo(b,c){b.squareTo(c);this.reduce(c)}Classic.prototype.convert=cConvert;Classic.prototype.revert=cRevert;Classic.prototype.reduce=cReduce;Classic.prototype.mulTo=cMulTo;Classic.prototype.sqrTo=cSqrTo;function bnpInvDigit(){if(this.t<1){return 0}var b=this[0];if((b&1)==0){return 0}var c=b&3;c=(c*(2-(b&15)*c))&15;c=(c*(2-(b&255)*c))&255;c=(c*(2-(((b&65535)*c)&65535)))&65535;c=(c*(2-b*c%this.DV))%this.DV;return(c>0)?this.DV-c:-c}function Montgomery(b){this.m=b;this.mp=b.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<(b.DB-15))-1;this.mt2=2*b.t}function montConvert(b){var c=nbi();b.abs().dlShiftTo(this.m.t,c);c.divRemTo(this.m,null,c);if(b.s<0&&c.compareTo(BigInteger.ZERO)>0){this.m.subTo(c,c)}return c}function montRevert(b){var c=nbi();b.copyTo(c);this.reduce(c);return c}function montReduce(b){while(b.t<=this.mt2){b[b.t++]=0}for(var d=0;d<this.m.t;++d){var c=b[d]&32767;var e=(c*this.mpl+(((c*this.mph+(b[d]>>15)*this.mpl)&this.um)<<15))&b.DM;c=d+this.m.t;b[c]+=this.m.am(0,e,b,d,0,this.m.t);while(b[c]>=b.DV){b[c]-=b.DV;b[++c]++}}b.clamp();b.drShiftTo(this.m.t,b);if(b.compareTo(this.m)>=0){b.subTo(this.m,b)}}function montSqrTo(b,c){b.squareTo(c);this.reduce(c)}function montMulTo(b,d,c){b.multiplyTo(d,c);this.reduce(c)}Montgomery.prototype.convert=montConvert;Montgomery.prototype.revert=montRevert;Montgomery.prototype.reduce=montReduce;Montgomery.prototype.mulTo=montMulTo;Montgomery.prototype.sqrTo=montSqrTo;function bnpIsEven(){return((this.t>0)?(this[0]&1):this.s)==0}function bnpExp(j,m){if(j>4294967295||j<1){return BigInteger.ONE}var h=nbi(),b=nbi(),f=m.convert(this),d=nbits(j)-1;f.copyTo(h);while(--d>=0){m.sqrTo(h,b);if((j&(1<<d))>0){m.mulTo(b,f,h)}else{var c=h;h=b;b=c}}return m.revert(h)}function bnModPowInt(c,b){var d;if(c<256||b.isEven()){d=new Classic(b)}else{d=new Montgomery(b)}return this.exp(c,d)}BigInteger.prototype.copyTo=bnpCopyTo;BigInteger.prototype.fromInt=bnpFromInt;BigInteger.prototype.fromString=bnpFromString;BigInteger.prototype.clamp=bnpClamp;BigInteger.prototype.dlShiftTo=bnpDLShiftTo;BigInteger.prototype.drShiftTo=bnpDRShiftTo;BigInteger.prototype.lShiftTo=bnpLShiftTo;BigInteger.prototype.rShiftTo=bnpRShiftTo;BigInteger.prototype.subTo=bnpSubTo;BigInteger.prototype.multiplyTo=bnpMultiplyTo;BigInteger.prototype.squareTo=bnpSquareTo;BigInteger.prototype.divRemTo=bnpDivRemTo;BigInteger.prototype.invDigit=bnpInvDigit;BigInteger.prototype.isEven=bnpIsEven;BigInteger.prototype.exp=bnpExp;BigInteger.prototype.toString=bnToString;BigInteger.prototype.negate=bnNegate;BigInteger.prototype.abs=bnAbs;BigInteger.prototype.compareTo=bnCompareTo;BigInteger.prototype.bitLength=bnBitLength;BigInteger.prototype.mod=bnMod;BigInteger.prototype.modPowInt=bnModPowInt;BigInteger.ZERO=nbv(0);BigInteger.ONE=nbv(1);function bnClone(){var b=nbi();this.copyTo(b);return b}function bnIntValue(){if(this.s<0){if(this.t==1){return this[0]-this.DV}else{if(this.t==0){return -1}}}else{if(this.t==1){return this[0]}else{if(this.t==0){return 0}}}return((this[1]&((1<<(32-this.DB))-1))<<this.DB)|this[0]}function bnByteValue(){return(this.t==0)?this.s:(this[0]<<24)>>24}function bnShortValue(){return(this.t==0)?this.s:(this[0]<<16)>>16}function bnpChunkSize(b){return Math.floor(Math.LN2*this.DB/Math.log(b))}function bnSigNum(){if(this.s<0){return -1}else{if(this.t<=0||(this.t==1&&this[0]<=0)){return 0}else{return 1}}}function bnpToRadix(c){if(c==null){c=10}if(this.signum()==0||c<2||c>36){return"0"}var f=this.chunkSize(c);
var e=Math.pow(c,f);var j=nbv(e),m=nbi(),i=nbi(),h="";this.divRemTo(j,m,i);while(m.signum()>0){h=(e+i.intValue()).toString(c).substr(1)+h;m.divRemTo(j,m,i)}return i.intValue().toString(c)+h}function bnpFromRadix(u,n){this.fromInt(0);if(n==null){n=10}var h=this.chunkSize(n);var m=Math.pow(n,h),f=false,c=0,r=0;for(var e=0;e<u.length;++e){var o=intAt(u,e);if(o<0){if(u.charAt(e)=="-"&&this.signum()==0){f=true}continue}r=n*r+o;if(++c>=h){this.dMultiply(m);this.dAddOffset(r,0);c=0;r=0}}if(c>0){this.dMultiply(Math.pow(n,c));this.dAddOffset(r,0)}if(f){BigInteger.ZERO.subTo(this,this)}}function bnpFromNumber(f,e,i){if("number"==typeof e){if(f<2){this.fromInt(1)}else{this.fromNumber(f,i);if(!this.testBit(f-1)){this.bitwiseTo(BigInteger.ONE.shiftLeft(f-1),op_or,this)}if(this.isEven()){this.dAddOffset(1,0)}while(!this.isProbablePrime(e)){this.dAddOffset(2,0);if(this.bitLength()>f){this.subTo(BigInteger.ONE.shiftLeft(f-1),this)}}}}else{var d=new Array(),h=f&7;d.length=(f>>3)+1;e.nextBytes(d);if(h>0){d[0]&=((1<<h)-1)}else{d[0]=0}this.fromString(d,256)}}function bnToByteArray(){var c=this.t,e=new Array();e[0]=this.s;var f=this.DB-(c*this.DB)%8,h,b=0;if(c-->0){if(f<this.DB&&(h=this[c]>>f)!=(this.s&this.DM)>>f){e[b++]=h|(this.s<<(this.DB-f))}while(c>=0){if(f<8){h=(this[c]&((1<<f)-1))<<(8-f);h|=this[--c]>>(f+=this.DB-8)}else{h=(this[c]>>(f-=8))&255;if(f<=0){f+=this.DB;--c}}if((h&128)!=0){h|=-256}if(b==0&&(this.s&128)!=(h&128)){++b}if(b>0||h!=this.s){e[b++]=h}}}return e}function bnEquals(b){return(this.compareTo(b)==0)}function bnMin(b){return(this.compareTo(b)<0)?this:b}function bnMax(b){return(this.compareTo(b)>0)?this:b}function bnpBitwiseTo(c,j,e){var d,h,b=Math.min(c.t,this.t);for(d=0;d<b;++d){e[d]=j(this[d],c[d])}if(c.t<this.t){h=c.s&this.DM;for(d=b;d<this.t;++d){e[d]=j(this[d],h)}e.t=this.t}else{h=this.s&this.DM;for(d=b;d<c.t;++d){e[d]=j(h,c[d])}e.t=c.t}e.s=j(this.s,c.s);e.clamp()}function op_and(b,c){return b&c}function bnAnd(b){var c=nbi();this.bitwiseTo(b,op_and,c);return c}function op_or(b,c){return b|c}function bnOr(b){var c=nbi();this.bitwiseTo(b,op_or,c);return c}function op_xor(b,c){return b^c}function bnXor(b){var c=nbi();this.bitwiseTo(b,op_xor,c);return c}function op_andnot(b,c){return b&~c}function bnAndNot(b){var c=nbi();this.bitwiseTo(b,op_andnot,c);return c}function bnNot(){var c=nbi();for(var b=0;b<this.t;++b){c[b]=this.DM&~this[b]}c.t=this.t;c.s=~this.s;return c}function bnShiftLeft(c){var b=nbi();if(c<0){this.rShiftTo(-c,b)}else{this.lShiftTo(c,b)}return b}function bnShiftRight(c){var b=nbi();if(c<0){this.lShiftTo(-c,b)}else{this.rShiftTo(c,b)}return b}function lbit(b){if(b==0){return -1}var c=0;if((b&65535)==0){b>>=16;c+=16}if((b&255)==0){b>>=8;c+=8}if((b&15)==0){b>>=4;c+=4}if((b&3)==0){b>>=2;c+=2}if((b&1)==0){++c}return c}function bnGetLowestSetBit(){for(var b=0;b<this.t;++b){if(this[b]!=0){return b*this.DB+lbit(this[b])}}if(this.s<0){return this.t*this.DB}return -1}function cbit(b){var c=0;while(b!=0){b&=b-1;++c}return c}function bnBitCount(){var d=0,b=this.s&this.DM;for(var c=0;c<this.t;++c){d+=cbit(this[c]^b)}return d}function bnTestBit(c){var b=Math.floor(c/this.DB);if(b>=this.t){return(this.s!=0)}return((this[b]&(1<<(c%this.DB)))!=0)}function bnpChangeBit(d,c){var b=BigInteger.ONE.shiftLeft(d);this.bitwiseTo(b,c,b);return b}function bnSetBit(b){return this.changeBit(b,op_or)}function bnClearBit(b){return this.changeBit(b,op_andnot)}function bnFlipBit(b){return this.changeBit(b,op_xor)}function bnpAddTo(d,f){var e=0,h=0,b=Math.min(d.t,this.t);while(e<b){h+=this[e]+d[e];f[e++]=h&this.DM;h>>=this.DB}if(d.t<this.t){h+=d.s;while(e<this.t){h+=this[e];f[e++]=h&this.DM;h>>=this.DB}h+=this.s}else{h+=this.s;while(e<d.t){h+=d[e];f[e++]=h&this.DM;h>>=this.DB}h+=d.s}f.s=(h<0)?-1:0;if(h>0){f[e++]=h}else{if(h<-1){f[e++]=this.DV+h}}f.t=e;f.clamp()}function bnAdd(b){var c=nbi();this.addTo(b,c);return c}function bnSubtract(b){var c=nbi();this.subTo(b,c);return c}function bnMultiply(b){var c=nbi();this.multiplyTo(b,c);return c}function bnDivide(b){var c=nbi();
this.divRemTo(b,c,null);return c}function bnRemainder(b){var c=nbi();this.divRemTo(b,null,c);return c}function bnDivideAndRemainder(b){var d=nbi(),c=nbi();this.divRemTo(b,d,c);return new Array(d,c)}function bnpDMultiply(b){this[this.t]=this.am(0,b-1,this,0,0,this.t);++this.t;this.clamp()}function bnpDAddOffset(c,b){while(this.t<=b){this[this.t++]=0}this[b]+=c;while(this[b]>=this.DV){this[b]-=this.DV;if(++b>=this.t){this[this.t++]=0}++this[b]}}function NullExp(){}function nNop(b){return b}function nMulTo(b,d,c){b.multiplyTo(d,c)}function nSqrTo(b,c){b.squareTo(c)}NullExp.prototype.convert=nNop;NullExp.prototype.revert=nNop;NullExp.prototype.mulTo=nMulTo;NullExp.prototype.sqrTo=nSqrTo;function bnPow(b){return this.exp(b,new NullExp())}function bnpMultiplyLowerTo(b,f,e){var d=Math.min(this.t+b.t,f);e.s=0;e.t=d;while(d>0){e[--d]=0}var c;for(c=e.t-this.t;d<c;++d){e[d+this.t]=this.am(0,b[d],e,d,0,this.t)}for(c=Math.min(b.t,f);d<c;++d){this.am(0,b[d],e,d,0,f-d)}e.clamp()}function bnpMultiplyUpperTo(b,e,d){--e;var c=d.t=this.t+b.t-e;d.s=0;while(--c>=0){d[c]=0}for(c=Math.max(e-this.t,0);c<b.t;++c){d[this.t+c-e]=this.am(e-c,b[c],d,0,0,this.t+c-e)}d.clamp();d.drShiftTo(1,d)}function Barrett(b){this.r2=nbi();this.q3=nbi();BigInteger.ONE.dlShiftTo(2*b.t,this.r2);this.mu=this.r2.divide(b);this.m=b}function barrettConvert(b){if(b.s<0||b.t>2*this.m.t){return b.mod(this.m)}else{if(b.compareTo(this.m)<0){return b}else{var c=nbi();b.copyTo(c);this.reduce(c);return c}}}function barrettRevert(b){return b}function barrettReduce(b){b.drShiftTo(this.m.t-1,this.r2);if(b.t>this.m.t+1){b.t=this.m.t+1;b.clamp()}this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(b.compareTo(this.r2)<0){b.dAddOffset(1,this.m.t+1)}b.subTo(this.r2,b);while(b.compareTo(this.m)>=0){b.subTo(this.m,b)}}function barrettSqrTo(b,c){b.squareTo(c);this.reduce(c)}function barrettMulTo(b,d,c){b.multiplyTo(d,c);this.reduce(c)}Barrett.prototype.convert=barrettConvert;Barrett.prototype.revert=barrettRevert;Barrett.prototype.reduce=barrettReduce;Barrett.prototype.mulTo=barrettMulTo;Barrett.prototype.sqrTo=barrettSqrTo;function bnModPow(A,h){var v=A.bitLength(),o,c=nbv(1),D;if(v<=0){return c}else{if(v<18){o=1}else{if(v<48){o=3}else{if(v<144){o=4}else{if(v<768){o=5}else{o=6}}}}}if(v<8){D=new Classic(h)}else{if(h.isEven()){D=new Barrett(h)}else{D=new Montgomery(h)}}var y=new Array(),f=3,B=o-1,b=(1<<o)-1;y[1]=D.convert(this);if(o>1){var G=nbi();D.sqrTo(y[1],G);while(f<=b){y[f]=nbi();D.mulTo(G,y[f-2],y[f]);f+=2}}var u=A.t-1,E,C=true,d=nbi(),F;v=nbits(A[u])-1;while(u>=0){if(v>=B){E=(A[u]>>(v-B))&b}else{E=(A[u]&((1<<(v+1))-1))<<(B-v);if(u>0){E|=A[u-1]>>(this.DB+v-B)}}f=o;while((E&1)==0){E>>=1;--f}if((v-=f)<0){v+=this.DB;--u}if(C){y[E].copyTo(c);C=false}else{while(f>1){D.sqrTo(c,d);D.sqrTo(d,c);f-=2}if(f>0){D.sqrTo(c,d)}else{F=c;c=d;d=F}D.mulTo(d,y[E],c)}while(u>=0&&(A[u]&(1<<v))==0){D.sqrTo(c,d);F=c;c=d;d=F;if(--v<0){v=this.DB-1;--u}}}return D.revert(c)}function bnGCD(c){var b=(this.s<0)?this.negate():this.clone();var h=(c.s<0)?c.negate():c.clone();if(b.compareTo(h)<0){var e=b;b=h;h=e}var d=b.getLowestSetBit(),f=h.getLowestSetBit();if(f<0){return b}if(d<f){f=d}if(f>0){b.rShiftTo(f,b);h.rShiftTo(f,h)}while(b.signum()>0){if((d=b.getLowestSetBit())>0){b.rShiftTo(d,b)}if((d=h.getLowestSetBit())>0){h.rShiftTo(d,h)}if(b.compareTo(h)>=0){b.subTo(h,b);b.rShiftTo(1,b)}else{h.subTo(b,h);h.rShiftTo(1,h)}}if(f>0){h.lShiftTo(f,h)}return h}function bnpModInt(f){if(f<=0){return 0}var e=this.DV%f,c=(this.s<0)?f-1:0;if(this.t>0){if(e==0){c=this[0]%f}else{for(var b=this.t-1;b>=0;--b){c=(e*c+this[b])%f}}}return c}function bnModInverse(f){var n=f.isEven();if((this.isEven()&&n)||f.signum()==0){return BigInteger.ZERO}var j=f.clone(),i=this.clone();var h=nbv(1),e=nbv(0),r=nbv(0),o=nbv(1);while(j.signum()!=0){while(j.isEven()){j.rShiftTo(1,j);if(n){if(!h.isEven()||!e.isEven()){h.addTo(this,h);e.subTo(f,e)}h.rShiftTo(1,h)}else{if(!e.isEven()){e.subTo(f,e)}}e.rShiftTo(1,e)
}while(i.isEven()){i.rShiftTo(1,i);if(n){if(!r.isEven()||!o.isEven()){r.addTo(this,r);o.subTo(f,o)}r.rShiftTo(1,r)}else{if(!o.isEven()){o.subTo(f,o)}}o.rShiftTo(1,o)}if(j.compareTo(i)>=0){j.subTo(i,j);if(n){h.subTo(r,h)}e.subTo(o,e)}else{i.subTo(j,i);if(n){r.subTo(h,r)}o.subTo(e,o)}}if(i.compareTo(BigInteger.ONE)!=0){return BigInteger.ZERO}if(o.compareTo(f)>=0){return o.subtract(f)}if(o.signum()<0){o.addTo(f,o)}else{return o}if(o.signum()<0){return o.add(f)}else{return o}}var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509];var lplim=(1<<26)/lowprimes[lowprimes.length-1];function bnIsProbablePrime(f){var e,c=this.abs();if(c.t==1&&c[0]<=lowprimes[lowprimes.length-1]){for(e=0;e<lowprimes.length;++e){if(c[0]==lowprimes[e]){return true}}return false}if(c.isEven()){return false}e=1;while(e<lowprimes.length){var b=lowprimes[e],d=e+1;while(d<lowprimes.length&&b<lplim){b*=lowprimes[d++]}b=c.modInt(b);while(e<d){if(b%lowprimes[e++]==0){return false}}}return c.millerRabin(f)}function bnpMillerRabin(f){var h=this.subtract(BigInteger.ONE);var c=h.getLowestSetBit();if(c<=0){return false}var m=h.shiftRight(c);f=(f+1)>>1;if(f>lowprimes.length){f=lowprimes.length}var b=nbi();for(var e=0;e<f;++e){b.fromInt(lowprimes[e]);var n=b.modPow(m,this);if(n.compareTo(BigInteger.ONE)!=0&&n.compareTo(h)!=0){var d=1;while(d++<c&&n.compareTo(h)!=0){n=n.modPowInt(2,this);if(n.compareTo(BigInteger.ONE)==0){return false}}if(n.compareTo(h)!=0){return false}}}return true}BigInteger.prototype.chunkSize=bnpChunkSize;BigInteger.prototype.toRadix=bnpToRadix;BigInteger.prototype.fromRadix=bnpFromRadix;BigInteger.prototype.fromNumber=bnpFromNumber;BigInteger.prototype.bitwiseTo=bnpBitwiseTo;BigInteger.prototype.changeBit=bnpChangeBit;BigInteger.prototype.addTo=bnpAddTo;BigInteger.prototype.dMultiply=bnpDMultiply;BigInteger.prototype.dAddOffset=bnpDAddOffset;BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo;BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo;BigInteger.prototype.modInt=bnpModInt;BigInteger.prototype.millerRabin=bnpMillerRabin;BigInteger.prototype.clone=bnClone;BigInteger.prototype.intValue=bnIntValue;BigInteger.prototype.byteValue=bnByteValue;BigInteger.prototype.shortValue=bnShortValue;BigInteger.prototype.signum=bnSigNum;BigInteger.prototype.toByteArray=bnToByteArray;BigInteger.prototype.equals=bnEquals;BigInteger.prototype.min=bnMin;BigInteger.prototype.max=bnMax;BigInteger.prototype.and=bnAnd;BigInteger.prototype.or=bnOr;BigInteger.prototype.xor=bnXor;BigInteger.prototype.andNot=bnAndNot;BigInteger.prototype.not=bnNot;BigInteger.prototype.shiftLeft=bnShiftLeft;BigInteger.prototype.shiftRight=bnShiftRight;BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit;BigInteger.prototype.bitCount=bnBitCount;BigInteger.prototype.testBit=bnTestBit;BigInteger.prototype.setBit=bnSetBit;BigInteger.prototype.clearBit=bnClearBit;BigInteger.prototype.flipBit=bnFlipBit;BigInteger.prototype.add=bnAdd;BigInteger.prototype.subtract=bnSubtract;BigInteger.prototype.multiply=bnMultiply;BigInteger.prototype.divide=bnDivide;BigInteger.prototype.remainder=bnRemainder;BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder;BigInteger.prototype.modPow=bnModPow;BigInteger.prototype.modInverse=bnModInverse;BigInteger.prototype.pow=bnPow;BigInteger.prototype.gcd=bnGCD;BigInteger.prototype.isProbablePrime=bnIsProbablePrime;function SecureRandom(){this.rng_state;this.rng_pool;this.rng_pptr;this.rng_seed_int=function(d){this.rng_pool[this.rng_pptr++]^=d&255;this.rng_pool[this.rng_pptr++]^=(d>>8)&255;this.rng_pool[this.rng_pptr++]^=(d>>16)&255;this.rng_pool[this.rng_pptr++]^=(d>>24)&255;if(this.rng_pptr>=rng_psize){this.rng_pptr-=rng_psize}};this.rng_seed_time=function(){this.rng_seed_int(new Date().getTime())
};if(this.rng_pool==null){this.rng_pool=new Array();this.rng_pptr=0;var b;if(navigator.appName=="Netscape"&&navigator.appVersion<"5"&&window.crypto){var c=window.crypto.random(32);for(b=0;b<c.length;++b){this.rng_pool[this.rng_pptr++]=c.charCodeAt(b)&255}}while(this.rng_pptr<rng_psize){b=Math.floor(65536*Math.random());this.rng_pool[this.rng_pptr++]=b>>>8;this.rng_pool[this.rng_pptr++]=b&255}this.rng_pptr=0;this.rng_seed_time()}this.rng_get_byte=function(){if(this.rng_state==null){this.rng_seed_time();this.rng_state=prng_newstate();this.rng_state.init(this.rng_pool);for(this.rng_pptr=0;this.rng_pptr<this.rng_pool.length;++this.rng_pptr){this.rng_pool[this.rng_pptr]=0}this.rng_pptr=0}return this.rng_state.next()};this.nextBytes=function(e){var d;for(d=0;d<e.length;++d){e[d]=this.rng_get_byte()}}}function Arcfour(){this.i=0;this.j=0;this.S=new Array()}function ARC4init(e){var d,b,c;for(d=0;d<256;++d){this.S[d]=d}b=0;for(d=0;d<256;++d){b=(b+this.S[d]+e[d%e.length])&255;c=this.S[d];this.S[d]=this.S[b];this.S[b]=c}this.i=0;this.j=0}function ARC4next(){var b;this.i=(this.i+1)&255;this.j=(this.j+this.S[this.i])&255;b=this.S[this.i];this.S[this.i]=this.S[this.j];this.S[this.j]=b;return this.S[(b+this.S[this.i])&255]}Arcfour.prototype.init=ARC4init;Arcfour.prototype.next=ARC4next;function prng_newstate(){return new Arcfour()}var rng_psize=256;if(typeof(cgjsCrypt)!="undefined"&&typeof(BigInteger)!="undefined"&&typeof(SecureRandom)!="undefined"&&typeof(Arcfour)!="undefined"){function parseBigInt(c,b){return new BigInteger(c,b)}function linebrk(d,e){var b="";var c=0;while(c+e<d.length){b+=d.substring(c,c+e)+"\n";c+=e}return b+d.substring(c,d.length)}function byte2Hex(c){if(c<16){return"0"+c.toString(16)}else{return c.toString(16)}}function pkcs1unpad2(h,j){var c=h.toByteArray();var f=0;while(f<c.length&&c[f]==0){++f}if(c.length-f!=j-1||c[f]!=2){return null}++f;while(c[f]!=0){if(++f>=c.length){return null}}var e="";while(++f<c.length){e+=String.fromCharCode(c[f])}return e}function pkcs1pad2(e,h){if(h<e.length+11){throw"9000";return null}var f=new Array();var d=e.length-1;while(d>=0&&h>0){f[--h]=e.charCodeAt(d--)}f[--h]=0;var c=new SecureRandom();var b=new Array();while(h>2){b[0]=0;while(b[0]==0){c.nextBytes(b)}f[--h]=b[0]}f[--h]=2;f[--h]=0;return new BigInteger(f)}cgjsCrypt.RSA=function(){this.n=null;this.e=0;this.d=null;this.p=null;this.q=null;this.dmp1=null;this.dmq1=null;this.coeff=null};cgjsCrypt.RSA.prototype.doPrivate=function(b){if(this.p==null||this.q==null){return b.modPow(this.d,this.n)}var d=b.mod(this.p).modPow(this.dmp1,this.p);var c=b.mod(this.q).modPow(this.dmq1,this.q);while(d.compareTo(c)<0){d=d.add(this.p)}return d.subtract(c).multiply(this.coeff).mod(this.p).multiply(this.q).add(c)};cgjsCrypt.RSA.prototype.setPublic=function(d,c,b){if(typeof(b)=="undefined"){b=16}if(d!=null&&c!=null&&d.length>0&&c.length>0){this.n=parseBigInt(d,b);this.e=parseInt(c,b)}else{throw"9001"}};cgjsCrypt.RSA.prototype.doPublic=function(b){return b.modPowInt(this.e,this.n)};cgjsCrypt.RSA.prototype.encryptRaw=function(e){var b=pkcs1pad2(e,(this.n.bitLength()+7)>>3);if(b==null){return null}var f=this.doPublic(b);if(f==null){return null}var d=f.toString(16);if((d.length&1)==0){return d}else{return"0"+d}};cgjsCrypt.RSA.prototype.encrypt=function(b){return this.encryptRaw(b)};cgjsCrypt.RSA.prototype.decryptRaw=function(d){var e=parseBigInt(d,16);var b=this.doPrivate(e);if(b==null){return null}return pkcs1unpad2(b,(this.n.bitLength()+7)>>3)};cgjsCrypt.RSA.prototype.decrypt=function(c){var b=this.decryptRaw(c);b=(b)?cgjsCryptUtil.decodeBase64(b):"";return b};cgjsCrypt.RSA.prototype.setPrivate=function(e,c,d,b){if(typeof(b)=="undefined"){b=16}if(e!=null&&c!=null&&e.length>0&&c.length>0){this.n=parseBigInt(e,b);this.e=parseInt(c,b);this.d=parseBigInt(d,b)}else{throw ("9002")}};cgjsCrypt.RSA.prototype.setPrivateEx=function(f,m,b,e,d,j,i,c,h){if(typeof(h)=="undefined"){h=16}if(f!=null&&m!=null&&f.length>0&&m.length>0){this.n=parseBigInt(f,h);this.e=parseInt(m,h);
this.d=parseBigInt(b,h);this.p=parseBigInt(e,h);this.q=parseBigInt(d,h);this.dmp1=parseBigInt(j,h);this.dmq1=parseBigInt(i,h);this.coeff=parseBigInt(c,h)}else{throw ("9002")}};cgjsCrypt.RSA.prototype.generate=function(c,m){var b=new SecureRandom();var h=c>>1;this.e=parseInt(m,16);var d=new BigInteger(m,16);for(;;){for(;;){this.p=new BigInteger(c-h,1,b);if(this.p.subtract(BigInteger.ONE).gcd(d).compareTo(BigInteger.ONE)==0&&this.p.isProbablePrime(10)){break}}for(;;){this.q=new BigInteger(h,1,b);if(this.q.subtract(BigInteger.ONE).gcd(d).compareTo(BigInteger.ONE)==0&&this.q.isProbablePrime(10)){break}}if(this.p.compareTo(this.q)<=0){var j=this.p;this.p=this.q;this.q=j}var i=this.p.subtract(BigInteger.ONE);var e=this.q.subtract(BigInteger.ONE);var f=i.multiply(e);if(f.gcd(d).compareTo(BigInteger.ONE)==0){this.n=this.p.multiply(this.q);this.d=d.modInverse(f);this.dmp1=this.d.mod(i);this.dmq1=this.d.mod(e);this.coeff=this.q.modInverse(this.p);break}}};cgjsCrypt.RSA.prototype.getASNData=function(b){var f={};var d=[];var e=0;if(b.value&&b.type=="INTEGER"){d[e++]=b.value}if(b.sub){for(var c=0;c<b.sub.length;c++){d=d.concat(this.getASNData(b.sub[c]))}}return d};cgjsCrypt.RSA.prototype.setKeyFromASN=function(d,f){var e=["N","E","D","P","Q","DP","DQ","C"];var h={};var b=this.getASNData(f);switch(d){case"Public":case"public":for(var c=0;c<b.length;c++){h[e[c]]=b[c].toLowerCase()}this.setPublic(h.N,h.E,16);break;case"Private":case"private":for(var c=1;c<b.length;c++){h[e[c-1]]=b[c].toLowerCase()}this.setPrivateEx(h.N,h.E,h.D,h.P,h.Q,h.DP,h.DQ,h.C,16);break}};cgjsCrypt.RSA.prototype.setPublicKeyFromASN=function(b){this.setKeyFromASN("public",b)};cgjsCrypt.RSA.prototype.setPrivateKeyFromASN=function(b){this.setKeyFromASN("private",b)};cgjsCrypt.RSA.prototype.getParameters=function(){var b={};if(this.n!=null){b.n=this.n}b.e=this.e;if(this.d!=null){b.d=this.d}if(this.p!=null){b.p=this.p}if(this.q!=null){b.q=this.q}if(this.dmp1!=null){b.dmp1=this.dmp1}if(this.dmq1!=null){b.dmq1=this.dmq1}if(this.coeff!=null){b.c=this.coeff}return b}}if(typeof YAHOO=="undefined"||!YAHOO){var YAHOO={}}YAHOO.namespace=function(){var d=arguments,h=null,j,m,i;for(j=0;j<d.length;j=j+1){i=(""+d[j]).split(".");h=YAHOO;for(m=(i[0]=="YAHOO")?1:0;m<i.length;m=m+1){h[i[m]]=h[i[m]]||{};h=h[i[m]]}}return h};YAHOO.log=function(h,f,i){var e=YAHOO.widget.Logger;if(e&&e.log){return e.log(h,f,i)}else{return false}};YAHOO.register=function(w,o,r){var b=YAHOO.env.modules,v,i,m,n,u;if(!b[w]){b[w]={versions:[],builds:[]}}v=b[w];i=r.version;m=r.build;n=YAHOO.env.listeners;v.name=w;v.version=i;v.build=m;v.versions.push(i);v.builds.push(m);v.mainClass=o;for(u=0;u<n.length;u=u+1){n[u](v)}if(o){o.VERSION=i;o.BUILD=m}else{YAHOO.log("mainClass is undefined for module "+w,"warn")}};YAHOO.env=YAHOO.env||{modules:[],listeners:[]};YAHOO.env.getVersion=function(b){return YAHOO.env.modules[b]||null};YAHOO.env.parseUA=function(u){var r=function(c){var b=0;return parseFloat(c.replace(/\./g,function(){return(b++==1)?"":"."}))},m=navigator,n={ie:0,opera:0,gecko:0,webkit:0,chrome:0,mobile:null,air:0,ipad:0,iphone:0,ipod:0,ios:null,android:0,webos:0,caja:m&&m.cajaVersion,secure:false,os:null},v=u||(navigator&&navigator.userAgent),o=window&&window.location,i=o&&o.href,j;n.secure=i&&(i.toLowerCase().indexOf("https")===0);if(v){if((/windows|win32/i).test(v)){n.os="windows"}else{if((/macintosh/i).test(v)){n.os="macintosh"}else{if((/rhino/i).test(v)){n.os="rhino"}}}if((/KHTML/).test(v)){n.webkit=1}j=v.match(/AppleWebKit\/([^\s]*)/);if(j&&j[1]){n.webkit=r(j[1]);if(/ Mobile\//.test(v)){n.mobile="Apple";j=v.match(/OS ([^\s]*)/);if(j&&j[1]){j=r(j[1].replace("_","."))}n.ios=j;n.ipad=n.ipod=n.iphone=0;j=v.match(/iPad|iPod|iPhone/);if(j&&j[0]){n[j[0].toLowerCase()]=n.ios}}else{j=v.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/);if(j){n.mobile=j[0]}if(/webOS/.test(v)){n.mobile="WebOS";j=v.match(/webOS\/([^\s]*);/);if(j&&j[1]){n.webos=r(j[1])}}if(/ Android/.test(v)){n.mobile="Android";j=v.match(/Android ([^\s]*);/);
if(j&&j[1]){n.android=r(j[1])}}}j=v.match(/Chrome\/([^\s]*)/);if(j&&j[1]){n.chrome=r(j[1])}else{j=v.match(/AdobeAIR\/([^\s]*)/);if(j){n.air=j[0]}}}if(!n.webkit){j=v.match(/Opera[\s\/]([^\s]*)/);if(j&&j[1]){n.opera=r(j[1]);j=v.match(/Version\/([^\s]*)/);if(j&&j[1]){n.opera=r(j[1])}j=v.match(/Opera Mini[^;]*/);if(j){n.mobile=j[0]}}else{j=v.match(/MSIE\s([^;]*)/);if(j&&j[1]){n.ie=r(j[1])}else{j=v.match(/Gecko\/([^\s]*)/);if(j){n.gecko=1;j=v.match(/rv:([^\s\)]*)/);if(j&&j[1]){n.gecko=r(j[1])}}}}}}return n};YAHOO.env.ua=YAHOO.env.parseUA();(function(){YAHOO.namespace("util","widget","example");if("undefined"!==typeof YAHOO_config){var e=YAHOO_config.listener,f=YAHOO.env.listeners,h=true,i;if(e){for(i=0;i<f.length;i++){if(f[i]==e){h=false;break}}if(h){f.push(e)}}}})();YAHOO.lang=YAHOO.lang||{};(function(){var o=YAHOO.lang,y=Object.prototype,v="[object Array]",m="[object Function]",j="[object Object]",w=[],n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;","`":"&#x60;"},u=["toString","valueOf"],r={isArray:function(b){return y.toString.apply(b)===v},isBoolean:function(b){return typeof b==="boolean"},isFunction:function(b){return(typeof b==="function")||y.toString.apply(b)===m},isNull:function(b){return b===null},isNumber:function(b){return typeof b==="number"&&isFinite(b)},isObject:function(b){return(b&&(typeof b==="object"||o.isFunction(b)))||false},isString:function(b){return typeof b==="string"},isUndefined:function(b){return typeof b==="undefined"},_IEEnumFix:(YAHOO.env.ua.ie)?function(c,d){var e,f,b;for(e=0;e<u.length;e=e+1){f=u[e];b=d[f];if(o.isFunction(b)&&b!=y[f]){c[f]=b}}}:function(){},escapeHTML:function(b){return b.replace(/[&<>"'\/`]/g,function(c){return n[c]})},extend:function(b,f,c){if(!f||!b){throw new Error("extend failed, please check that all dependencies are included.")}var d=function(){},e;d.prototype=f.prototype;b.prototype=new d();b.prototype.constructor=b;b.superclass=f.prototype;if(f.prototype.constructor==y.constructor){f.prototype.constructor=f}if(c){for(e in c){if(o.hasOwnProperty(c,e)){b.prototype[e]=c[e]}}o._IEEnumFix(b.prototype,c)}},augmentObject:function(h,b){if(!b||!h){throw new Error("Absorb failed, verify dependencies.")}var e=arguments,c,f,d=e[2];if(d&&d!==true){for(c=2;c<e.length;c=c+1){h[e[c]]=b[e[c]]}}else{for(f in b){if(d||!(f in h)){h[f]=b[f]}}o._IEEnumFix(h,b)}return h},augmentProto:function(b,c){if(!c||!b){throw new Error("Augment failed, verify dependencies.")}var e=[b.prototype,c.prototype],d;for(d=2;d<arguments.length;d=d+1){e.push(arguments[d])}o.augmentObject.apply(this,e);return b},dump:function(A,d){var h,e,b=[],B="{...}",i="f(){...}",c=", ",f=" => ";if(!o.isObject(A)){return A+""}else{if(A instanceof Date||("nodeType" in A&&"tagName" in A)){return A}else{if(o.isFunction(A)){return i}}}d=(o.isNumber(d))?d:3;if(o.isArray(A)){b.push("[");for(h=0,e=A.length;h<e;h=h+1){if(o.isObject(A[h])){b.push((d>0)?o.dump(A[h],d-1):B)}else{b.push(A[h])}b.push(c)}if(b.length>1){b.pop()}b.push("]")}else{b.push("{");for(h in A){if(o.hasOwnProperty(A,h)){b.push(h+f);if(o.isObject(A[h])){b.push((d>0)?o.dump(A[h],d-1):B)}else{b.push(A[h])}b.push(c)}}if(b.length>1){b.pop()}b.push("}")}return b.join("")},substitute:function(d,c,H,S){var J,K,M,f,I,i,h=[],P,b=d.length,O="dump",L=" ",N="{",R="}",Q,e;for(;;){J=d.lastIndexOf(N,b);if(J<0){break}K=d.indexOf(R,J);if(J+1>K){break}P=d.substring(J+1,K);f=P;i=null;M=f.indexOf(L);if(M>-1){i=f.substring(M+1);f=f.substring(0,M)}I=c[f];if(H){I=H(f,I,i)}if(o.isObject(I)){if(o.isArray(I)){I=o.dump(I,parseInt(i,10))}else{i=i||"";Q=i.indexOf(O);if(Q>-1){i=i.substring(4)}e=I.toString();if(e===j||Q>-1){I=o.dump(I,parseInt(i,10))}else{I=e}}}else{if(!o.isString(I)&&!o.isNumber(I)){I="~-"+h.length+"-~";h[h.length]=P}}d=d.substring(0,J)+I+d.substring(K+1);if(S===false){b=J-1}}for(J=h.length-1;J>=0;J=J-1){d=d.replace(new RegExp("~-"+J+"-~"),"{"+h[J]+"}","g")}return d},trim:function(c){try{return c.replace(/^\s+|\s+$/g,"")}catch(b){return c}},merge:function(){var e={},c=arguments,d=c.length,b;
for(b=0;b<d;b=b+1){o.augmentObject(e,c[b],true)}return e},later:function(A,f,i,d,c){A=A||0;f=f||{};var e=i,B=d,b,h;if(o.isString(i)){e=f[i]}if(!e){throw new TypeError("method undefined")}if(!o.isUndefined(d)&&!o.isArray(B)){B=[d]}b=function(){e.apply(f,B||w)};h=(c)?setInterval(b,A):setTimeout(b,A);return{interval:c,cancel:function(){if(this.interval){clearInterval(h)}else{clearTimeout(h)}}}},isValue:function(b){return(o.isObject(b)||o.isString(b)||o.isNumber(b)||o.isBoolean(b))}};o.hasOwnProperty=(y.hasOwnProperty)?function(c,b){return c&&c.hasOwnProperty&&c.hasOwnProperty(b)}:function(c,b){return !o.isUndefined(c[b])&&c.constructor.prototype[b]!==c[b]};r.augmentObject(o,r,true);YAHOO.util.Lang=o;o.augment=o.augmentProto;YAHOO.augment=o.augmentProto;YAHOO.extend=o.extend})();YAHOO.register("yahoo",YAHOO,{version:"2.9.0",build:"2800"});
;var CryptoJS=CryptoJS||(function(B,y){var F={};var E=F.lib={};var u=E.Base=(function(){function b(){}return{extend:function(c){b.prototype=this;var d=new b();if(c){d.mixIn(c)}if(!d.hasOwnProperty("init")){d.init=function(){d.$super.init.apply(this,arguments)}}d.init.prototype=d;d.$super=this;return d},create:function(){var c=this.extend();c.init.apply(c,arguments);return c},init:function(){},mixIn:function(c){for(var d in c){if(c.hasOwnProperty(d)){this[d]=c[d]}}if(c.hasOwnProperty("toString")){this.toString=c.toString}},clone:function(){return this.init.prototype.extend(this)}}}());var o=E.WordArray=u.extend({init:function(b,c){b=this.words=b||[];if(c!=y){this.sigBytes=c}else{this.sigBytes=b.length*4}},toString:function(b){return(b||w).stringify(this)},concat:function(b){var e=this.words;var f=b.words;var i=this.sigBytes;var c=b.sigBytes;this.clamp();if(i%4){for(var d=0;d<c;d++){var h=(f[d>>>2]>>>(24-(d%4)*8))&255;e[(i+d)>>>2]|=h<<(24-((i+d)%4)*8)}}else{for(var d=0;d<c;d+=4){e[(i+d)>>>2]=f[d>>>2]}}this.sigBytes+=c;return this},clamp:function(){var b=this.words;var c=this.sigBytes;b[c>>>2]&=4294967295<<(32-(c%4)*8);b.length=B.ceil(c/4)},clone:function(){var b=u.clone.call(this);b.words=this.words.slice(0);return b},random:function(b){var c=[];for(var d=0;d<b;d+=4){c.push((B.random()*4294967296)|0)}return new o.init(c,b)}});var n=F.enc={};var w=n.Hex={stringify:function(e){var c=e.words;var f=e.sigBytes;var d=[];for(var h=0;h<f;h++){var b=(c[h>>>2]>>>(24-(h%4)*8))&255;d.push((b>>>4).toString(16));d.push((b&15).toString(16))}return d.join("")},parse:function(c){var e=c.length;var b=[];for(var d=0;d<e;d+=2){b[d>>>3]|=parseInt(c.substr(d,2),16)<<(24-(d%8)*4)}return new o.init(b,e/2)}};var C=n.Latin1={stringify:function(d){var c=d.words;var e=d.sigBytes;var h=[];for(var f=0;f<e;f++){var b=(c[f>>>2]>>>(24-(f%4)*8))&255;h.push(String.fromCharCode(b))}return h.join("")},parse:function(c){var e=c.length;var b=[];for(var d=0;d<e;d++){b[d>>>2]|=(c.charCodeAt(d)&255)<<(24-(d%4)*8)}return new o.init(b,e)}};var D=n.Utf8={stringify:function(c){try{return decodeURIComponent(escape(C.stringify(c)))}catch(b){throw new Error("Malformed UTF-8 data")}},parse:function(b){return C.parse(unescape(encodeURIComponent(b)))}};var v=E.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new o.init();this._nDataBytes=0},_append:function(b){if(typeof b=="string"){b=D.parse(b)}this._data.concat(b);this._nDataBytes+=b.sigBytes},_process:function(i){var c=this._data;var h=c.words;var f=c.sigBytes;var G=this.blockSize;var j=G*4;var m=f/j;if(i){m=B.ceil(m)}else{m=B.max((m|0)-this._minBufferSize,0)}var H=m*G;var b=B.min(H*4,f);if(H){for(var d=0;d<H;d+=G){this._doProcessBlock(h,d)}var e=h.splice(0,H);c.sigBytes-=b}return new o.init(e,b)},clone:function(){var b=u.clone.call(this);b._data=this._data.clone();
return b},_minBufferSize:0});var A=E.Hasher=v.extend({cfg:u.extend(),init:function(b){this.cfg=this.cfg.extend(b);this.reset()},reset:function(){v.reset.call(this);this._doReset()},update:function(b){this._append(b);this._process();return this},finalize:function(c){if(c){this._append(c)}var b=this._doFinalize();return b},blockSize:512/32,_createHelper:function(b){return function(c,d){return new b.init(d).finalize(c)}},_createHmacHelper:function(b){return function(c,d){return new r.HMAC.init(b,d).finalize(c)}}});var r=F.algo={};return F}(Math));(function(d){var b=CryptoJS,i=b.lib,j=i.Base,c=i.WordArray,b=b.x64={};b.Word=j.extend({init:function(e,f){this.high=e;this.low=f}});b.WordArray=j.extend({init:function(e,f){e=this.words=e||[];this.sigBytes=f!=d?f:8*e.length},toX32:function(){for(var f=this.words,o=f.length,h=[],n=0;n<o;n++){var m=f[n];h.push(m.high);h.push(m.low)}return c.create(h,this.sigBytes)},clone:function(){for(var e=j.clone.call(this),m=e.words=this.words.slice(0),f=m.length,h=0;h<f;h++){m[h]=m[h].clone()}return e}})})();(function(){var d=CryptoJS,b=d.enc.Utf8;d.algo.HMAC=d.lib.Base.extend({init:function(y,w){y=this._hasher=new y.init;"string"==typeof w&&(w=b.parse(w));var v=y.blockSize,r=4*v;w.sigBytes>r&&(w=y.finalize(w));w.clamp();for(var o=this._oKey=w.clone(),n=this._iKey=w.clone(),m=o.words,i=n.words,u=0;u<v;u++){m[u]^=1549556828,i[u]^=909522486}o.sigBytes=n.sigBytes=r;this.reset()},reset:function(){var c=this._hasher;c.reset();c.update(this._iKey)},update:function(c){this._hasher.update(c);return this},finalize:function(e){var c=this._hasher;e=c.finalize(e);c.reset();return c.finalize(this._oKey.clone().concat(e))}})})();(function(i){for(var y=CryptoJS,o=y.lib,D=o.WordArray,m=o.Hasher,o=y.algo,G=[],F=[],E=function(b){return 4294967296*(b-(b|0))|0},f=2,B=0;64>B;){var A;a:{A=f;for(var C=i.sqrt(A),c=2;c<=C;c++){if(!(A%c)){A=!1;break a}}A=!0}A&&(8>B&&(G[B]=E(i.pow(f,0.5))),F[B]=E(i.pow(f,1/3)),B++);f++}var e=[],o=o.SHA256=m.extend({_doReset:function(){this._hash=new D.init(G.slice(0))},_doProcessBlock:function(n,I){for(var P=this._hash.words,N=P[0],M=P[1],O=P[2],w=P[3],K=P[4],J=P[5],H=P[6],v=P[7],L=0;64>L;L++){if(16>L){e[L]=n[I+L]|0}else{var u=e[L-15],r=e[L-2];e[L]=((u<<25|u>>>7)^(u<<14|u>>>18)^u>>>3)+e[L-7]+((r<<15|r>>>17)^(r<<13|r>>>19)^r>>>10)+e[L-16]}u=v+((K<<26|K>>>6)^(K<<21|K>>>11)^(K<<7|K>>>25))+(K&J^~K&H)+F[L]+e[L];r=((N<<30|N>>>2)^(N<<19|N>>>13)^(N<<10|N>>>22))+(N&M^N&O^M&O);v=H;H=J;J=K;K=w+u|0;w=O;O=M;M=N;N=u+r|0}P[0]=P[0]+N|0;P[1]=P[1]+M|0;P[2]=P[2]+O|0;P[3]=P[3]+w|0;P[4]=P[4]+K|0;P[5]=P[5]+J|0;P[6]=P[6]+H|0;P[7]=P[7]+v|0},_doFinalize:function(){var n=this._data,h=n.words,j=8*this._nDataBytes,r=8*n.sigBytes;h[r>>>5]|=128<<24-r%32;h[(r+64>>>9<<4)+14]=i.floor(j/4294967296);h[(r+64>>>9<<4)+15]=j;n.sigBytes=4*h.length;this._process();return this._hash},clone:function(){var d=m.clone.call(this);d._hash=this._hash.clone();return d}});y.SHA256=m._createHelper(o);y.HmacSHA256=m._createHmacHelper(o)})(Math);(function(){var e=CryptoJS,h=e.lib.WordArray,f=e.algo,i=f.SHA256,f=f.SHA224=i.extend({_doReset:function(){this._hash=new h.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var b=i._doFinalize.call(this);b.sigBytes-=4;return b}});e.SHA224=i._createHelper(f);e.HmacSHA224=i._createHmacHelper(f)})();(function(){function m(){return i.create.apply(i,arguments)}for(var c=CryptoJS,b=c.lib.Hasher,h=c.x64,i=h.Word,f=h.WordArray,h=c.algo,j=[m(1116352408,3609767458),m(1899447441,602891725),m(3049323471,3964484399),m(3921009573,2173295548),m(961987163,4081628472),m(1508970993,3053834265),m(2453635748,2937671579),m(2870763221,3664609560),m(3624381080,2734883394),m(310598401,1164996542),m(607225278,1323610764),m(1426881987,3590304994),m(1925078388,4068182383),m(2162078206,991336113),m(2614888103,633803317),m(3248222580,3479774868),m(3835390401,2666613458),m(4022224774,944711139),m(264347078,2341262773),m(604807628,2007800933),m(770255983,1495990901),m(1249150122,1856431235),m(1555081692,3175218132),m(1996064986,2198950837),m(2554220882,3999719339),m(2821834349,766784016),m(2952996808,2566594879),m(3210313671,3203337956),m(3336571891,1034457026),m(3584528711,2466948901),m(113926993,3758326383),m(338241895,168717936),m(666307205,1188179964),m(773529912,1546045734),m(1294757372,1522805485),m(1396182291,2643833823),m(1695183700,2343527390),m(1986661051,1014477480),m(2177026350,1206759142),m(2456956037,344077627),m(2730485921,1290863460),m(2820302411,3158454273),m(3259730800,3505952657),m(3345764771,106217008),m(3516065817,3606008344),m(3600352804,1432725776),m(4094571909,1467031594),m(275423344,851169720),m(430227734,3100823752),m(506948616,1363258195),m(659060556,3750685593),m(883997877,3785050280),m(958139571,3318307427),m(1322822218,3812723403),m(1537002063,2003034995),m(1747873779,3602036899),m(1955562222,1575990012),m(2024104815,1125592928),m(2227730452,2716904306),m(2361852424,442776044),m(2428436474,593698344),m(2756734187,3733110249),m(3204031479,2999351573),m(3329325298,3815920427),m(3391569614,3928383900),m(3515267271,566280711),m(3940187606,3454069534),m(4118630271,4000239992),m(116418474,1914138554),m(174292421,2731055270),m(289380356,3203993006),m(460393269,320620315),m(685471733,587496836),m(852142971,1086792851),m(1017036298,365543100),m(1126000580,2618297676),m(1288033470,3409855158),m(1501505948,4234509866),m(1607167915,987167468),m(1816402316,1246189591)],u=[],o=0;
80>o;o++){u[o]=m()}h=h.SHA512=b.extend({_doReset:function(){this._hash=new f.init([new i.init(1779033703,4089235720),new i.init(3144134277,2227873595),new i.init(1013904242,4271175723),new i.init(2773480762,1595750129),new i.init(1359893119,2917565137),new i.init(2600822924,725511199),new i.init(528734635,4215389547),new i.init(1541459225,327033209)])},_doProcessBlock:function(a2,aZ){for(var aX=this._hash.words,av=aX[0],aY=aX[1],aQ=aX[2],aN=aX[3],au=aX[4],at=aX[5],ar=aX[6],aX=aX[7],aJ=av.high,aq=av.low,ac=aY.high,ap=aY.low,ab=aQ.high,ao=aQ.low,v=aN.high,an=aN.low,aD=au.high,am=au.low,aB=at.high,al=at.low,a3=ar.high,ak=ar.low,aE=aX.high,aj=aX.low,aT=aJ,aW=aq,aG=ac,aI=ap,aA=ab,aH=ao,af=v,az=an,aS=aD,aV=am,ai=aB,ay=al,ah=a3,ax=ak,ae=aE,aw=aj,aR=0;80>aR;aR++){var aM=u[aR];if(16>aR){var aU=aM.high=a2[aZ+2*aR]|0,a1=aM.low=a2[aZ+2*aR+1]|0}else{var aU=u[aR-15],a1=aU.high,aP=aU.low,aU=(a1>>>1|aP<<31)^(a1>>>8|aP<<24)^a1>>>7,aP=(aP>>>1|a1<<31)^(aP>>>8|a1<<24)^(aP>>>7|a1<<25),aK=u[aR-2],a1=aK.high,a0=aK.low,aK=(a1>>>19|a0<<13)^(a1<<3|a0>>>29)^a1>>>6,a0=(a0>>>19|a1<<13)^(a0<<3|a1>>>29)^(a0>>>6|a1<<26),a1=u[aR-7],ad=a1.high,aL=u[aR-16],aO=aL.high,aL=aL.low,a1=aP+a1.low,aU=aU+ad+(a1>>>0<aP>>>0?1:0),a1=a1+a0,aU=aU+aK+(a1>>>0<a0>>>0?1:0),a1=a1+aL,aU=aU+aO+(a1>>>0<aL>>>0?1:0);aM.high=aU;aM.low=a1}var ad=aS&ai^~aS&ah,aL=aV&ay^~aV&ax,aM=aT&aG^aT&aA^aG&aA,ag=aW&aI^aW&aH^aI&aH,aP=(aT>>>28|aW<<4)^(aT<<30|aW>>>2)^(aT<<25|aW>>>7),aK=(aW>>>28|aT<<4)^(aW<<30|aT>>>2)^(aW<<25|aT>>>7),a0=j[aR],aF=a0.high,aC=a0.low,a0=aw+((aV>>>14|aS<<18)^(aV>>>18|aS<<14)^(aV<<23|aS>>>9)),aO=ae+((aS>>>14|aV<<18)^(aS>>>18|aV<<14)^(aS<<23|aV>>>9))+(a0>>>0<aw>>>0?1:0),a0=a0+aL,aO=aO+ad+(a0>>>0<aL>>>0?1:0),a0=a0+aC,aO=aO+aF+(a0>>>0<aC>>>0?1:0),a0=a0+a1,aO=aO+aU+(a0>>>0<a1>>>0?1:0),a1=aK+ag,aM=aP+aM+(a1>>>0<aK>>>0?1:0),ae=ah,aw=ax,ah=ai,ax=ay,ai=aS,ay=aV,aV=az+a0|0,aS=af+aO+(aV>>>0<az>>>0?1:0)|0,af=aA,az=aH,aA=aG,aH=aI,aG=aT,aI=aW,aW=a0+a1|0,aT=aO+aM+(aW>>>0<a0>>>0?1:0)|0}aq=av.low=aq+aW;av.high=aJ+aT+(aq>>>0<aW>>>0?1:0);ap=aY.low=ap+aI;aY.high=ac+aG+(ap>>>0<aI>>>0?1:0);ao=aQ.low=ao+aH;aQ.high=ab+aA+(ao>>>0<aH>>>0?1:0);an=aN.low=an+az;aN.high=v+af+(an>>>0<az>>>0?1:0);am=au.low=am+aV;au.high=aD+aS+(am>>>0<aV>>>0?1:0);al=at.low=al+ay;at.high=aB+ai+(al>>>0<ay>>>0?1:0);ak=ar.low=ak+ax;ar.high=a3+ah+(ak>>>0<ax>>>0?1:0);aj=aX.low=aj+aw;aX.high=aE+ae+(aj>>>0<aw>>>0?1:0)},_doFinalize:function(){var n=this._data,w=n.words,r=8*this._nDataBytes,v=8*n.sigBytes;w[v>>>5]|=128<<24-v%32;w[(v+128>>>10<<5)+30]=Math.floor(r/4294967296);w[(v+128>>>10<<5)+31]=r;n.sigBytes=4*w.length;this._process();return this._hash.toX32()},clone:function(){var d=b.clone.call(this);d._hash=this._hash.clone();return d},blockSize:32});c.SHA512=b._createHelper(h);c.HmacSHA512=b._createHmacHelper(h)})();(function(){var m=CryptoJS,h=m.x64,f=h.Word,i=h.WordArray,h=m.algo,j=h.SHA512,h=h.SHA384=j.extend({_doReset:function(){this._hash=new i.init([new f.init(3418070365,3238371032),new f.init(1654270250,914150663),new f.init(2438529370,812702999),new f.init(355462360,4144912697),new f.init(1731405415,4290775857),new f.init(2394180231,1750603025),new f.init(3675008525,1694076839),new f.init(1203062813,3204075428)])},_doFinalize:function(){var b=j._doFinalize.call(this);b.sigBytes-=16;return b}});m.SHA384=j._createHelper(h);m.HmacSHA384=j._createHmacHelper(h)})();(function(v){function i(n,B,A,w,C,y,r){n=n+(B&A|~B&w)+C+r;return(n<<y|n>>>32-y)+B}function f(n,B,A,w,C,y,r){n=n+(B&w|A&~w)+C+r;return(n<<y|n>>>32-y)+B}function e(r,C,B,y,A,w,n){r=r+(C^B^y)+A+n;return(r<<w|r>>>32-w)+C}function d(r,C,B,y,A,w,n){r=r+(B^(C|~y))+A+n;return(r<<w|r>>>32-w)+C}for(var b=CryptoJS,c=b.lib,o=c.WordArray,u=c.Hasher,c=b.algo,j=[],m=0;64>m;m++){j[m]=4294967296*v.abs(v.sin(m+1))|0}c=c.MD5=u.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(R,U){for(var T=0;16>T;T++){var S=U+T,Q=R[S];R[S]=(Q<<8|Q>>>24)&16711935|(Q<<24|Q>>>8)&4278255360}var T=this._hash.words,S=R[U+0],Q=R[U+1],O=R[U+2],M=R[U+3],K=R[U+4],I=R[U+5],H=R[U+6],G=R[U+7],F=R[U+8],E=R[U+9],n=R[U+10],h=R[U+11],P=R[U+12],N=R[U+13],L=R[U+14],J=R[U+15],Y=T[0],X=T[1],W=T[2],V=T[3],Y=i(Y,X,W,V,S,7,j[0]),V=i(V,Y,X,W,Q,12,j[1]),W=i(W,V,Y,X,O,17,j[2]),X=i(X,W,V,Y,M,22,j[3]),Y=i(Y,X,W,V,K,7,j[4]),V=i(V,Y,X,W,I,12,j[5]),W=i(W,V,Y,X,H,17,j[6]),X=i(X,W,V,Y,G,22,j[7]),Y=i(Y,X,W,V,F,7,j[8]),V=i(V,Y,X,W,E,12,j[9]),W=i(W,V,Y,X,n,17,j[10]),X=i(X,W,V,Y,h,22,j[11]),Y=i(Y,X,W,V,P,7,j[12]),V=i(V,Y,X,W,N,12,j[13]),W=i(W,V,Y,X,L,17,j[14]),X=i(X,W,V,Y,J,22,j[15]),Y=f(Y,X,W,V,Q,5,j[16]),V=f(V,Y,X,W,H,9,j[17]),W=f(W,V,Y,X,h,14,j[18]),X=f(X,W,V,Y,S,20,j[19]),Y=f(Y,X,W,V,I,5,j[20]),V=f(V,Y,X,W,n,9,j[21]),W=f(W,V,Y,X,J,14,j[22]),X=f(X,W,V,Y,K,20,j[23]),Y=f(Y,X,W,V,E,5,j[24]),V=f(V,Y,X,W,L,9,j[25]),W=f(W,V,Y,X,M,14,j[26]),X=f(X,W,V,Y,F,20,j[27]),Y=f(Y,X,W,V,N,5,j[28]),V=f(V,Y,X,W,O,9,j[29]),W=f(W,V,Y,X,G,14,j[30]),X=f(X,W,V,Y,P,20,j[31]),Y=e(Y,X,W,V,I,4,j[32]),V=e(V,Y,X,W,F,11,j[33]),W=e(W,V,Y,X,h,16,j[34]),X=e(X,W,V,Y,L,23,j[35]),Y=e(Y,X,W,V,Q,4,j[36]),V=e(V,Y,X,W,K,11,j[37]),W=e(W,V,Y,X,G,16,j[38]),X=e(X,W,V,Y,n,23,j[39]),Y=e(Y,X,W,V,N,4,j[40]),V=e(V,Y,X,W,S,11,j[41]),W=e(W,V,Y,X,M,16,j[42]),X=e(X,W,V,Y,H,23,j[43]),Y=e(Y,X,W,V,E,4,j[44]),V=e(V,Y,X,W,P,11,j[45]),W=e(W,V,Y,X,J,16,j[46]),X=e(X,W,V,Y,O,23,j[47]),Y=d(Y,X,W,V,S,6,j[48]),V=d(V,Y,X,W,G,10,j[49]),W=d(W,V,Y,X,L,15,j[50]),X=d(X,W,V,Y,I,21,j[51]),Y=d(Y,X,W,V,P,6,j[52]),V=d(V,Y,X,W,M,10,j[53]),W=d(W,V,Y,X,n,15,j[54]),X=d(X,W,V,Y,Q,21,j[55]),Y=d(Y,X,W,V,F,6,j[56]),V=d(V,Y,X,W,J,10,j[57]),W=d(W,V,Y,X,H,15,j[58]),X=d(X,W,V,Y,N,21,j[59]),Y=d(Y,X,W,V,K,6,j[60]),V=d(V,Y,X,W,h,10,j[61]),W=d(W,V,Y,X,O,15,j[62]),X=d(X,W,V,Y,E,21,j[63]);
T[0]=T[0]+Y|0;T[1]=T[1]+X|0;T[2]=T[2]+W|0;T[3]=T[3]+V|0},_doFinalize:function(){var n=this._data,A=n.words,y=8*this._nDataBytes,r=8*n.sigBytes;A[r>>>5]|=128<<24-r%32;var w=v.floor(y/4294967296);A[(r+64>>>9<<4)+15]=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360;A[(r+64>>>9<<4)+14]=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360;n.sigBytes=4*(A.length+1);this._process();n=this._hash;A=n.words;for(y=0;4>y;y++){r=A[y],A[y]=(r<<8|r>>>24)&16711935|(r<<24|r>>>8)&4278255360}return n},clone:function(){var h=u.clone.call(this);h._hash=this._hash.clone();return h}});b.MD5=u._createHelper(c);b.HmacMD5=u._createHmacHelper(c)})(Math);(function(){var c=CryptoJS,b=c.lib.WordArray;c.enc.Base64={stringify:function(h){var n=h.words,m=h.sigBytes,r=this._map;h.clamp();h=[];for(var i=0;i<m;i+=3){for(var o=(n[i>>>2]>>>24-8*(i%4)&255)<<16|(n[i+1>>>2]>>>24-8*((i+1)%4)&255)<<8|n[i+2>>>2]>>>24-8*((i+2)%4)&255,j=0;4>j&&i+0.75*j<m;j++){h.push(r.charAt(o>>>6*(3-j)&63))}}if(n=r.charAt(64)){for(;h.length%4;){h.push(n)}}return h.join("")},parse:function(i){var r=i.length,o=this._map,v=o.charAt(64);v&&(v=i.indexOf(v),-1!=v&&(r=v));for(var v=[],j=0,u=0;u<r;u++){if(u%4){var n=o.indexOf(i.charAt(u-1))<<2*(u%4),m=o.indexOf(i.charAt(u))>>>6-2*(u%4);v[j>>>2]|=(n|m)<<24-8*(j%4);j++}}return b.create(v,j)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})();CryptoJS.lib.Cipher||function(E){var B=CryptoJS,C=B.lib,w=C.Base,o=C.WordArray,c=C.BufferedBlockAlgorithm,b=B.enc.Base64,D=B.algo.EvpKDF,e=C.Cipher=c.extend({cfg:w.extend(),createEncryptor:function(h,f){return this.create(this._ENC_XFORM_MODE,h,f)},createDecryptor:function(h,f){return this.create(this._DEC_XFORM_MODE,h,f)},init:function(h,f,j){this.cfg=this.cfg.extend(j);this._xformMode=h;this._key=f;this.reset()},reset:function(){c.reset.call(this);this._doReset()},process:function(f){this._append(f);return this._process()},finalize:function(f){f&&this._append(f);return this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(f){return{encrypt:function(h,m,j){return("string"==typeof m?G:y).encrypt(f,h,m,j)},decrypt:function(h,m,j){return("string"==typeof m?G:y).decrypt(f,h,m,j)}}}});C.StreamCipher=e.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var i=B.mode={},F=function(h,f,n){var m=this._iv;m?this._iv=E:m=this._prevBlock;for(var j=0;j<n;j++){h[f+j]^=m[j]}},A=(C.BlockCipherMode=w.extend({createEncryptor:function(h,f){return this.Encryptor.create(h,f)},createDecryptor:function(h,f){return this.Decryptor.create(h,f)},init:function(h,f){this._cipher=h;this._iv=f}})).extend();A.Encryptor=A.extend({processBlock:function(h,f){var m=this._cipher,j=m.blockSize;F.call(this,h,f,j);m.encryptBlock(h,f);this._prevBlock=h.slice(f,f+j)}});A.Decryptor=A.extend({processBlock:function(h,f){var n=this._cipher,m=n.blockSize,j=h.slice(f,f+m);n.decryptBlock(h,f);F.call(this,h,f,m);this._prevBlock=j}});i=i.CBC=A;A=(B.pad={}).Pkcs7={pad:function(j,h){for(var u=4*h,u=u-j.sigBytes%u,r=u<<24|u<<16|u<<8|u,n=[],m=0;m<u;m+=4){n.push(r)}u=o.create(n,u);j.concat(u)},unpad:function(f){f.sigBytes-=f.words[f.sigBytes-1>>>2]&255}};C.BlockCipher=e.extend({cfg:e.cfg.extend({mode:i,padding:A}),reset:function(){e.reset.call(this);var h=this.cfg,f=h.iv,h=h.mode;if(this._xformMode==this._ENC_XFORM_MODE){var j=h.createEncryptor}else{j=h.createDecryptor,this._minBufferSize=1}this._mode=j.call(h,this,f&&f.words)},_doProcessBlock:function(h,f){this._mode.processBlock(h,f)},_doFinalize:function(){var h=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){h.pad(this._data,this.blockSize);var f=this._process(!0)}else{f=this._process(!0),h.unpad(f)}return f},blockSize:4});var d=C.CipherParams=w.extend({init:function(f){this.mixIn(f)},toString:function(f){return(f||this.formatter).stringify(this)}}),i=(B.format={}).OpenSSL={stringify:function(h){var f=h.ciphertext;h=h.salt;return(h?o.create([1398893684,1701076831]).concat(h).concat(f):f).toString(b)},parse:function(h){h=b.parse(h);
var f=h.words;if(1398893684==f[0]&&1701076831==f[1]){var j=o.create(f.slice(2,4));f.splice(0,4);h.sigBytes-=16}return d.create({ciphertext:h,salt:j})}},y=C.SerializableCipher=w.extend({cfg:w.extend({format:i}),encrypt:function(h,f,n,m){m=this.cfg.extend(m);var j=h.createEncryptor(n,m);f=j.finalize(f);j=j.cfg;return d.create({ciphertext:f,key:n,iv:j.iv,algorithm:h,mode:j.mode,padding:j.padding,blockSize:h.blockSize,formatter:m.format})},decrypt:function(h,f,m,j){j=this.cfg.extend(j);f=this._parse(f,j.format);return h.createDecryptor(m,j).finalize(f.ciphertext)},_parse:function(h,f){return"string"==typeof h?f.parse(h,this):h}}),B=(B.kdf={}).OpenSSL={execute:function(h,f,m,j){j||(j=o.random(8));h=D.create({keySize:f+m}).compute(h,j);m=o.create(h.words.slice(f),4*m);h.sigBytes=4*f;return d.create({key:h,iv:m,salt:j})}},G=C.PasswordBasedCipher=y.extend({cfg:y.cfg.extend({kdf:B}),encrypt:function(h,f,m,j){j=this.cfg.extend(j);m=j.kdf.execute(m,h.keySize,h.ivSize);j.iv=m.iv;h=y.encrypt.call(this,h,f,m.key,j);h.mixIn(m);return h},decrypt:function(h,f,m,j){j=this.cfg.extend(j);f=this._parse(f,j.format);m=j.kdf.execute(m,h.keySize,h.ivSize,f.salt);j.iv=m.iv;return y.decrypt.call(this,h,f,m.key,j)}})}();(function(){for(var N=CryptoJS,e=N.lib.BlockCipher,L=N.algo,S=[],d=[],c=[],O=[],M=[],K=[],J=[],o=[],i=[],h=[],T=[],R=0;256>R;R++){T[R]=128>R?R<<1:R<<1^283}for(var P=0,Q=0,R=0;256>R;R++){var U=Q^Q<<1^Q<<2^Q<<3^Q<<4,U=U>>>8^U&255^99;S[P]=U;d[U]=P;var H=T[P],I=T[H],G=T[I],V=257*T[U]^16843008*U;c[P]=V<<24|V>>>8;O[P]=V<<16|V>>>16;M[P]=V<<8|V>>>24;K[P]=V;V=16843009*G^65537*I^257*H^16843008*P;J[U]=V<<24|V>>>8;o[U]=V<<16|V>>>16;i[U]=V<<8|V>>>24;h[U]=V;P?(P=H^T[T[T[G^H]]],Q^=T[T[Q]]):P=Q=1}var m=[0,1,2,4,8,16,32,64,128,27,54],L=L.AES=e.extend({_doReset:function(){for(var v=this._key,r=v.words,j=v.sigBytes/4,v=4*((this._nRounds=j+6)+1),f=this._keySchedule=[],n=0;n<v;n++){if(n<j){f[n]=r[n]}else{var u=f[n-1];n%j?6<j&&4==n%j&&(u=S[u>>>24]<<24|S[u>>>16&255]<<16|S[u>>>8&255]<<8|S[u&255]):(u=u<<8|u>>>24,u=S[u>>>24]<<24|S[u>>>16&255]<<16|S[u>>>8&255]<<8|S[u&255],u^=m[n/j|0]<<24);f[n]=f[n-j]^u}}r=this._invKeySchedule=[];for(j=0;j<v;j++){n=v-j,u=j%4?f[n]:f[n-4],r[j]=4>j||4>=n?u:J[S[u>>>24]]^o[S[u>>>16&255]]^i[S[u>>>8&255]]^h[S[u&255]]}},encryptBlock:function(f,b){this._doCryptBlock(f,b,this._keySchedule,c,O,M,K,S)},decryptBlock:function(j,f){var b=j[f+1];j[f+1]=j[f+3];j[f+3]=b;this._doCryptBlock(j,f,this._invKeySchedule,J,o,i,h,d);b=j[f+1];j[f+1]=j[f+3];j[f+3]=b},_doCryptBlock:function(ab,Z,ad,ac,W,aa,F,C){for(var B=this._nRounds,Y=ab[Z]^ad[0],X=ab[Z+1]^ad[1],E=ab[Z+2]^ad[2],A=ab[Z+3]^ad[3],D=4,u=1;u<B;u++){var y=ac[Y>>>24]^W[X>>>16&255]^aa[E>>>8&255]^F[A&255]^ad[D++],w=ac[X>>>24]^W[E>>>16&255]^aa[A>>>8&255]^F[Y&255]^ad[D++],v=ac[E>>>24]^W[A>>>16&255]^aa[Y>>>8&255]^F[X&255]^ad[D++],A=ac[A>>>24]^W[Y>>>16&255]^aa[X>>>8&255]^F[E&255]^ad[D++],Y=y,X=w,E=v}y=(C[Y>>>24]<<24|C[X>>>16&255]<<16|C[E>>>8&255]<<8|C[A&255])^ad[D++];w=(C[X>>>24]<<24|C[E>>>16&255]<<16|C[A>>>8&255]<<8|C[Y&255])^ad[D++];v=(C[E>>>24]<<24|C[A>>>16&255]<<16|C[Y>>>8&255]<<8|C[X&255])^ad[D++];A=(C[A>>>24]<<24|C[Y>>>16&255]<<16|C[X>>>8&255]<<8|C[E&255])^ad[D++];ab[Z]=y;ab[Z+1]=w;ab[Z+2]=v;ab[Z+3]=A},keySize:8});N.AES=e._createHelper(L)})();(function(){function u(e,j){var h=(this._lBlock>>>e^this._rBlock)&j;this._rBlock^=h;this._lBlock^=h<<e}function o(e,j){var h=(this._rBlock>>>e^this._lBlock)&j;this._lBlock^=h;this._rBlock^=h<<e}var v=CryptoJS,y=v.lib,f=y.WordArray,y=y.BlockCipher,w=v.algo,c=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],d=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],b=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],B=[{"0":8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{"0":1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{"0":260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{"0":2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{"0":128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{"0":268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{"0":1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{"0":134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],A=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],i=w.DES=y.extend({_doReset:function(){for(var h=this._key.words,C=[],j=0;
56>j;j++){var m=c[j]-1;C[j]=h[m>>>5]>>>31-m%32&1}h=this._subKeys=[];for(m=0;16>m;m++){for(var r=h[m]=[],n=b[m],j=0;24>j;j++){r[j/6|0]|=C[(d[j]-1+n)%28]<<31-j%6,r[4+(j/6|0)]|=C[28+(d[j+24]-1+n)%28]<<31-j%6}r[0]=r[0]<<1|r[0]>>>31;for(j=1;7>j;j++){r[j]>>>=4*(j-1)+3}r[7]=r[7]<<5|r[7]>>>27}C=this._invSubKeys=[];for(j=0;16>j;j++){C[j]=h[15-j]}},encryptBlock:function(e,h){this._doCryptBlock(e,h,this._subKeys)},decryptBlock:function(e,h){this._doCryptBlock(e,h,this._invSubKeys)},_doCryptBlock:function(F,E,G){this._lBlock=F[E];this._rBlock=F[E+1];u.call(this,4,252645135);u.call(this,16,65535);o.call(this,2,858993459);o.call(this,8,16711935);u.call(this,1,1431655765);for(var r=0;16>r;r++){for(var D=G[r],C=this._lBlock,m=this._rBlock,n=0,j=0;8>j;j++){n|=B[j][((m^D[j])&A[j])>>>0]}this._lBlock=m;this._rBlock=C^n}G=this._lBlock;this._lBlock=this._rBlock;this._rBlock=G;u.call(this,1,1431655765);o.call(this,8,16711935);o.call(this,2,858993459);u.call(this,16,65535);u.call(this,4,252645135);F[E]=this._lBlock;F[E+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});v.DES=y._createHelper(i);w=w.TripleDES=y.extend({_doReset:function(){var e=this._key.words;this._des1=i.createEncryptor(f.create(e.slice(0,2)));this._des2=i.createEncryptor(f.create(e.slice(2,4)));this._des3=i.createEncryptor(f.create(e.slice(4,6)))},encryptBlock:function(e,h){this._des1.encryptBlock(e,h);this._des2.decryptBlock(e,h);this._des3.encryptBlock(e,h)},decryptBlock:function(e,h){this._des3.decryptBlock(e,h);this._des2.encryptBlock(e,h);this._des1.decryptBlock(e,h)},keySize:6,ivSize:2,blockSize:2});v.TripleDES=y._createHelper(w)})();(function(){var h=CryptoJS,e=h.lib,c=e.WordArray,f=e.Hasher,i=[],e=h.algo.SHA1=f.extend({_doReset:function(){this._hash=new c.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(m,d){for(var B=this._hash.words,w=B[0],v=B[1],r=B[2],o=B[3],A=B[4],y=0;80>y;y++){if(16>y){i[y]=m[d+y]|0}else{var u=i[y-3]^i[y-8]^i[y-14]^i[y-16];i[y]=u<<1|u>>>31}u=(w<<5|w>>>27)+A+i[y];u=20>y?u+((v&r|~v&o)+1518500249):40>y?u+((v^r^o)+1859775393):60>y?u+((v&r|v&o|r&o)-1894007588):u+((v^r^o)-899497514);A=o;o=r;r=v<<30|v>>>2;v=w;w=u}B[0]=B[0]+w|0;B[1]=B[1]+v|0;B[2]=B[2]+r|0;B[3]=B[3]+o|0;B[4]=B[4]+A|0},_doFinalize:function(){var j=this._data,o=j.words,m=8*this._nDataBytes,n=8*j.sigBytes;o[n>>>5]|=128<<24-n%32;o[(n+64>>>9<<4)+14]=Math.floor(m/4294967296);o[(n+64>>>9<<4)+15]=m;j.sigBytes=4*o.length;this._process();return this._hash},clone:function(){var d=f.clone.call(this);d._hash=this._hash.clone();return d}});h.SHA1=f._createHelper(e);h.HmacSHA1=f._createHmacHelper(e)})();(function(){var c=CryptoJS,j=c.lib,i=j.WordArray,f=j.Hasher,j=c.algo,r=i.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),o=i.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),m=i.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),h=i.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),e=i.create([0,1518500249,1859775393,2400959708,2840853838]),b=i.create([1352829926,1548603684,1836072691,2053994217,0]),j=j.RIPEMD160=f.extend({_doReset:function(){this._hash=i.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(P,A){for(var S=0;16>S;S++){var R=A+S,O=P[R];P[R]=(O<<8|O>>>24)&16711935|(O<<24|O>>>8)&4278255360}var R=this._hash.words,O=e.words,Q=b.words,H=r.words,F=o.words,G=m.words,y=h.words,C,N,M,L,E,B,K,J,I,D;B=C=R[0];K=N=R[1];J=M=R[2];
I=L=R[3];D=E=R[4];for(var T,S=0;80>S;S+=1){T=C+P[A+H[S]]|0,T=16>S?T+((N^M^L)+O[0]):32>S?T+((N&M|~N&L)+O[1]):48>S?T+(((N|~M)^L)+O[2]):64>S?T+((N&L|M&~L)+O[3]):T+((N^(M|~L))+O[4]),T|=0,T=T<<G[S]|T>>>32-G[S],T=T+E|0,C=E,E=L,L=M<<10|M>>>22,M=N,N=T,T=B+P[A+F[S]]|0,T=16>S?T+((K^(J|~I))+Q[0]):32>S?T+((K&I|J&~I)+Q[1]):48>S?T+(((K|~J)^I)+Q[2]):64>S?T+((K&J|~K&I)+Q[3]):T+((K^J^I)+Q[4]),T|=0,T=T<<y[S]|T>>>32-y[S],T=T+D|0,B=D,D=I,I=J<<10|J>>>22,J=K,K=T}T=R[1]+M+I|0;R[1]=R[2]+L+D|0;R[2]=R[3]+E+B|0;R[3]=R[4]+C+K|0;R[4]=R[0]+N+J|0;R[0]=T},_doFinalize:function(){var u=this._data,v=u.words,n=8*this._nDataBytes,w=8*u.sigBytes;v[w>>>5]|=128<<24-w%32;v[(w+64>>>9<<4)+14]=(n<<8|n>>>24)&16711935|(n<<24|n>>>8)&4278255360;u.sigBytes=4*(v.length+1);this._process();u=this._hash;v=u.words;for(n=0;5>n;n++){w=v[n],v[n]=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360}return u},clone:function(){var n=f.clone.call(this);n._hash=this._hash.clone();return n}});c.RIPEMD160=f._createHelper(j);c.HmacRIPEMD160=f._createHmacHelper(j)})(Math);(function(){var e=CryptoJS,h=e.lib,j=h.Base,c=h.WordArray,h=e.algo,i=h.HMAC,f=h.PBKDF2=j.extend({cfg:j.extend({keySize:4,hasher:h.SHA1,iterations:1}),init:function(b){this.cfg=this.cfg.extend(b)},compute:function(H,G){for(var F=this.cfg,C=i.create(F.hasher,H),B=c.create(),E=c.create([1]),v=B.words,m=E.words,u=F.keySize,F=F.iterations;v.length<u;){var A=C.update(G).finalize(E);C.reset();for(var y=A.words,J=y.length,w=A,o=1;o<F;o++){w=C.finalize(w);C.reset();for(var I=w.words,D=0;D<J;D++){y[D]^=I[D]}}B.concat(A);m[0]++}B.sigBytes=4*u;return B}});e.PBKDF2=function(m,d,n){return f.create(n).compute(m,d)}})();
;var b64map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var b64pad="=";function hex2b64(i){var c;var h;var f="";for(c=0;c+3<=i.length;c+=3){h=parseInt(i.substring(c,c+3),16);f+=b64map.charAt(h>>6)+b64map.charAt(h&63)}if(c+1==i.length){h=parseInt(i.substring(c,c+1),16);f+=b64map.charAt(h<<2)}else{if(c+2==i.length){h=parseInt(i.substring(c,c+2),16);f+=b64map.charAt(h>>2)+b64map.charAt((h&3)<<4)}}if(b64pad){while((f.length&3)>0){f+=b64pad}}return f}function b64tohex(j){var n="";var m;var h=0;var o;var i;for(m=0;m<j.length;++m){if(j.charAt(m)==b64pad){break}i=b64map.indexOf(j.charAt(m));if(i<0){continue}if(h==0){n+=int2char(i>>2);o=i&3;h=1}else{if(h==1){n+=int2char((o<<2)|(i>>4));o=i&15;h=2}else{if(h==2){n+=int2char(o);n+=int2char(i>>2);o=i&3;h=3}else{n+=int2char((o<<2)|(i>>4));n+=int2char(i&15);h=0}}}}if(h==1){n+=int2char(o<<2)}return n}function b64toBA(h){var i=b64tohex(h);var j;var f=new Array();for(j=0;2*j<i.length;++j){f[j]=parseInt(i.substring(2*j,2*j+2),16)}return f}
;var dbits;var canary=244837814094590;var j_lm=((canary&16777215)==15715070);function BigInteger(c,h,b){if(c!=null){if("number"==typeof c){this.fromNumber(c,h,b)}else{if(h==null&&"string"!=typeof c){this.fromString(c,256)}else{this.fromString(c,h)}}}}function nbi(){return new BigInteger(null)}function am1(n,i,c,o,j,m){while(--m>=0){var r=i*this[n++]+c[o]+j;j=Math.floor(r/67108864);c[o++]=r&67108863}return j}function am2(u,h,c,v,j,A){var m=h&32767,i=h>>15;while(--A>=0){var w=this[u]&32767;var n=this[u++]>>15;var y=i*w+n*m;w=m*w+((y&32767)<<15)+c[v]+(j&1073741823);j=(w>>>30)+(y>>>15)+i*n+(j>>>30);c[v++]=w&1073741823}return j}function am3(u,h,c,v,j,A){var m=h&16383,i=h>>14;while(--A>=0){var w=this[u]&16383;var n=this[u++]>>14;var y=i*w+n*m;w=m*w+((y&16383)<<14)+c[v]+j;j=(w>>28)+(y>>14)+i*n;c[v++]=w&268435455}return j}if(j_lm&&(navigator.appName=="Microsoft Internet Explorer")){BigInteger.prototype.am=am2;dbits=30}else{if(j_lm&&(navigator.appName!="Netscape")){BigInteger.prototype.am=am1;dbits=26}else{BigInteger.prototype.am=am3;dbits=28}}BigInteger.prototype.DB=dbits;BigInteger.prototype.DM=((1<<dbits)-1);BigInteger.prototype.DV=(1<<dbits);var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP);BigInteger.prototype.F1=BI_FP-dbits;
BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz";var BI_RC=new Array();var rr,vv;rr="0".charCodeAt(0);for(vv=0;vv<=9;++vv){BI_RC[rr++]=vv}rr="a".charCodeAt(0);for(vv=10;vv<36;++vv){BI_RC[rr++]=vv}rr="A".charCodeAt(0);for(vv=10;vv<36;++vv){BI_RC[rr++]=vv}function int2char(b){return BI_RM.charAt(b)}function intAt(c,e){var f=BI_RC[c.charCodeAt(e)];return(f==null)?-1:f}function bnpCopyTo(c){for(var d=this.t-1;d>=0;--d){c[d]=this[d]}c.t=this.t;c.s=this.s}function bnpFromInt(b){this.t=1;this.s=(b<0)?-1:0;if(b>0){this[0]=b}else{if(b<-1){this[0]=b+this.DV}else{this.t=0}}}function nbv(d){var c=nbi();c.fromInt(d);return c}function bnpFromString(i,r){var n;if(r==16){n=4}else{if(r==8){n=3}else{if(r==256){n=8}else{if(r==2){n=1}else{if(r==32){n=5}else{if(r==4){n=2}else{this.fromRadix(i,r);return}}}}}}this.t=0;this.s=0;var j=i.length,o=false,m=0;while(--j>=0){var b=(n==8)?i[j]&255:intAt(i,j);if(b<0){if(i.charAt(j)=="-"){o=true}continue}o=false;if(m==0){this[this.t++]=b}else{if(m+n>this.DB){this[this.t-1]|=(b&((1<<(this.DB-m))-1))<<m;this[this.t++]=(b>>(this.DB-m))}else{this[this.t-1]|=b<<m}}m+=n;if(m>=this.DB){m-=this.DB}}if(n==8&&(i[0]&128)!=0){this.s=-1;if(m>0){this[this.t-1]|=((1<<(this.DB-m))-1)<<m}}this.clamp();if(o){BigInteger.ZERO.subTo(this,this)}}function bnpClamp(){var b=this.s&this.DM;while(this.t>0&&this[this.t-1]==b){--this.t}}function bnToString(u){if(this.s<0){return"-"+this.negate().toString(u)}var r;if(u==16){r=4}else{if(u==8){r=3}else{if(u==2){r=1}else{if(u==32){r=5}else{if(u==4){r=2}else{return this.toRadix(u)}}}}}var n=(1<<r)-1,d,b=false,m="",o=this.t;var i=this.DB-(o*this.DB)%r;if(o-->0){if(i<this.DB&&(d=this[o]>>i)>0){b=true;m=int2char(d)}while(o>=0){if(i<r){d=(this[o]&((1<<i)-1))<<(r-i);d|=this[--o]>>(i+=this.DB-r)}else{d=(this[o]>>(i-=r))&n;if(i<=0){i+=this.DB;--o}}if(d>0){b=true}if(b){m+=int2char(d)}}}return b?m:"0"}function bnNegate(){var b=nbi();BigInteger.ZERO.subTo(this,b);return b}function bnAbs(){return(this.s<0)?this.negate():this}function bnCompareTo(e){var f=this.s-e.s;if(f!=0){return f}var h=this.t;f=h-e.t;if(f!=0){return(this.s<0)?-f:f}while(--h>=0){if((f=this[h]-e[h])!=0){return f}}return 0}function nbits(e){var f=1,d;if((d=e>>>16)!=0){e=d;f+=16}if((d=e>>8)!=0){e=d;f+=8}if((d=e>>4)!=0){e=d;f+=4}if((d=e>>2)!=0){e=d;f+=2}if((d=e>>1)!=0){e=d;f+=1}return f}function bnBitLength(){if(this.t<=0){return 0}return this.DB*(this.t-1)+nbits(this[this.t-1]^(this.s&this.DM))}function bnpDLShiftTo(f,d){var e;for(e=this.t-1;e>=0;--e){d[e+f]=this[e]}for(e=f-1;e>=0;--e){d[e]=0}d.t=this.t+f;d.s=this.s}function bnpDRShiftTo(f,d){for(var e=f;e<this.t;++e){d[e-f]=this[e]}d.t=Math.max(this.t-f,0);d.s=this.s}function bnpLShiftTo(m,u){var c=m%this.DB;var i=this.DB-c;var o=(1<<i)-1;var r=Math.floor(m/this.DB),n=(this.s<<c)&this.DM,v;for(v=this.t-1;v>=0;--v){u[v+r+1]=(this[v]>>i)|n;n=(this[v]&o)<<c}for(v=r-1;v>=0;--v){u[v]=0}u[r]=n;u.t=this.t+r+1;u.s=this.s;u.clamp()}function bnpRShiftTo(j,o){o.s=this.s;var n=Math.floor(j/this.DB);if(n>=this.t){o.t=0;return}var h=j%this.DB;var i=this.DB-h;var m=(1<<h)-1;o[0]=this[n]>>h;for(var r=n+1;r<this.t;++r){o[r-n-1]|=(this[r]&m)<<i;o[r-n]=this[r]>>h}if(h>0){o[this.t-n-1]|=(this.s&m)<<i}o.t=this.t-n;o.clamp()}function bnpSubTo(m,i){var j=0,h=0,c=Math.min(m.t,this.t);while(j<c){h+=this[j]-m[j];i[j++]=h&this.DM;h>>=this.DB}if(m.t<this.t){h-=m.s;while(j<this.t){h+=this[j];i[j++]=h&this.DM;h>>=this.DB}h+=this.s}else{h+=this.s;while(j<m.t){h-=m[j];i[j++]=h&this.DM;h>>=this.DB}h-=m.s}i.s=(h<0)?-1:0;if(h<-1){i[j++]=this.DV+h}else{if(h>0){i[j++]=h}}i.t=j;i.clamp()}function bnpMultiplyTo(n,j){var h=this.abs(),i=n.abs();var m=h.t;j.t=m+i.t;while(--m>=0){j[m]=0}for(m=0;m<i.t;++m){j[m+h.t]=h.am(0,i[m],j,m,0,h.t)}j.s=0;j.clamp();if(this.s!=n.s){BigInteger.ZERO.subTo(j,j)}}function bnpSquareTo(i){var f=this.abs();var c=i.t=2*f.t;while(--c>=0){i[c]=0}for(c=0;c<f.t-1;++c){var h=f.am(c,f[c],i,2*c,0,1);if((i[c+f.t]+=f.am(c+1,2*f[c],i,2*c+1,h,f.t-c-1))>=f.DV){i[c+f.t]-=f.DV;i[c+f.t+1]=1
}}if(i.t>0){i[i.t-1]+=f.am(c,f[c],i,2*c,0,1)}i.s=0;i.clamp()}function bnpDivRemTo(E,H,I){var j=E.abs();if(j.t<=0){return}var G=this.abs();if(G.t<j.t){if(H!=null){H.fromInt(0)}if(I!=null){this.copyTo(I)}return}if(I==null){I=nbi()}var K=nbi(),N=this.s,F=E.s;var m=this.DB-nbits(j[j.t-1]);if(m>0){j.lShiftTo(m,K);G.lShiftTo(m,I)}else{j.copyTo(K);G.copyTo(I)}var C=K.t;var M=K[C-1];if(M==0){return}var D=M*(1<<this.F1)+((C>1)?K[C-2]>>this.F2:0);var B=this.FV/D,e=(1<<this.F1)/D,i=1<<this.F2;var r=I.t,y=r-C,J=(H==null)?nbi():H;K.dlShiftTo(y,J);if(I.compareTo(J)>=0){I[I.t++]=1;I.subTo(J,I)}BigInteger.ONE.dlShiftTo(C,J);J.subTo(K,K);while(K.t<C){K[K.t++]=0}while(--y>=0){var L=(I[--r]==M)?this.DM:Math.floor(I[r]*B+(I[r-1]+i)*e);if((I[r]+=K.am(0,L,I,y,0,C))<L){K.dlShiftTo(y,J);I.subTo(J,I);while(I[r]<--L){I.subTo(J,I)}}}if(H!=null){I.drShiftTo(C,H);if(N!=F){BigInteger.ZERO.subTo(H,H)}}I.t=C;I.clamp();if(m>0){I.rShiftTo(m,I)}if(N<0){BigInteger.ZERO.subTo(I,I)}}function bnMod(d){var e=nbi();this.abs().divRemTo(d,null,e);if(this.s<0&&e.compareTo(BigInteger.ZERO)>0){d.subTo(e,e)}return e}function Classic(b){this.m=b}function cConvert(b){if(b.s<0||b.compareTo(this.m)>=0){return b.mod(this.m)}else{return b}}function cRevert(b){return b}function cReduce(b){b.divRemTo(this.m,null,b)}function cMulTo(e,f,d){e.multiplyTo(f,d);this.reduce(d)}function cSqrTo(d,c){d.squareTo(c);this.reduce(c)}Classic.prototype.convert=cConvert;Classic.prototype.revert=cRevert;Classic.prototype.reduce=cReduce;Classic.prototype.mulTo=cMulTo;Classic.prototype.sqrTo=cSqrTo;function bnpInvDigit(){if(this.t<1){return 0}var d=this[0];if((d&1)==0){return 0}var c=d&3;c=(c*(2-(d&15)*c))&15;c=(c*(2-(d&255)*c))&255;c=(c*(2-(((d&65535)*c)&65535)))&65535;c=(c*(2-d*c%this.DV))%this.DV;return(c>0)?this.DV-c:-c}function Montgomery(b){this.m=b;this.mp=b.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<(b.DB-15))-1;this.mt2=2*b.t}function montConvert(d){var c=nbi();d.abs().dlShiftTo(this.m.t,c);c.divRemTo(this.m,null,c);if(d.s<0&&c.compareTo(BigInteger.ZERO)>0){this.m.subTo(c,c)}return c}function montRevert(d){var c=nbi();d.copyTo(c);this.reduce(c);return c}function montReduce(f){while(f.t<=this.mt2){f[f.t++]=0}for(var i=0;i<this.m.t;++i){var e=f[i]&32767;var h=(e*this.mpl+(((e*this.mph+(f[i]>>15)*this.mpl)&this.um)<<15))&f.DM;e=i+this.m.t;f[e]+=this.m.am(0,h,f,i,0,this.m.t);while(f[e]>=f.DV){f[e]-=f.DV;f[++e]++}}f.clamp();f.drShiftTo(this.m.t,f);if(f.compareTo(this.m)>=0){f.subTo(this.m,f)}}function montSqrTo(d,c){d.squareTo(c);this.reduce(c)}function montMulTo(e,f,d){e.multiplyTo(f,d);this.reduce(d)}Montgomery.prototype.convert=montConvert;Montgomery.prototype.revert=montRevert;Montgomery.prototype.reduce=montReduce;Montgomery.prototype.mulTo=montMulTo;Montgomery.prototype.sqrTo=montSqrTo;function bnpIsEven(){return((this.t>0)?(this[0]&1):this.s)==0}function bnpExp(n,m){if(n>4294967295||n<1){return BigInteger.ONE}var o=nbi(),i=nbi(),r=m.convert(this),u=nbits(n)-1;r.copyTo(o);while(--u>=0){m.sqrTo(o,i);if((n&(1<<u))>0){m.mulTo(i,r,o)}else{var e=o;o=i;i=e}}return m.revert(o)}function bnModPowInt(d,e){var f;if(d<256||e.isEven()){f=new Classic(e)}else{f=new Montgomery(e)}return this.exp(d,f)}BigInteger.prototype.copyTo=bnpCopyTo;BigInteger.prototype.fromInt=bnpFromInt;BigInteger.prototype.fromString=bnpFromString;BigInteger.prototype.clamp=bnpClamp;BigInteger.prototype.dlShiftTo=bnpDLShiftTo;BigInteger.prototype.drShiftTo=bnpDRShiftTo;BigInteger.prototype.lShiftTo=bnpLShiftTo;BigInteger.prototype.rShiftTo=bnpRShiftTo;BigInteger.prototype.subTo=bnpSubTo;BigInteger.prototype.multiplyTo=bnpMultiplyTo;BigInteger.prototype.squareTo=bnpSquareTo;BigInteger.prototype.divRemTo=bnpDivRemTo;BigInteger.prototype.invDigit=bnpInvDigit;BigInteger.prototype.isEven=bnpIsEven;BigInteger.prototype.exp=bnpExp;BigInteger.prototype.toString=bnToString;BigInteger.prototype.negate=bnNegate;BigInteger.prototype.abs=bnAbs;BigInteger.prototype.compareTo=bnCompareTo;BigInteger.prototype.bitLength=bnBitLength;
BigInteger.prototype.mod=bnMod;BigInteger.prototype.modPowInt=bnModPowInt;BigInteger.ZERO=nbv(0);BigInteger.ONE=nbv(1);
;function bnClone(){var b=nbi();this.copyTo(b);return b}function bnIntValue(){if(this.s<0){if(this.t==1){return this[0]-this.DV}else{if(this.t==0){return -1}}}else{if(this.t==1){return this[0]}else{if(this.t==0){return 0}}}return((this[1]&((1<<(32-this.DB))-1))<<this.DB)|this[0]}function bnByteValue(){return(this.t==0)?this.s:(this[0]<<24)>>24}function bnShortValue(){return(this.t==0)?this.s:(this[0]<<16)>>16}function bnpChunkSize(b){return Math.floor(Math.LN2*this.DB/Math.log(b))}function bnSigNum(){if(this.s<0){return -1}else{if(this.t<=0||(this.t==1&&this[0]<=0)){return 0}else{return 1}}}function bnpToRadix(u){if(u==null){u=10}if(this.signum()==0||u<2||u>36){return"0"}var o=this.chunkSize(u);var r=Math.pow(u,o);var d=nbv(r),b=nbi(),m=nbi(),n="";this.divRemTo(d,b,m);while(b.signum()>0){n=(r+m.intValue()).toString(u).substr(1)+n;b.divRemTo(d,b,m)}return m.intValue().toString(u)+n}function bnpFromRadix(b,j){this.fromInt(0);if(j==null){j=10}var o=this.chunkSize(j);var n=Math.pow(j,o),r=false,v=0,d=0;for(var u=0;u<b.length;++u){var i=intAt(b,u);if(i<0){if(b.charAt(u)=="-"&&this.signum()==0){r=true}continue}d=j*d+i;if(++v>=o){this.dMultiply(n);this.dAddOffset(d,0);v=0;d=0}}if(v>0){this.dMultiply(Math.pow(j,v));this.dAddOffset(d,0)}if(r){BigInteger.ZERO.subTo(this,this)}}function bnpFromNumber(i,j,b){if("number"==typeof j){if(i<2){this.fromInt(1)}else{this.fromNumber(i,b);if(!this.testBit(i-1)){this.bitwiseTo(BigInteger.ONE.shiftLeft(i-1),op_or,this)}if(this.isEven()){this.dAddOffset(1,0)}while(!this.isProbablePrime(j)){this.dAddOffset(2,0);if(this.bitLength()>i){this.subTo(BigInteger.ONE.shiftLeft(i-1),this)}}}}else{var m=new Array(),c=i&7;m.length=(i>>3)+1;j.nextBytes(m);if(c>0){m[0]&=((1<<c)-1)}else{m[0]=0}this.fromString(m,256)}}function bnToByteArray(){var d=this.t,m=new Array();m[0]=this.s;var j=this.DB-(d*this.DB)%8,i,h=0;if(d-->0){if(j<this.DB&&(i=this[d]>>j)!=(this.s&this.DM)>>j){m[h++]=i|(this.s<<(this.DB-j))}while(d>=0){if(j<8){i=(this[d]&((1<<j)-1))<<(8-j);i|=this[--d]>>(j+=this.DB-8)}else{i=(this[d]>>(j-=8))&255;if(j<=0){j+=this.DB;--d}}if((i&128)!=0){i|=-256}if(h==0&&(this.s&128)!=(i&128)){++h}if(h>0||i!=this.s){m[h++]=i}}}return m}function bnEquals(c){return(this.compareTo(c)==0)}function bnMin(c){return(this.compareTo(c)<0)?this:c}function bnMax(c){return(this.compareTo(c)>0)?this:c}function bnpBitwiseTo(o,i,m){var n,j,f=Math.min(o.t,this.t);for(n=0;n<f;++n){m[n]=i(this[n],o[n])}if(o.t<this.t){j=o.s&this.DM;for(n=f;n<this.t;++n){m[n]=i(this[n],j)}m.t=this.t}else{j=this.s&this.DM;for(n=f;n<o.t;++n){m[n]=i(j,o[n])}m.t=o.t}m.s=i(this.s,o.s);m.clamp()}function op_and(d,c){return d&c}function bnAnd(d){var e=nbi();this.bitwiseTo(d,op_and,e);return e}function op_or(d,c){return d|c}function bnOr(d){var e=nbi();this.bitwiseTo(d,op_or,e);return e}function op_xor(d,c){return d^c}function bnXor(d){var e=nbi();this.bitwiseTo(d,op_xor,e);return e}function op_andnot(d,c){return d&~c}function bnAndNot(d){var e=nbi();this.bitwiseTo(d,op_andnot,e);return e}function bnNot(){var c=nbi();for(var d=0;d<this.t;++d){c[d]=this.DM&~this[d]}c.t=this.t;c.s=~this.s;return c}function bnShiftLeft(c){var d=nbi();if(c<0){this.rShiftTo(-c,d)}else{this.lShiftTo(c,d)}return d}function bnShiftRight(c){var d=nbi();if(c<0){this.lShiftTo(-c,d)}else{this.rShiftTo(c,d)}return d}function lbit(d){if(d==0){return -1}var c=0;if((d&65535)==0){d>>=16;c+=16}if((d&255)==0){d>>=8;c+=8}if((d&15)==0){d>>=4;c+=4}if((d&3)==0){d>>=2;c+=2}if((d&1)==0){++c}return c}function bnGetLowestSetBit(){for(var b=0;b<this.t;++b){if(this[b]!=0){return b*this.DB+lbit(this[b])}}if(this.s<0){return this.t*this.DB}return -1}function cbit(d){var c=0;while(d!=0){d&=d-1;++c}return c}function bnBitCount(){var f=0,e=this.s&this.DM;for(var d=0;d<this.t;++d){f+=cbit(this[d]^e)}return f}function bnTestBit(c){var d=Math.floor(c/this.DB);
if(d>=this.t){return(this.s!=0)}return((this[d]&(1<<(c%this.DB)))!=0)}function bnpChangeBit(f,d){var e=BigInteger.ONE.shiftLeft(f);this.bitwiseTo(e,d,e);return e}function bnSetBit(b){return this.changeBit(b,op_or)}function bnClearBit(b){return this.changeBit(b,op_andnot)}function bnFlipBit(b){return this.changeBit(b,op_xor)}function bnpAddTo(m,i){var j=0,h=0,c=Math.min(m.t,this.t);while(j<c){h+=this[j]+m[j];i[j++]=h&this.DM;h>>=this.DB}if(m.t<this.t){h+=m.s;while(j<this.t){h+=this[j];i[j++]=h&this.DM;h>>=this.DB}h+=this.s}else{h+=this.s;while(j<m.t){h+=m[j];i[j++]=h&this.DM;h>>=this.DB}h+=m.s}i.s=(h<0)?-1:0;if(h>0){i[j++]=h}else{if(h<-1){i[j++]=this.DV+h}}i.t=j;i.clamp()}function bnAdd(d){var e=nbi();this.addTo(d,e);return e}function bnSubtract(d){var e=nbi();this.subTo(d,e);return e}function bnMultiply(d){var e=nbi();this.multiplyTo(d,e);return e}function bnSquare(){var b=nbi();this.squareTo(b);return b}function bnDivide(d){var e=nbi();this.divRemTo(d,e,null);return e}function bnRemainder(d){var e=nbi();this.divRemTo(d,null,e);return e}function bnDivideAndRemainder(e){var f=nbi(),h=nbi();this.divRemTo(e,f,h);return new Array(f,h)}function bnpDMultiply(b){this[this.t]=this.am(0,b-1,this,0,0,this.t);++this.t;this.clamp()}function bnpDAddOffset(c,d){if(c==0){return}while(this.t<=d){this[this.t++]=0}this[d]+=c;while(this[d]>=this.DV){this[d]-=this.DV;if(++d>=this.t){this[this.t++]=0}++this[d]}}function NullExp(){}function nNop(b){return b}function nMulTo(e,f,d){e.multiplyTo(f,d)}function nSqrTo(d,c){d.squareTo(c)}NullExp.prototype.convert=nNop;NullExp.prototype.revert=nNop;NullExp.prototype.mulTo=nMulTo;NullExp.prototype.sqrTo=nSqrTo;function bnPow(b){return this.exp(b,new NullExp())}function bnpMultiplyLowerTo(h,i,j){var m=Math.min(this.t+h.t,i);j.s=0;j.t=m;while(m>0){j[--m]=0}var n;for(n=j.t-this.t;m<n;++m){j[m+this.t]=this.am(0,h[m],j,m,0,this.t)}for(n=Math.min(h.t,i);m<n;++m){this.am(0,h[m],j,m,0,i-m)}j.clamp()}function bnpMultiplyUpperTo(f,h,i){--h;var j=i.t=this.t+f.t-h;i.s=0;while(--j>=0){i[j]=0}for(j=Math.max(h-this.t,0);j<f.t;++j){i[this.t+j-h]=this.am(h-j,f[j],i,0,0,this.t+j-h)}i.clamp();i.drShiftTo(1,i)}function Barrett(b){this.r2=nbi();this.q3=nbi();BigInteger.ONE.dlShiftTo(2*b.t,this.r2);this.mu=this.r2.divide(b);this.m=b}function barrettConvert(d){if(d.s<0||d.t>2*this.m.t){return d.mod(this.m)}else{if(d.compareTo(this.m)<0){return d}else{var c=nbi();d.copyTo(c);this.reduce(c);return c}}}function barrettRevert(b){return b}function barrettReduce(b){b.drShiftTo(this.m.t-1,this.r2);if(b.t>this.m.t+1){b.t=this.m.t+1;b.clamp()}this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(b.compareTo(this.r2)<0){b.dAddOffset(1,this.m.t+1)}b.subTo(this.r2,b);while(b.compareTo(this.m)>=0){b.subTo(this.m,b)}}function barrettSqrTo(d,c){d.squareTo(c);this.reduce(c)}function barrettMulTo(e,f,d){e.multiplyTo(f,d);this.reduce(d)}Barrett.prototype.convert=barrettConvert;Barrett.prototype.revert=barrettRevert;Barrett.prototype.reduce=barrettReduce;Barrett.prototype.mulTo=barrettMulTo;Barrett.prototype.sqrTo=barrettSqrTo;function bnModPow(e,w){var m=e.bitLength(),r,E=nbv(1),H;if(m<=0){return E}else{if(m<18){r=1}else{if(m<48){r=3}else{if(m<144){r=4}else{if(m<768){r=5}else{r=6}}}}}if(m<8){H=new Classic(w)}else{if(w.isEven()){H=new Barrett(w)}else{H=new Montgomery(w)}}var i=new Array(),B=3,J=r-1,G=(1<<r)-1;i[1]=H.convert(this);if(r>1){var j=nbi();H.sqrTo(i[1],j);while(B<=G){i[B]=nbi();H.mulTo(j,i[B-2],i[B]);B+=2}}var n=e.t-1,F,I=true,C=nbi(),D;m=nbits(e[n])-1;while(n>=0){if(m>=J){F=(e[n]>>(m-J))&G}else{F=(e[n]&((1<<(m+1))-1))<<(J-m);if(n>0){F|=e[n-1]>>(this.DB+m-J)}}B=r;while((F&1)==0){F>>=1;--B}if((m-=B)<0){m+=this.DB;--n}if(I){i[F].copyTo(E);I=false}else{while(B>1){H.sqrTo(E,C);H.sqrTo(C,E);B-=2}if(B>0){H.sqrTo(E,C)}else{D=E;E=C;C=D}H.mulTo(C,i[F],E)}while(n>=0&&(e[n]&(1<<m))==0){H.sqrTo(E,C);D=E;E=C;C=D;if(--m<0){m=this.DB-1;--n}}}return H.revert(E)}function bnGCD(r){var i=(this.s<0)?this.negate():this.clone();
var j=(r.s<0)?r.negate():r.clone();if(i.compareTo(j)<0){var n=i;i=j;j=n}var o=i.getLowestSetBit(),m=j.getLowestSetBit();if(m<0){return i}if(o<m){m=o}if(m>0){i.rShiftTo(m,i);j.rShiftTo(m,j)}while(i.signum()>0){if((o=i.getLowestSetBit())>0){i.rShiftTo(o,i)}if((o=j.getLowestSetBit())>0){j.rShiftTo(o,j)}if(i.compareTo(j)>=0){i.subTo(j,i);i.rShiftTo(1,i)}else{j.subTo(i,j);j.rShiftTo(1,j)}}if(m>0){j.lShiftTo(m,j)}return j}function bnpModInt(h){if(h<=0){return 0}var i=this.DV%h,d=(this.s<0)?h-1:0;if(this.t>0){if(i==0){d=this[0]%h}else{for(var f=this.t-1;f>=0;--f){d=(i*d+this[f])%h}}}return d}function bnModInverse(r){var d=r.isEven();if((this.isEven()&&d)||r.signum()==0){return BigInteger.ZERO}var m=r.clone(),n=this.clone();var o=nbv(1),u=nbv(0),b=nbv(0),c=nbv(1);while(m.signum()!=0){while(m.isEven()){m.rShiftTo(1,m);if(d){if(!o.isEven()||!u.isEven()){o.addTo(this,o);u.subTo(r,u)}o.rShiftTo(1,o)}else{if(!u.isEven()){u.subTo(r,u)}}u.rShiftTo(1,u)}while(n.isEven()){n.rShiftTo(1,n);if(d){if(!b.isEven()||!c.isEven()){b.addTo(this,b);c.subTo(r,c)}b.rShiftTo(1,b)}else{if(!c.isEven()){c.subTo(r,c)}}c.rShiftTo(1,c)}if(m.compareTo(n)>=0){m.subTo(n,m);if(d){o.subTo(b,o)}u.subTo(c,u)}else{n.subTo(m,n);if(d){b.subTo(o,b)}c.subTo(u,c)}}if(n.compareTo(BigInteger.ONE)!=0){return BigInteger.ZERO}if(c.compareTo(r)>=0){return c.subtract(r)}if(c.signum()<0){c.addTo(r,c)}else{return c}if(c.signum()<0){return c.add(r)}else{return c}}var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997];var lplim=(1<<26)/lowprimes[lowprimes.length-1];function bnIsProbablePrime(i){var j,f=this.abs();if(f.t==1&&f[0]<=lowprimes[lowprimes.length-1]){for(j=0;j<lowprimes.length;++j){if(f[0]==lowprimes[j]){return true}}return false}if(f.isEven()){return false}j=1;while(j<lowprimes.length){var h=lowprimes[j],m=j+1;while(m<lowprimes.length&&h<lplim){h*=lowprimes[m++]}h=f.modInt(h);while(j<m){if(h%lowprimes[j++]==0){return false}}}return f.millerRabin(i)}function bnpMillerRabin(o){var n=this.subtract(BigInteger.ONE);var v=n.getLowestSetBit();if(v<=0){return false}var m=n.shiftRight(v);o=(o+1)>>1;if(o>lowprimes.length){o=lowprimes.length}var i=nbi();for(var r=0;r<o;++r){i.fromInt(lowprimes[Math.floor(Math.random()*lowprimes.length)]);var j=i.modPow(m,this);if(j.compareTo(BigInteger.ONE)!=0&&j.compareTo(n)!=0){var u=1;while(u++<v&&j.compareTo(n)!=0){j=j.modPowInt(2,this);if(j.compareTo(BigInteger.ONE)==0){return false}}if(j.compareTo(n)!=0){return false}}}return true}BigInteger.prototype.chunkSize=bnpChunkSize;BigInteger.prototype.toRadix=bnpToRadix;BigInteger.prototype.fromRadix=bnpFromRadix;BigInteger.prototype.fromNumber=bnpFromNumber;BigInteger.prototype.bitwiseTo=bnpBitwiseTo;BigInteger.prototype.changeBit=bnpChangeBit;BigInteger.prototype.addTo=bnpAddTo;BigInteger.prototype.dMultiply=bnpDMultiply;BigInteger.prototype.dAddOffset=bnpDAddOffset;BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo;BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo;BigInteger.prototype.modInt=bnpModInt;BigInteger.prototype.millerRabin=bnpMillerRabin;BigInteger.prototype.clone=bnClone;BigInteger.prototype.intValue=bnIntValue;BigInteger.prototype.byteValue=bnByteValue;BigInteger.prototype.shortValue=bnShortValue;BigInteger.prototype.signum=bnSigNum;BigInteger.prototype.toByteArray=bnToByteArray;BigInteger.prototype.equals=bnEquals;BigInteger.prototype.min=bnMin;BigInteger.prototype.max=bnMax;BigInteger.prototype.and=bnAnd;
BigInteger.prototype.or=bnOr;BigInteger.prototype.xor=bnXor;BigInteger.prototype.andNot=bnAndNot;BigInteger.prototype.not=bnNot;BigInteger.prototype.shiftLeft=bnShiftLeft;BigInteger.prototype.shiftRight=bnShiftRight;BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit;BigInteger.prototype.bitCount=bnBitCount;BigInteger.prototype.testBit=bnTestBit;BigInteger.prototype.setBit=bnSetBit;BigInteger.prototype.clearBit=bnClearBit;BigInteger.prototype.flipBit=bnFlipBit;BigInteger.prototype.add=bnAdd;BigInteger.prototype.subtract=bnSubtract;BigInteger.prototype.multiply=bnMultiply;BigInteger.prototype.divide=bnDivide;BigInteger.prototype.remainder=bnRemainder;BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder;BigInteger.prototype.modPow=bnModPow;BigInteger.prototype.modInverse=bnModInverse;BigInteger.prototype.pow=bnPow;BigInteger.prototype.gcd=bnGCD;BigInteger.prototype.isProbablePrime=bnIsProbablePrime;BigInteger.prototype.square=bnSquare;
;function Arcfour(){this.i=0;this.j=0;this.S=new Array()}function ARC4init(h){var i,f,e;for(i=0;i<256;++i){this.S[i]=i}f=0;for(i=0;i<256;++i){f=(f+this.S[i]+h[i%h.length])&255;e=this.S[i];this.S[i]=this.S[f];this.S[f]=e}this.i=0;this.j=0}function ARC4next(){var b;this.i=(this.i+1)&255;this.j=(this.j+this.S[this.i])&255;b=this.S[this.i];this.S[this.i]=this.S[this.j];this.S[this.j]=b;return this.S[(b+this.S[this.i])&255]}Arcfour.prototype.init=ARC4init;Arcfour.prototype.next=ARC4next;function prng_newstate(){return new Arcfour()}var rng_psize=256;
;var rng_state;var rng_pool;var rng_pptr;function rng_seed_int(b){rng_pool[rng_pptr++]^=b&255;rng_pool[rng_pptr++]^=(b>>8)&255;rng_pool[rng_pptr++]^=(b>>16)&255;rng_pool[rng_pptr++]^=(b>>24)&255;if(rng_pptr>=rng_psize){rng_pptr-=rng_psize}}function rng_seed_time(){rng_seed_int(new Date().getTime())}if(rng_pool==null){rng_pool=new Array();rng_pptr=0;var t;if(navigator.appName=="Netscape"&&navigator.appVersion<"5"&&window.crypto){var z=window.crypto.random(32);for(t=0;t<z.length;++t){rng_pool[rng_pptr++]=z.charCodeAt(t)&255}}while(rng_pptr<rng_psize){t=Math.floor(65536*Math.random());rng_pool[rng_pptr++]=t>>>8;rng_pool[rng_pptr++]=t&255}rng_pptr=0;rng_seed_time()}function rng_get_byte(){if(rng_state==null){rng_seed_time();rng_state=prng_newstate();rng_state.init(rng_pool);for(rng_pptr=0;rng_pptr<rng_pool.length;++rng_pptr){rng_pool[rng_pptr]=0}rng_pptr=0}return rng_state.next()}function rng_get_bytes(c){var d;for(d=0;d<c.length;++d){c[d]=rng_get_byte()}}function SecureRandom(){}SecureRandom.prototype.nextBytes=rng_get_bytes;
;function parseBigInt(c,d){return new BigInteger(c,d)}function linebrk(i,h){var f="";var e=0;while(e+h<i.length){f+=i.substring(e,e+h)+"\n";e+=h}return f+i.substring(e,i.length)}function byte2Hex(b){if(b<16){return"0"+b.toString(16)}else{return b.toString(16)}}function pkcs1pad2(o,j){if(j<o.length+11){alert("Message too long for RSA");return null}var m=new Array();var r=o.length-1;while(r>=0&&j>0){var n=o.charCodeAt(r--);if(n<128){m[--j]=n}else{if((n>127)&&(n<2048)){m[--j]=(n&63)|128;m[--j]=(n>>6)|192}else{m[--j]=(n&63)|128;m[--j]=((n>>6)&63)|128;m[--j]=(n>>12)|224}}}m[--j]=0;var c=new SecureRandom();var i=new Array();while(j>2){i[0]=0;while(i[0]==0){c.nextBytes(i)}m[--j]=i[0]}m[--j]=2;m[--j]=0;return new BigInteger(m)}function oaep_mgf1_arr(m,h,i){var f="",j=0;while(f.length<h){f+=i(String.fromCharCode.apply(String,m.concat([(j&4278190080)>>24,(j&16711680)>>16,(j&65280)>>8,j&255])));j+=1}return f}var SHA1_SIZE=20;function oaep_pad(i,B,y){if(i.length+2*SHA1_SIZE+2>B){throw"Message too long for RSA"}var o="",w;for(w=0;w<B-i.length-2*SHA1_SIZE-2;w+=1){o+="\x00"}var v=rstr_sha1("")+o+"\x01"+i;var u=new Array(SHA1_SIZE);new SecureRandom().nextBytes(u);var r=oaep_mgf1_arr(u,v.length,y||rstr_sha1);var m=[];for(w=0;w<v.length;w+=1){m[w]=v.charCodeAt(w)^r.charCodeAt(w)
}var n=oaep_mgf1_arr(m,u.length,rstr_sha1);var A=[0];for(w=0;w<u.length;w+=1){A[w+1]=u[w]^n.charCodeAt(w)}return new BigInteger(A.concat(m))}function RSAKey(){this.n=null;this.e=0;this.d=null;this.p=null;this.q=null;this.dmp1=null;this.dmq1=null;this.coeff=null}function RSASetPublic(c,d){this.isPublic=true;if(typeof c!=="string"){this.n=c;this.e=d}else{if(c!=null&&d!=null&&c.length>0&&d.length>0){this.n=parseBigInt(c,16);this.e=parseInt(d,16)}else{alert("Invalid RSA public key")}}}function RSADoPublic(b){return b.modPowInt(this.e,this.n)}function RSAEncrypt(i){var f=pkcs1pad2(i,(this.n.bitLength()+7)>>3);if(f==null){return null}var h=this.doPublic(f);if(h==null){return null}var c=h.toString(16);if((c.length&1)==0){return c}else{return"0"+c}}function RSAEncryptOAEP(j,m){var h=oaep_pad(j,(this.n.bitLength()+7)>>3,m);if(h==null){return null}var i=this.doPublic(h);if(i==null){return null}var c=i.toString(16);if((c.length&1)==0){return c}else{return"0"+c}}RSAKey.prototype.doPublic=RSADoPublic;RSAKey.prototype.setPublic=RSASetPublic;RSAKey.prototype.encrypt=RSAEncrypt;RSAKey.prototype.encryptOAEP=RSAEncryptOAEP;RSAKey.prototype.type="RSA";
;function pkcs1unpad2(i,c){var b=i.toByteArray();var m=0;while(m<b.length&&b[m]==0){++m}if(b.length-m!=c-1||b[m]!=2){return null}++m;while(b[m]!=0){if(++m>=b.length){return null}}var n="";while(++m<b.length){var d=b[m]&255;if(d<128){n+=String.fromCharCode(d)}else{if((d>191)&&(d<224)){n+=String.fromCharCode(((d&31)<<6)|(b[m+1]&63));++m}else{n+=String.fromCharCode(((d&15)<<12)|((b[m+1]&63)<<6)|(b[m+2]&63));m+=2}}}return n}function oaep_mgf1_str(m,h,i){var f="",j=0;while(f.length<h){f+=i(m+String.fromCharCode.apply(String,[(j&4278190080)>>24,(j&16711680)>>16,(j&65280)>>8,j&255]));j+=1}return f}var SHA1_SIZE=20;function oaep_unpad(n,C,A){n=n.toByteArray();var y;for(y=0;y<n.length;y+=1){n[y]&=255}while(n.length<C){n.unshift(0)}n=String.fromCharCode.apply(String,n);if(n.length<2*SHA1_SIZE+2){throw"Cipher too short"}var B=n.substr(1,SHA1_SIZE);var d=n.substr(SHA1_SIZE+1);var i=oaep_mgf1_str(d,SHA1_SIZE,A||rstr_sha1);var v=[],y;for(y=0;y<B.length;y+=1){v[y]=B.charCodeAt(y)^i.charCodeAt(y)}var u=oaep_mgf1_str(String.fromCharCode.apply(String,v),n.length-SHA1_SIZE,rstr_sha1);var w=[];for(y=0;y<d.length;y+=1){w[y]=d.charCodeAt(y)^u.charCodeAt(y)}w=String.fromCharCode.apply(String,w);if(w.substr(0,SHA1_SIZE)!==rstr_sha1("")){throw"Hash mismatch"}w=w.substr(SHA1_SIZE);var D=w.indexOf("\x01");var r=(D!=-1)?w.substr(0,D).lastIndexOf("\x00"):-1;if(r+1!=D){throw"Malformed data"}return w.substr(D+1)}function RSASetPrivate(f,e,d){this.isPrivate=true;if(typeof f!=="string"){this.n=f;this.e=e;this.d=d}else{if(f!=null&&e!=null&&f.length>0&&e.length>0){this.n=parseBigInt(f,16);this.e=parseInt(e,16);this.d=parseBigInt(d,16)}else{alert("Invalid RSA private key")}}}function RSASetPrivateEx(n,u,r,v,i,j,m,o){this.isPrivate=true;if(n==null){throw"RSASetPrivateEx N == null"}if(u==null){throw"RSASetPrivateEx E == null"}if(n.length==0){throw"RSASetPrivateEx N.length == 0"}if(u.length==0){throw"RSASetPrivateEx E.length == 0"}if(n!=null&&u!=null&&n.length>0&&u.length>0){this.n=parseBigInt(n,16);this.e=parseInt(u,16);this.d=parseBigInt(r,16);this.p=parseBigInt(v,16);this.q=parseBigInt(i,16);this.dmp1=parseBigInt(j,16);this.dmq1=parseBigInt(m,16);this.coeff=parseBigInt(o,16)}else{alert("Invalid RSA private key in RSASetPrivateEx")}}function RSAGenerate(w,j){var y=new SecureRandom();var o=w>>1;this.e=parseInt(j,16);var v=new BigInteger(j,16);for(;;){for(;;){this.p=new BigInteger(w-o,1,y);if(this.p.subtract(BigInteger.ONE).gcd(v).compareTo(BigInteger.ONE)==0&&this.p.isProbablePrime(10)){break}}for(;;){this.q=new BigInteger(o,1,y);if(this.q.subtract(BigInteger.ONE).gcd(v).compareTo(BigInteger.ONE)==0&&this.q.isProbablePrime(10)){break}}if(this.p.compareTo(this.q)<=0){var m=this.p;this.p=this.q;this.q=m}var n=this.p.subtract(BigInteger.ONE);var u=this.q.subtract(BigInteger.ONE);
var r=n.multiply(u);if(r.gcd(v).compareTo(BigInteger.ONE)==0){this.n=this.p.multiply(this.q);this.d=v.modInverse(r);this.dmp1=this.d.mod(n);this.dmq1=this.d.mod(u);this.coeff=this.q.modInverse(this.p);break}}}function RSADoPrivate(e){if(this.p==null||this.q==null){return e.modPow(this.d,this.n)}var f=e.mod(this.p).modPow(this.dmp1,this.p);var d=e.mod(this.q).modPow(this.dmq1,this.q);while(f.compareTo(d)<0){f=f.add(this.p)}return f.subtract(d).multiply(this.coeff).mod(this.p).multiply(this.q).add(d)}function RSADecrypt(c){var f=parseBigInt(c,16);var e=this.doPrivate(f);if(e==null){return null}return pkcs1unpad2(e,(this.n.bitLength()+7)>>3)}function RSADecryptOAEP(i,c){var h=parseBigInt(i,16);var f=this.doPrivate(h);if(f==null){return null}return oaep_unpad(f,(this.n.bitLength()+7)>>3,c)}RSAKey.prototype.doPrivate=RSADoPrivate;RSAKey.prototype.setPrivate=RSASetPrivate;RSAKey.prototype.setPrivateEx=RSASetPrivateEx;RSAKey.prototype.generate=RSAGenerate;RSAKey.prototype.decrypt=RSADecrypt;RSAKey.prototype.decryptOAEP=RSADecryptOAEP;
;function ECFieldElementFp(c,d){this.x=d;this.q=c}function feFpEquals(b){if(b==this){return true}return(this.q.equals(b.q)&&this.x.equals(b.x))}function feFpToBigInteger(){return this.x}function feFpNegate(){return new ECFieldElementFp(this.q,this.x.negate().mod(this.q))}function feFpAdd(b){return new ECFieldElementFp(this.q,this.x.add(b.toBigInteger()).mod(this.q))}function feFpSubtract(b){return new ECFieldElementFp(this.q,this.x.subtract(b.toBigInteger()).mod(this.q))}function feFpMultiply(b){return new ECFieldElementFp(this.q,this.x.multiply(b.toBigInteger()).mod(this.q))}function feFpSquare(){return new ECFieldElementFp(this.q,this.x.square().mod(this.q))}function feFpDivide(b){return new ECFieldElementFp(this.q,this.x.multiply(b.toBigInteger().modInverse(this.q)).mod(this.q))}ECFieldElementFp.prototype.equals=feFpEquals;ECFieldElementFp.prototype.toBigInteger=feFpToBigInteger;ECFieldElementFp.prototype.negate=feFpNegate;ECFieldElementFp.prototype.add=feFpAdd;ECFieldElementFp.prototype.subtract=feFpSubtract;ECFieldElementFp.prototype.multiply=feFpMultiply;ECFieldElementFp.prototype.square=feFpSquare;ECFieldElementFp.prototype.divide=feFpDivide;function ECPointFp(i,f,h,e){this.curve=i;this.x=f;this.y=h;if(e==null){this.z=BigInteger.ONE}else{this.z=e}this.zinv=null}function pointFpGetX(){if(this.zinv==null){this.zinv=this.z.modInverse(this.curve.q)}return this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function pointFpGetY(){if(this.zinv==null){this.zinv=this.z.modInverse(this.curve.q)}return this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function pointFpEquals(e){if(e==this){return true}if(this.isInfinity()){return e.isInfinity()}if(e.isInfinity()){return this.isInfinity()}var f,d;f=e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q);if(!f.equals(BigInteger.ZERO)){return false}d=e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q);return d.equals(BigInteger.ZERO)}function pointFpIsInfinity(){if((this.x==null)&&(this.y==null)){return true}return this.z.equals(BigInteger.ZERO)&&!this.y.toBigInteger().equals(BigInteger.ZERO)}function pointFpNegate(){return new ECPointFp(this.curve,this.x,this.y.negate(),this.z)}function pointFpAdd(w){if(this.isInfinity()){return w}if(w.isInfinity()){return this}var b=w.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(w.z)).mod(this.curve.q);var r=w.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(w.z)).mod(this.curve.q);if(BigInteger.ZERO.equals(r)){if(BigInteger.ZERO.equals(b)){return this.twice()}return this.curve.getInfinity()}var A=new BigInteger("3");var F=this.x.toBigInteger();var u=this.y.toBigInteger();var H=w.x.toBigInteger();var y=w.y.toBigInteger();var v=r.square();var B=v.multiply(r);
var G=F.multiply(v);var D=b.square().multiply(this.z);var I=D.subtract(G.shiftLeft(1)).multiply(w.z).subtract(B).multiply(r).mod(this.curve.q);var C=G.multiply(A).multiply(b).subtract(u.multiply(B)).subtract(D.multiply(b)).multiply(w.z).add(b.multiply(B)).mod(this.curve.q);var E=B.multiply(this.z).multiply(w.z).mod(this.curve.q);return new ECPointFp(this.curve,this.curve.fromBigInteger(I),this.curve.fromBigInteger(C),E)}function pointFpTwice(){if(this.isInfinity()){return this}if(this.y.toBigInteger().signum()==0){return this.curve.getInfinity()}var u=new BigInteger("3");var A=this.x.toBigInteger();var r=this.y.toBigInteger();var w=r.multiply(this.z);var n=w.multiply(r).mod(this.curve.q);var o=this.curve.a.toBigInteger();var m=A.square().multiply(u);if(!BigInteger.ZERO.equals(o)){m=m.add(this.z.square().multiply(o))}m=m.mod(this.curve.q);var B=m.square().subtract(A.shiftLeft(3).multiply(n)).shiftLeft(1).multiply(w).mod(this.curve.q);var v=m.multiply(u).multiply(A).subtract(n.shiftLeft(1)).shiftLeft(2).multiply(n).subtract(m.square().multiply(m)).mod(this.curve.q);var y=w.square().multiply(w).shiftLeft(3).mod(this.curve.q);return new ECPointFp(this.curve,this.curve.fromBigInteger(B),this.curve.fromBigInteger(v),y)}function pointFpMultiply(e){if(this.isInfinity()){return this}if(e.signum()==0){return this.curve.getInfinity()}var n=e;var o=n.multiply(new BigInteger("3"));var i=this.negate();var r=this;var u;for(u=o.bitLength()-2;u>0;--u){r=r.twice();var h=o.testBit(u);var m=n.testBit(u);if(h!=m){r=r.add(h?this:i)}}return r}function pointFpMultiplyTwo(o,i,h){var n;if(o.bitLength()>h.bitLength()){n=o.bitLength()-1}else{n=h.bitLength()-1}var j=this.curve.getInfinity();var m=this.add(i);while(n>=0){j=j.twice();if(o.testBit(n)){if(h.testBit(n)){j=j.add(m)}else{j=j.add(this)}}else{if(h.testBit(n)){j=j.add(i)}}--n}return j}ECPointFp.prototype.getX=pointFpGetX;ECPointFp.prototype.getY=pointFpGetY;ECPointFp.prototype.equals=pointFpEquals;ECPointFp.prototype.isInfinity=pointFpIsInfinity;ECPointFp.prototype.negate=pointFpNegate;ECPointFp.prototype.add=pointFpAdd;ECPointFp.prototype.twice=pointFpTwice;ECPointFp.prototype.multiply=pointFpMultiply;ECPointFp.prototype.multiplyTwo=pointFpMultiplyTwo;function ECCurveFp(b,f,h){this.q=b;this.a=this.fromBigInteger(f);this.b=this.fromBigInteger(h);this.infinity=new ECPointFp(this,null,null)}function curveFpGetQ(){return this.q}function curveFpGetA(){return this.a}function curveFpGetB(){return this.b}function curveFpEquals(b){if(b==this){return true}return(this.q.equals(b.q)&&this.a.equals(b.a)&&this.b.equals(b.b))}function curveFpGetInfinity(){return this.infinity}function curveFpFromBigInteger(b){return new ECFieldElementFp(this.q,b)}function curveFpDecodePointHex(h){switch(parseInt(h.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var f=(h.length-2)/2;var i=h.substr(2,f);var e=h.substr(f+2,f);return new ECPointFp(this,this.fromBigInteger(new BigInteger(i,16)),this.fromBigInteger(new BigInteger(e,16)));default:return null}}ECCurveFp.prototype.getQ=curveFpGetQ;ECCurveFp.prototype.getA=curveFpGetA;ECCurveFp.prototype.getB=curveFpGetB;ECCurveFp.prototype.equals=curveFpEquals;ECCurveFp.prototype.getInfinity=curveFpGetInfinity;ECCurveFp.prototype.fromBigInteger=curveFpFromBigInteger;ECCurveFp.prototype.decodePointHex=curveFpDecodePointHex;
;ECFieldElementFp.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)};ECPointFp.prototype.getEncoded=function(m){var j=function(b,d){var c=b.toByteArrayUnsigned();if(d<c.length){c=c.slice(c.length-d)}else{while(d>c.length){c.unshift(0)}}return c};var h=this.getX().toBigInteger();var i=this.getY().toBigInteger();var f=j(h,32);if(m){if(i.isEven()){f.unshift(2)}else{f.unshift(3)}}else{f.unshift(4);f=f.concat(j(i,32))}return f};ECPointFp.decodeFrom=function(n,v){var o=v[0];var r=v.length-1;var u=v.slice(1,1+r/2);var i=v.slice(1+r/2,1+r);
u.unshift(0);i.unshift(0);var j=new BigInteger(u);var m=new BigInteger(i);return new ECPointFp(n,n.fromBigInteger(j),n.fromBigInteger(m))};ECPointFp.decodeFromHex=function(n,v){var o=v.substr(0,2);var r=v.length-2;var u=v.substr(2,r/2);var i=v.substr(2+r/2,r/2);var j=new BigInteger(u,16);var m=new BigInteger(i,16);return new ECPointFp(n,n.fromBigInteger(j),n.fromBigInteger(m))};ECPointFp.prototype.add2D=function(n){if(this.isInfinity()){return n}if(n.isInfinity()){return this}if(this.x.equals(n.x)){if(this.y.equals(n.y)){return this.twice()}return this.curve.getInfinity()}var h=n.x.subtract(this.x);var j=n.y.subtract(this.y);var b=j.divide(h);var m=b.square().subtract(this.x).subtract(n.x);var i=b.multiply(this.x.subtract(m)).subtract(this.y);return new ECPointFp(this.curve,m,i)};ECPointFp.prototype.twice2D=function(){if(this.isInfinity()){return this}if(this.y.toBigInteger().signum()==0){return this.curve.getInfinity()}var f=this.curve.fromBigInteger(BigInteger.valueOf(2));var i=this.curve.fromBigInteger(BigInteger.valueOf(3));var h=this.x.square().multiply(i).add(this.curve.a).divide(this.y.multiply(f));var m=h.square().subtract(this.x.multiply(f));var j=h.multiply(this.x.subtract(m)).subtract(this.y);return new ECPointFp(this.curve,m,j)};ECPointFp.prototype.multiply2D=function(e){if(this.isInfinity()){return this}if(e.signum()==0){return this.curve.getInfinity()}var n=e;var o=n.multiply(new BigInteger("3"));var i=this.negate();var r=this;var u;for(u=o.bitLength()-2;u>0;--u){r=r.twice();var h=o.testBit(u);var m=n.testBit(u);if(h!=m){r=r.add2D(h?this:i)}}return r};ECPointFp.prototype.isOnCurve=function(){var r=this.getX().toBigInteger();var b=this.getY().toBigInteger();var n=this.curve.getA().toBigInteger();var u=this.curve.getB().toBigInteger();var j=this.curve.getQ();var o=b.multiply(b).mod(j);var m=r.multiply(r).multiply(r).add(n.multiply(r)).add(u).mod(j);return o.equals(m)};ECPointFp.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"};ECPointFp.prototype.validate=function(){var f=this.curve.getQ();if(this.isInfinity()){throw new Error("Point is at infinity.")}var e=this.getX().toBigInteger();var d=this.getY().toBigInteger();if(e.compareTo(BigInteger.ONE)<0||e.compareTo(f.subtract(BigInteger.ONE))>0){throw new Error("x coordinate out of bounds")}if(d.compareTo(BigInteger.ONE)<0||d.compareTo(f.subtract(BigInteger.ONE))>0){throw new Error("y coordinate out of bounds")}if(!this.isOnCurve()){throw new Error("Point is not on the curve.")}if(this.multiply(f).isInfinity()){throw new Error("Point is not a scalar multiple of G.")}return true};
;if(typeof KJUR=="undefined"||!KJUR){KJUR={}}if(typeof KJUR.asn1=="undefined"||!KJUR.asn1){KJUR.asn1={}}KJUR.asn1.ASN1Util=new function(){this.integerToByteHex=function(d){var c=d.toString(16);if((c.length%2)==1){c="0"+c}return c};this.bigIntToMinTwosComplementsHex=function(m){var o=m.toString(16);if(o.substr(0,1)!="-"){if(o.length%2==1){o="0"+o}else{if(!o.match(/^[0-7]/)){o="00"+o}}}else{var i=o.substr(1);var r=i.length;if(r%2==1){r+=1}else{if(!o.match(/^[0-7]/)){r+=2}}var n="";for(var u=0;u<r;u++){n+="f"}var v=new BigInteger(n,16);var h=v.xor(m).add(BigInteger.ONE);o=h.toString(16).replace(/^-/,"")}return o};this.getPEMStringFromHex=function(i,h){var o=KJUR.asn1;var j=CryptoJS.enc.Hex.parse(i);var n=CryptoJS.enc.Base64.stringify(j);var m=n.replace(/(.{64})/g,"$1\r\n");m=m.replace(/\r\n$/,"");return"-----BEGIN "+h+"-----\r\n"+m+"\r\n-----END "+h+"-----\r\n"};this.newObject=function(C){var v=KJUR.asn1;var o=Object.keys(C);if(o.length!=1){throw"key of param shall be only one."}var r=o[0];if(":bool:int:bitstr:octstr:null:oid:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+r+":")==-1){throw"undefined key: "+r}if(r=="bool"){return new v.DERBoolean(C[r])}if(r=="int"){return new v.DERInteger(C[r])}if(r=="bitstr"){return new v.DERBitString(C[r])
}if(r=="octstr"){return new v.DEROctetString(C[r])}if(r=="null"){return new v.DERNull(C[r])}if(r=="oid"){return new v.DERObjectIdentifier(C[r])}if(r=="utf8str"){return new v.DERUTF8String(C[r])}if(r=="numstr"){return new v.DERNumericString(C[r])}if(r=="prnstr"){return new v.DERPrintableString(C[r])}if(r=="telstr"){return new v.DERTeletexString(C[r])}if(r=="ia5str"){return new v.DERIA5String(C[r])}if(r=="utctime"){return new v.DERUTCTime(C[r])}if(r=="gentime"){return new v.DERGeneralizedTime(C[r])}if(r=="seq"){var i=C[r];var u=[];for(var y=0;y<i.length;y++){var n=v.ASN1Util.newObject(i[y]);u.push(n)}return new v.DERSequence({array:u})}if(r=="set"){var i=C[r];var u=[];for(var y=0;y<i.length;y++){var n=v.ASN1Util.newObject(i[y]);u.push(n)}return new v.DERSet({array:u})}if(r=="tag"){var B=C[r];if(Object.prototype.toString.call(B)==="[object Array]"&&B.length==3){var A=v.ASN1Util.newObject(B[2]);return new v.DERTaggedObject({tag:B[0],explicit:B[1],obj:A})}else{var w={};if(B.explicit!==undefined){w.explicit=B.explicit}if(B.tag!==undefined){w.tag=B.tag}if(B.obj===undefined){throw"obj shall be specified for 'tag'."}w.obj=v.ASN1Util.newObject(B.obj);return new v.DERTaggedObject(w)}}};this.jsonToASN1HEX=function(c){var d=this.newObject(c);return d.getEncodedHex()}};KJUR.asn1.ASN1Object=function(){var m=true;var f=null;var j="00";var i="00";var h="";this.getLengthHexFromValue=function(){if(typeof this.hV=="undefined"||this.hV==null){throw"this.hV is null or undefined."}if(this.hV.length%2==1){throw"value hex must be even length: n="+h.length+",v="+this.hV}var b=this.hV.length/2;var c=b.toString(16);if(c.length%2==1){c="0"+c}if(b<128){return c}else{var d=c.length/2;if(d>15){throw"ASN.1 length too long to represent by 8x: n = "+b.toString(16)}var e=128+d;return e.toString(16)+c}};this.getEncodedHex=function(){if(this.hTLV==null||this.isModified){this.hV=this.getFreshValueHex();this.hL=this.getLengthHexFromValue();this.hTLV=this.hT+this.hL+this.hV;this.isModified=false}return this.hTLV};this.getValueHex=function(){this.getEncodedHex();return this.hV};this.getFreshValueHex=function(){return""}};KJUR.asn1.DERAbstractString=function(f){KJUR.asn1.DERAbstractString.superclass.constructor.call(this);var d=null;var e=null;this.getString=function(){return this.s};this.setString=function(b){this.hTLV=null;this.isModified=true;this.s=b;this.hV=stohex(this.s)};this.setStringHex=function(b){this.hTLV=null;this.isModified=true;this.s=null;this.hV=b};this.getFreshValueHex=function(){return this.hV};if(typeof f!="undefined"){if(typeof f=="string"){this.setString(f)}else{if(typeof f.str!="undefined"){this.setString(f.str)}else{if(typeof f.hex!="undefined"){this.setStringHex(f.hex)}}}}};YAHOO.lang.extend(KJUR.asn1.DERAbstractString,KJUR.asn1.ASN1Object);KJUR.asn1.DERAbstractTime=function(f){KJUR.asn1.DERAbstractTime.superclass.constructor.call(this);var d=null;var e=null;this.localDateToUTC=function(b){utc=b.getTime()+(b.getTimezoneOffset()*60000);var c=new Date(utc);return c};this.formatDate=function(u,o){var B=this.zeroPadding;var r=this.localDateToUTC(u);var c=String(r.getFullYear());if(o=="utc"){c=c.substr(2,2)}var v=B(String(r.getMonth()+1),2);var b=B(String(r.getDate()),2);var A=B(String(r.getHours()),2);var y=B(String(r.getMinutes()),2);var w=B(String(r.getSeconds()),2);return c+v+b+A+y+w+"Z"};this.zeroPadding=function(b,c){if(b.length>=c){return b}return new Array(c-b.length+1).join("0")+b};this.getString=function(){return this.s};this.setString=function(b){this.hTLV=null;this.isModified=true;this.s=b;this.hV=stohex(b)};this.setByDateValue=function(m,b,r,u,o,n){var c=new Date(Date.UTC(m,b-1,r,u,o,n,0));this.setByDate(c)};this.getFreshValueHex=function(){return this.hV}};YAHOO.lang.extend(KJUR.asn1.DERAbstractTime,KJUR.asn1.ASN1Object);KJUR.asn1.DERAbstractStructured=function(c){KJUR.asn1.DERAbstractString.superclass.constructor.call(this);var d=null;this.setByASN1ObjectArray=function(b){this.hTLV=null;this.isModified=true;this.asn1Array=b};this.appendASN1Object=function(b){this.hTLV=null;
this.isModified=true;this.asn1Array.push(b)};this.asn1Array=new Array();if(typeof c!="undefined"){if(typeof c.array!="undefined"){this.asn1Array=c.array}}};YAHOO.lang.extend(KJUR.asn1.DERAbstractStructured,KJUR.asn1.ASN1Object);KJUR.asn1.DERBoolean=function(){KJUR.asn1.DERBoolean.superclass.constructor.call(this);this.hT="01";this.hTLV="0101ff"};YAHOO.lang.extend(KJUR.asn1.DERBoolean,KJUR.asn1.ASN1Object);KJUR.asn1.DERInteger=function(b){KJUR.asn1.DERInteger.superclass.constructor.call(this);this.hT="02";this.setByBigInteger=function(c){this.hTLV=null;this.isModified=true;this.hV=KJUR.asn1.ASN1Util.bigIntToMinTwosComplementsHex(c)};this.setByInteger=function(e){var d=new BigInteger(String(e),10);this.setByBigInteger(d)};this.setValueHex=function(c){this.hV=c};this.getFreshValueHex=function(){return this.hV};if(typeof b!="undefined"){if(typeof b.bigint!="undefined"){this.setByBigInteger(b.bigint)}else{if(typeof b["int"]!="undefined"){this.setByInteger(b["int"])}else{if(typeof b=="number"){this.setByInteger(b)}else{if(typeof b.hex!="undefined"){this.setValueHex(b.hex)}}}}}};YAHOO.lang.extend(KJUR.asn1.DERInteger,KJUR.asn1.ASN1Object);KJUR.asn1.DERBitString=function(b){KJUR.asn1.DERBitString.superclass.constructor.call(this);this.hT="03";this.setHexValueIncludingUnusedBits=function(c){this.hTLV=null;this.isModified=true;this.hV=c};this.setUnusedBitsAndHexValue=function(e,f){if(e<0||7<e){throw"unused bits shall be from 0 to 7: u = "+e}var h="0"+e;this.hTLV=null;this.isModified=true;this.hV=h+f};this.setByBinaryString=function(n){n=n.replace(/0+$/,"");var m=8-n.length%8;if(m==8){m=0}for(var i=0;i<=m;i++){n+="0"}var h="";for(var i=0;i<n.length-1;i+=8){var o=n.substr(i,8);var r=parseInt(o,2).toString(16);if(r.length==1){r="0"+r}h+=r}this.hTLV=null;this.isModified=true;this.hV="0"+m+h};this.setByBooleanArray=function(f){var h="";for(var e=0;e<f.length;e++){if(f[e]==true){h+="1"}else{h+="0"}}this.setByBinaryString(h)};this.newFalseArray=function(f){var e=new Array(f);for(var h=0;h<f;h++){e[h]=false}return e};this.getFreshValueHex=function(){return this.hV};if(typeof b!="undefined"){if(typeof b=="string"&&b.toLowerCase().match(/^[0-9a-f]+$/)){this.setHexValueIncludingUnusedBits(b)}else{if(typeof b.hex!="undefined"){this.setHexValueIncludingUnusedBits(b.hex)}else{if(typeof b.bin!="undefined"){this.setByBinaryString(b.bin)}else{if(typeof b.array!="undefined"){this.setByBooleanArray(b.array)}}}}}};YAHOO.lang.extend(KJUR.asn1.DERBitString,KJUR.asn1.ASN1Object);KJUR.asn1.DEROctetString=function(b){KJUR.asn1.DEROctetString.superclass.constructor.call(this,b);this.hT="04"};YAHOO.lang.extend(KJUR.asn1.DEROctetString,KJUR.asn1.DERAbstractString);KJUR.asn1.DERNull=function(){KJUR.asn1.DERNull.superclass.constructor.call(this);this.hT="05";this.hTLV="0500"};YAHOO.lang.extend(KJUR.asn1.DERNull,KJUR.asn1.ASN1Object);KJUR.asn1.DERObjectIdentifier=function(f){var d=function(c){var b=c.toString(16);if(b.length==1){b="0"+b}return b};var e=function(h){var i="";var r=new BigInteger(h,10);var u=r.toString(2);var o=7-u.length%7;if(o==7){o=0}var b="";for(var n=0;n<o;n++){b+="0"}u=b+u;for(var n=0;n<u.length-1;n+=7){var c=u.substr(n,7);if(n!=u.length-7){c="1"+c}i+=d(parseInt(c,2))}return i};KJUR.asn1.DERObjectIdentifier.superclass.constructor.call(this);this.hT="06";this.setValueHex=function(b){this.hTLV=null;this.isModified=true;this.s=null;this.hV=b};this.setValueOidString=function(h){if(!h.match(/^[0-9.]+$/)){throw"malformed oid string: "+h}var c="";var m=h.split(".");var b=parseInt(m[0])*40+parseInt(m[1]);c+=d(b);m.splice(0,2);for(var i=0;i<m.length;i++){c+=e(m[i])}this.hTLV=null;this.isModified=true;this.s=null;this.hV=c};this.setValueName=function(b){if(typeof KJUR.asn1.x509.OID.name2oidList[b]!="undefined"){var c=KJUR.asn1.x509.OID.name2oidList[b];this.setValueOidString(c)}else{throw"DERObjectIdentifier oidName undefined: "+b}};this.getFreshValueHex=function(){return this.hV};if(typeof f!="undefined"){if(typeof f=="string"&&f.match(/^[0-2].[0-9.]+$/)){this.setValueOidString(f)
}else{if(KJUR.asn1.x509.OID.name2oidList[f]!==undefined){this.setValueOidString(KJUR.asn1.x509.OID.name2oidList[f])}else{if(typeof f.oid!="undefined"){this.setValueOidString(f.oid)}else{if(typeof f.hex!="undefined"){this.setValueHex(f.hex)}else{if(typeof f.name!="undefined"){this.setValueName(f.name)}}}}}}};YAHOO.lang.extend(KJUR.asn1.DERObjectIdentifier,KJUR.asn1.ASN1Object);KJUR.asn1.DERUTF8String=function(b){KJUR.asn1.DERUTF8String.superclass.constructor.call(this,b);this.hT="0c"};YAHOO.lang.extend(KJUR.asn1.DERUTF8String,KJUR.asn1.DERAbstractString);KJUR.asn1.DERNumericString=function(b){KJUR.asn1.DERNumericString.superclass.constructor.call(this,b);this.hT="12"};YAHOO.lang.extend(KJUR.asn1.DERNumericString,KJUR.asn1.DERAbstractString);KJUR.asn1.DERPrintableString=function(b){KJUR.asn1.DERPrintableString.superclass.constructor.call(this,b);this.hT="13"};YAHOO.lang.extend(KJUR.asn1.DERPrintableString,KJUR.asn1.DERAbstractString);KJUR.asn1.DERTeletexString=function(b){KJUR.asn1.DERTeletexString.superclass.constructor.call(this,b);this.hT="14"};YAHOO.lang.extend(KJUR.asn1.DERTeletexString,KJUR.asn1.DERAbstractString);KJUR.asn1.DERIA5String=function(b){KJUR.asn1.DERIA5String.superclass.constructor.call(this,b);this.hT="16"};YAHOO.lang.extend(KJUR.asn1.DERIA5String,KJUR.asn1.DERAbstractString);KJUR.asn1.DERUTCTime=function(b){KJUR.asn1.DERUTCTime.superclass.constructor.call(this,b);this.hT="17";this.setByDate=function(c){this.hTLV=null;this.isModified=true;this.date=c;this.s=this.formatDate(this.date,"utc");this.hV=stohex(this.s)};if(typeof b!="undefined"){if(typeof b.str!="undefined"){this.setString(b.str)}else{if(typeof b=="string"&&b.match(/^[0-9]{12}Z$/)){this.setString(b)}else{if(typeof b.hex!="undefined"){this.setStringHex(b.hex)}else{if(typeof b.date!="undefined"){this.setByDate(b.date)}}}}}};YAHOO.lang.extend(KJUR.asn1.DERUTCTime,KJUR.asn1.DERAbstractTime);KJUR.asn1.DERGeneralizedTime=function(b){KJUR.asn1.DERGeneralizedTime.superclass.constructor.call(this,b);this.hT="18";this.setByDate=function(c){this.hTLV=null;this.isModified=true;this.date=c;this.s=this.formatDate(this.date,"gen");this.hV=stohex(this.s)};if(typeof b!="undefined"){if(typeof b.str!="undefined"){this.setString(b.str)}else{if(typeof b=="string"&&b.match(/^[0-9]{14}Z$/)){this.setString(b)}else{if(typeof b.hex!="undefined"){this.setStringHex(b.hex)}else{if(typeof b.date!="undefined"){this.setByDate(b.date)}}}}}};YAHOO.lang.extend(KJUR.asn1.DERGeneralizedTime,KJUR.asn1.DERAbstractTime);KJUR.asn1.DERSequence=function(b){KJUR.asn1.DERSequence.superclass.constructor.call(this,b);this.hT="30";this.getFreshValueHex=function(){var h="";for(var e=0;e<this.asn1Array.length;e++){var f=this.asn1Array[e];h+=f.getEncodedHex()}this.hV=h;return this.hV}};YAHOO.lang.extend(KJUR.asn1.DERSequence,KJUR.asn1.DERAbstractStructured);KJUR.asn1.DERSet=function(b){KJUR.asn1.DERSet.superclass.constructor.call(this,b);this.hT="31";this.getFreshValueHex=function(){var e=new Array();for(var h=0;h<this.asn1Array.length;h++){var f=this.asn1Array[h];e.push(f.getEncodedHex())}e.sort();this.hV=e.join("");return this.hV}};YAHOO.lang.extend(KJUR.asn1.DERSet,KJUR.asn1.DERAbstractStructured);KJUR.asn1.DERTaggedObject=function(b){KJUR.asn1.DERTaggedObject.superclass.constructor.call(this);this.hT="a0";this.hV="";this.isExplicit=true;this.asn1Object=null;this.setASN1Object=function(e,h,f){this.hT=h;this.isExplicit=e;this.asn1Object=f;if(this.isExplicit){this.hV=this.asn1Object.getEncodedHex();this.hTLV=null;this.isModified=true}else{this.hV=null;this.hTLV=f.getEncodedHex();this.hTLV=this.hTLV.replace(/^../,h);this.isModified=false}};this.getFreshValueHex=function(){return this.hV};if(typeof b!="undefined"){if(typeof b.tag!="undefined"){this.hT=b.tag}if(typeof b.explicit!="undefined"){this.isExplicit=b.explicit}if(typeof b.obj!="undefined"){this.asn1Object=b.obj;this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)}}};YAHOO.lang.extend(KJUR.asn1.DERTaggedObject,KJUR.asn1.ASN1Object);
;
var ASN1HEX=new function(){this.getByteLengthOfL_AtObj=function(d,f){if(d.substring(f+2,f+3)!="8"){return 1}var e=parseInt(d.substring(f+3,f+4));if(e==0){return -1}if(0<e&&e<10){return e+1}return -2};this.getHexOfL_AtObj=function(d,f){var e=this.getByteLengthOfL_AtObj(d,f);if(e<1){return""}return d.substring(f+2,f+2+e*2)};this.getIntOfL_AtObj=function(i,h){var e=this.getHexOfL_AtObj(i,h);if(e==""){return -1}var f;if(parseInt(e.substring(0,1))<8){f=new BigInteger(e,16)}else{f=new BigInteger(e.substring(2),16)}return f.intValue()};this.getStartPosOfV_AtObj=function(d,f){var e=this.getByteLengthOfL_AtObj(d,f);if(e<0){return e}return f+(e+1)*2};this.getHexOfV_AtObj=function(i,h){var e=this.getStartPosOfV_AtObj(i,h);var f=this.getIntOfL_AtObj(i,h);return i.substring(e,e+f*2)};this.getHexOfTLV_AtObj=function(m,i){var f=m.substr(i,2);var j=this.getHexOfL_AtObj(m,i);var h=this.getHexOfV_AtObj(m,i);return f+j+h};this.getPosOfNextSibling_AtObj=function(i,h){var e=this.getStartPosOfV_AtObj(i,h);var f=this.getIntOfL_AtObj(i,h);return e+f*2};this.getPosArrayOfChildren_AtObj=function(r,m){var w=new Array();var n=this.getStartPosOfV_AtObj(r,m);w.push(n);var h=this.getIntOfL_AtObj(r,m);var o=n;var v=0;while(1){var u=this.getPosOfNextSibling_AtObj(r,o);if(u==null||(u-n>=(h*2))){break}if(v>=200){break}w.push(u);o=u;v++}return w};this.getNthChildIndex_AtObj=function(i,f,h){var j=this.getPosArrayOfChildren_AtObj(i,f);return j[h]};this.getDecendantIndexByNthList=function(j,m,n){if(n.length==0){return m}var i=n.shift();var h=this.getPosArrayOfChildren_AtObj(j,m);return this.getDecendantIndexByNthList(j,h[i],n)};this.getDecendantHexTLVByNthList=function(h,i,e){var f=this.getDecendantIndexByNthList(h,i,e);return this.getHexOfTLV_AtObj(h,f)};this.getDecendantHexVByNthList=function(h,i,e){var f=this.getDecendantIndexByNthList(h,i,e);return this.getHexOfV_AtObj(h,f)}};ASN1HEX.getVbyList=function(j,m,f,i){var h=this.getDecendantIndexByNthList(j,m,f);if(h===undefined){throw"can't find nthList object"}if(i!==undefined){if(j.substr(h,2)!=i){throw"checking tag doesn't match: "+j.substr(h,2)+"!="+i}}return this.getHexOfV_AtObj(j,h)};
;if(typeof KJUR=="undefined"||!KJUR){KJUR={}}if(typeof KJUR.asn1=="undefined"||!KJUR.asn1){KJUR.asn1={}}if(typeof KJUR.asn1.x509=="undefined"||!KJUR.asn1.x509){KJUR.asn1.x509={}}KJUR.asn1.x509.Certificate=function(j){KJUR.asn1.x509.Certificate.superclass.constructor.call(this);var h=null;var o=null;var m=null;var r=null;var i=null;var n=null;this.setRsaPrvKeyByPEMandPass=function(d,b){var e=PKCS5PKEY.getDecryptedKeyHex(d,b);var c=new RSAKey();c.readPrivateKeyFromASN1HexString(e);this.prvKey=c};this.sign=function(){this.asn1SignatureAlg=this.asn1TBSCert.asn1SignatureAlg;sig=new KJUR.crypto.Signature({alg:"SHA1withRSA"});sig.init(this.prvKey);sig.updateHex(this.asn1TBSCert.getEncodedHex());this.hexSig=sig.sign();this.asn1Sig=new KJUR.asn1.DERBitString({hex:"00"+this.hexSig});var b=new KJUR.asn1.DERSequence({array:[this.asn1TBSCert,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=b.getEncodedHex();this.isModified=false};this.setSignatureHex=function(c){this.asn1SignatureAlg=this.asn1TBSCert.asn1SignatureAlg;this.hexSig=c;this.asn1Sig=new KJUR.asn1.DERBitString({hex:"00"+this.hexSig});var b=new KJUR.asn1.DERSequence({array:[this.asn1TBSCert,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=b.getEncodedHex();this.isModified=false};this.getEncodedHex=function(){if(this.isModified==false&&this.hTLV!=null){return this.hTLV}throw"not signed yet"};this.getPEMString=function(){var c=this.getEncodedHex();var e=CryptoJS.enc.Hex.parse(c);var d=CryptoJS.enc.Base64.stringify(e);var b=d.replace(/(.{64})/g,"$1\r\n");return"-----BEGIN CERTIFICATE-----\r\n"+b+"\r\n-----END CERTIFICATE-----\r\n"};if(typeof j!="undefined"){if(typeof j.tbscertobj!="undefined"){this.asn1TBSCert=j.tbscertobj}if(typeof j.prvkeyobj!="undefined"){this.prvKey=j.prvkeyobj}else{if(typeof j.rsaprvkey!="undefined"){this.prvKey=j.rsaprvkey
}else{if((typeof j.rsaprvpem!="undefined")&&(typeof j.rsaprvpas!="undefined")){this.setRsaPrvKeyByPEMandPass(j.rsaprvpem,j.rsaprvpas)}}}}};YAHOO.lang.extend(KJUR.asn1.x509.Certificate,KJUR.asn1.ASN1Object);KJUR.asn1.x509.TBSCertificate=function(b){KJUR.asn1.x509.TBSCertificate.superclass.constructor.call(this);this._initialize=function(){this.asn1Array=new Array();this.asn1Version=new KJUR.asn1.DERTaggedObject({obj:new KJUR.asn1.DERInteger({"int":2})});this.asn1SerialNumber=null;this.asn1SignatureAlg=null;this.asn1Issuer=null;this.asn1NotBefore=null;this.asn1NotAfter=null;this.asn1Subject=null;this.asn1SubjPKey=null;this.extensionsArray=new Array()};this.setSerialNumberByParam=function(c){this.asn1SerialNumber=new KJUR.asn1.DERInteger(c)};this.setSignatureAlgByParam=function(c){this.asn1SignatureAlg=new KJUR.asn1.x509.AlgorithmIdentifier(c)};this.setIssuerByParam=function(c){this.asn1Issuer=new KJUR.asn1.x509.X500Name(c)};this.setNotBeforeByParam=function(c){this.asn1NotBefore=new KJUR.asn1.x509.Time(c)};this.setNotAfterByParam=function(c){this.asn1NotAfter=new KJUR.asn1.x509.Time(c)};this.setSubjectByParam=function(c){this.asn1Subject=new KJUR.asn1.x509.X500Name(c)};this.setSubjectPublicKeyByParam=function(c){this.asn1SubjPKey=new KJUR.asn1.x509.SubjectPublicKeyInfo(c)};this.setSubjectPublicKeyByGetKey=function(e){var d=KEYUTIL.getKey(e);this.asn1SubjPKey=new KJUR.asn1.x509.SubjectPublicKeyInfo(d)};this.appendExtension=function(c){this.extensionsArray.push(c)};this.appendExtensionByName=function(f,e){if(f.toLowerCase()=="basicconstraints"){var h=new KJUR.asn1.x509.BasicConstraints(e);this.appendExtension(h)}else{if(f.toLowerCase()=="keyusage"){var h=new KJUR.asn1.x509.KeyUsage(e);this.appendExtension(h)}else{if(f.toLowerCase()=="crldistributionpoints"){var h=new KJUR.asn1.x509.CRLDistributionPoints(e);this.appendExtension(h)}else{if(f.toLowerCase()=="extkeyusage"){var h=new KJUR.asn1.x509.ExtKeyUsage(e);this.appendExtension(h)}else{if(f.toLowerCase()=="authoritykeyidentifier"){var h=new KJUR.asn1.x509.AuthorityKeyIdentifier(e);this.appendExtension(h)}else{throw"unsupported extension name: "+f}}}}}};this.getEncodedHex=function(){if(this.asn1NotBefore==null||this.asn1NotAfter==null){throw"notBefore and/or notAfter not set"}var j=new KJUR.asn1.DERSequence({array:[this.asn1NotBefore,this.asn1NotAfter]});this.asn1Array=new Array();this.asn1Array.push(this.asn1Version);this.asn1Array.push(this.asn1SerialNumber);this.asn1Array.push(this.asn1SignatureAlg);this.asn1Array.push(this.asn1Issuer);this.asn1Array.push(j);this.asn1Array.push(this.asn1Subject);this.asn1Array.push(this.asn1SubjPKey);if(this.extensionsArray.length>0){var i=new KJUR.asn1.DERSequence({array:this.extensionsArray});var f=new KJUR.asn1.DERTaggedObject({explicit:true,tag:"a3",obj:i});this.asn1Array.push(f)}var h=new KJUR.asn1.DERSequence({array:this.asn1Array});this.hTLV=h.getEncodedHex();this.isModified=false;return this.hTLV};this._initialize()};YAHOO.lang.extend(KJUR.asn1.x509.TBSCertificate,KJUR.asn1.ASN1Object);KJUR.asn1.x509.Extension=function(c){KJUR.asn1.x509.Extension.superclass.constructor.call(this);var d=null;this.getEncodedHex=function(){var b=new KJUR.asn1.DERObjectIdentifier({oid:this.oid});var h=new KJUR.asn1.DEROctetString({hex:this.getExtnValueHex()});var i=new Array();i.push(b);if(this.critical){i.push(new KJUR.asn1.DERBoolean())}i.push(h);var j=new KJUR.asn1.DERSequence({array:i});return j.getEncodedHex()};this.critical=false;if(typeof c!="undefined"){if(typeof c.critical!="undefined"){this.critical=c.critical}}};YAHOO.lang.extend(KJUR.asn1.x509.Extension,KJUR.asn1.ASN1Object);KJUR.asn1.x509.KeyUsage=function(b){KJUR.asn1.x509.KeyUsage.superclass.constructor.call(this,b);this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()};this.oid="2.5.29.15";if(typeof b!="undefined"){if(typeof b.bin!="undefined"){this.asn1ExtnValue=new KJUR.asn1.DERBitString(b)}}};YAHOO.lang.extend(KJUR.asn1.x509.KeyUsage,KJUR.asn1.x509.Extension);KJUR.asn1.x509.BasicConstraints=function(f){KJUR.asn1.x509.BasicConstraints.superclass.constructor.call(this,f);
var e=false;var d=-1;this.getExtnValueHex=function(){var b=new Array();if(this.cA){b.push(new KJUR.asn1.DERBoolean())}if(this.pathLen>-1){b.push(new KJUR.asn1.DERInteger({"int":this.pathLen}))}var c=new KJUR.asn1.DERSequence({array:b});this.asn1ExtnValue=c;return this.asn1ExtnValue.getEncodedHex()};this.oid="2.5.29.19";this.cA=false;this.pathLen=-1;if(typeof f!="undefined"){if(typeof f.cA!="undefined"){this.cA=f.cA}if(typeof f.pathLen!="undefined"){this.pathLen=f.pathLen}}};YAHOO.lang.extend(KJUR.asn1.x509.BasicConstraints,KJUR.asn1.x509.Extension);KJUR.asn1.x509.CRLDistributionPoints=function(b){KJUR.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,b);this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()};this.setByDPArray=function(c){this.asn1ExtnValue=new KJUR.asn1.DERSequence({array:c})};this.setByOneURI=function(h){var f=new KJUR.asn1.x509.GeneralNames([{uri:h}]);var i=new KJUR.asn1.x509.DistributionPointName(f);var j=new KJUR.asn1.x509.DistributionPoint({dpobj:i});this.setByDPArray([j])};this.oid="2.5.29.31";if(typeof b!="undefined"){if(typeof b.array!="undefined"){this.setByDPArray(b.array)}else{if(typeof b.uri!="undefined"){this.setByOneURI(b.uri)}}}};YAHOO.lang.extend(KJUR.asn1.x509.CRLDistributionPoints,KJUR.asn1.x509.Extension);KJUR.asn1.x509.ExtKeyUsage=function(b){KJUR.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,b);this.setPurposeArray=function(e){this.asn1ExtnValue=new KJUR.asn1.DERSequence();for(var h=0;h<e.length;h++){var f=new KJUR.asn1.DERObjectIdentifier(e[h]);this.asn1ExtnValue.appendASN1Object(f)}};this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()};this.oid="2.5.29.37";if(typeof b!="undefined"){if(typeof b.array!="undefined"){this.setPurposeArray(b.array)}}};YAHOO.lang.extend(KJUR.asn1.x509.ExtKeyUsage,KJUR.asn1.x509.Extension);KJUR.asn1.x509.AuthorityKeyIdentifier=function(b){KJUR.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,b);this.asn1KID=null;this.asn1CertIssuer=null;this.asn1CertSN=null;this.getExtnValueHex=function(){var e=new Array();if(this.asn1KID){e.push(new KJUR.asn1.DERTaggedObject({explicit:false,tag:"80",obj:this.asn1KID}))}if(this.asn1CertIssuer){e.push(new KJUR.asn1.DERTaggedObject({explicit:false,tag:"a1",obj:this.asn1CertIssuer}))}if(this.asn1CertSN){e.push(new KJUR.asn1.DERTaggedObject({explicit:false,tag:"82",obj:this.asn1CertSN}))}var d=new KJUR.asn1.DERSequence({array:e});this.asn1ExtnValue=d;return this.asn1ExtnValue.getEncodedHex()};this.setKIDByParam=function(c){this.asn1KID=new KJUR.asn1.DEROctetString(c)};this.setCertIssuerByParam=function(c){this.asn1CertIssuer=new KJUR.asn1.x509.X500Name(c)};this.setCertSNByParam=function(c){this.asn1CertSN=new KJUR.asn1.DERInteger(c)};this.oid="2.5.29.35";if(typeof b!="undefined"){if(typeof b.kid!="undefined"){this.setKIDByParam(b.kid)}if(typeof b.issuer!="undefined"){this.setCertIssuerByParam(b.issuer)}if(typeof b.sn!="undefined"){this.setCertSNByParam(b.sn)}}};YAHOO.lang.extend(KJUR.asn1.x509.AuthorityKeyIdentifier,KJUR.asn1.x509.Extension);KJUR.asn1.x509.CRL=function(j){KJUR.asn1.x509.CRL.superclass.constructor.call(this);var i=null;var o=null;var m=null;var h=null;var n=null;this.setRsaPrvKeyByPEMandPass=function(d,b){var e=PKCS5PKEY.getDecryptedKeyHex(d,b);var c=new RSAKey();c.readPrivateKeyFromASN1HexString(e);this.rsaPrvKey=c};this.sign=function(){this.asn1SignatureAlg=this.asn1TBSCertList.asn1SignatureAlg;sig=new KJUR.crypto.Signature({alg:"SHA1withRSA",prov:"cryptojs/jsrsa"});sig.initSign(this.rsaPrvKey);sig.updateHex(this.asn1TBSCertList.getEncodedHex());this.hexSig=sig.sign();this.asn1Sig=new KJUR.asn1.DERBitString({hex:"00"+this.hexSig});var b=new KJUR.asn1.DERSequence({array:[this.asn1TBSCertList,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=b.getEncodedHex();this.isModified=false};this.getEncodedHex=function(){if(this.isModified==false&&this.hTLV!=null){return this.hTLV}throw"not signed yet"};this.getPEMString=function(){var c=this.getEncodedHex();
var e=CryptoJS.enc.Hex.parse(c);var d=CryptoJS.enc.Base64.stringify(e);var b=d.replace(/(.{64})/g,"$1\r\n");return"-----BEGIN X509 CRL-----\r\n"+b+"\r\n-----END X509 CRL-----\r\n"};if(typeof j!="undefined"){if(typeof j.tbsobj!="undefined"){this.asn1TBSCertList=j.tbsobj}if(typeof j.rsaprvkey!="undefined"){this.rsaPrvKey=j.rsaprvkey}if((typeof j.rsaprvpem!="undefined")&&(typeof j.rsaprvpas!="undefined")){this.setRsaPrvKeyByPEMandPass(j.rsaprvpem,j.rsaprvpas)}}};YAHOO.lang.extend(KJUR.asn1.x509.CRL,KJUR.asn1.ASN1Object);KJUR.asn1.x509.TBSCertList=function(c){KJUR.asn1.x509.TBSCertList.superclass.constructor.call(this);var d=null;this.setSignatureAlgByParam=function(b){this.asn1SignatureAlg=new KJUR.asn1.x509.AlgorithmIdentifier(b)};this.setIssuerByParam=function(b){this.asn1Issuer=new KJUR.asn1.x509.X500Name(b)};this.setThisUpdateByParam=function(b){this.asn1ThisUpdate=new KJUR.asn1.x509.Time(b)};this.setNextUpdateByParam=function(b){this.asn1NextUpdate=new KJUR.asn1.x509.Time(b)};this.addRevokedCert=function(j,i){var b={};if(j!=undefined&&j!=null){b.sn=j}if(i!=undefined&&i!=null){b.time=i}var h=new KJUR.asn1.x509.CRLEntry(b);this.aRevokedCert.push(h)};this.getEncodedHex=function(){this.asn1Array=new Array();if(this.asn1Version!=null){this.asn1Array.push(this.asn1Version)}this.asn1Array.push(this.asn1SignatureAlg);this.asn1Array.push(this.asn1Issuer);this.asn1Array.push(this.asn1ThisUpdate);if(this.asn1NextUpdate!=null){this.asn1Array.push(this.asn1NextUpdate)}if(this.aRevokedCert.length>0){var e=new KJUR.asn1.DERSequence({array:this.aRevokedCert});this.asn1Array.push(e)}var b=new KJUR.asn1.DERSequence({array:this.asn1Array});this.hTLV=b.getEncodedHex();this.isModified=false;return this.hTLV};this._initialize=function(){this.asn1Version=null;this.asn1SignatureAlg=null;this.asn1Issuer=null;this.asn1ThisUpdate=null;this.asn1NextUpdate=null;this.aRevokedCert=new Array()};this._initialize()};YAHOO.lang.extend(KJUR.asn1.x509.TBSCertList,KJUR.asn1.ASN1Object);KJUR.asn1.x509.CRLEntry=function(f){KJUR.asn1.x509.CRLEntry.superclass.constructor.call(this);var d=null;var e=null;this.setCertSerial=function(b){this.sn=new KJUR.asn1.DERInteger(b)};this.setRevocationDate=function(b){this.time=new KJUR.asn1.x509.Time(b)};this.getEncodedHex=function(){var b=new KJUR.asn1.DERSequence({array:[this.sn,this.time]});this.TLV=b.getEncodedHex();return this.TLV};if(typeof f!="undefined"){if(typeof f.time!="undefined"){this.setRevocationDate(f.time)}if(typeof f.sn!="undefined"){this.setCertSerial(f.sn)}}};YAHOO.lang.extend(KJUR.asn1.x509.CRLEntry,KJUR.asn1.ASN1Object);KJUR.asn1.x509.X500Name=function(b){KJUR.asn1.x509.X500Name.superclass.constructor.call(this);this.asn1Array=new Array();this.setByString=function(e){var h=e.split("/");h.shift();for(var f=0;f<h.length;f++){this.asn1Array.push(new KJUR.asn1.x509.RDN({str:h[f]}))}};this.getEncodedHex=function(){var c=new KJUR.asn1.DERSequence({array:this.asn1Array});this.TLV=c.getEncodedHex();return this.TLV};if(typeof b!="undefined"){if(typeof b.str!="undefined"){this.setByString(b.str)}}};YAHOO.lang.extend(KJUR.asn1.x509.X500Name,KJUR.asn1.ASN1Object);KJUR.asn1.x509.RDN=function(b){KJUR.asn1.x509.RDN.superclass.constructor.call(this);this.asn1Array=new Array();this.addByString=function(c){this.asn1Array.push(new KJUR.asn1.x509.AttributeTypeAndValue({str:c}))};this.getEncodedHex=function(){var c=new KJUR.asn1.DERSet({array:this.asn1Array});this.TLV=c.getEncodedHex();return this.TLV};if(typeof b!="undefined"){if(typeof b.str!="undefined"){this.addByString(b.str)}}};YAHOO.lang.extend(KJUR.asn1.x509.RDN,KJUR.asn1.ASN1Object);KJUR.asn1.x509.AttributeTypeAndValue=function(e){KJUR.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this);var h=null;var i=null;var f="utf8";this.setByString=function(b){if(b.match(/^([^=]+)=(.+)$/)){this.setByAttrTypeAndValueStr(RegExp.$1,RegExp.$2)}else{throw"malformed attrTypeAndValueStr: "+b}};this.setByAttrTypeAndValueStr=function(b,c){this.typeObj=KJUR.asn1.x509.OID.atype2obj(b);
var d=f;if(b=="C"){d="prn"}this.valueObj=this.getValueObj(d,c)};this.getValueObj=function(b,c){if(b=="utf8"){return new KJUR.asn1.DERUTF8String({str:c})}if(b=="prn"){return new KJUR.asn1.DERPrintableString({str:c})}if(b=="tel"){return new KJUR.asn1.DERTeletexString({str:c})}if(b=="ia5"){return new KJUR.asn1.DERIA5String({str:c})}throw"unsupported directory string type: type="+b+" value="+c};this.getEncodedHex=function(){var b=new KJUR.asn1.DERSequence({array:[this.typeObj,this.valueObj]});this.TLV=b.getEncodedHex();return this.TLV};if(typeof e!="undefined"){if(typeof e.str!="undefined"){this.setByString(e.str)}}};YAHOO.lang.extend(KJUR.asn1.x509.AttributeTypeAndValue,KJUR.asn1.ASN1Object);KJUR.asn1.x509.SubjectPublicKeyInfo=function(h){KJUR.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var e=null;var i=null;var f=null;this.setRSAKey=function(m){if(!RSAKey.prototype.isPrototypeOf(m)){throw"argument is not RSAKey instance"}this.rsaKey=m;var d=new KJUR.asn1.DERInteger({bigint:m.n});var j=new KJUR.asn1.DERInteger({"int":m.e});var b=new KJUR.asn1.DERSequence({array:[d,j]});var c=b.getEncodedHex();this.asn1AlgId=new KJUR.asn1.x509.AlgorithmIdentifier({name:"rsaEncryption"});this.asn1SubjPKey=new KJUR.asn1.DERBitString({hex:"00"+c})};this.setRSAPEM=function(w){if(w.match(/-----BEGIN PUBLIC KEY-----/)){var b=w;b=b.replace(/^-----[^-]+-----/,"");b=b.replace(/-----[^-]+-----\s*$/,"");var c=b.replace(/\s+/g,"");var y=CryptoJS.enc.Base64.parse(c);var u=CryptoJS.enc.Hex.stringify(y);var o=_rsapem_getHexValueArrayOfChildrenFromHex(u);var v=o[1];var d=v.substr(2);var A=_rsapem_getHexValueArrayOfChildrenFromHex(d);var r=new RSAKey();r.setPublic(A[0],A[1]);this.setRSAKey(r)}else{throw"key not supported"}};this.getASN1Object=function(){if(this.asn1AlgId==null||this.asn1SubjPKey==null){throw"algId and/or subjPubKey not set"}var b=new KJUR.asn1.DERSequence({array:[this.asn1AlgId,this.asn1SubjPKey]});return b};this.getEncodedHex=function(){var b=this.getASN1Object();this.hTLV=b.getEncodedHex();return this.hTLV};this._setRSAKey=function(d){var b=KJUR.asn1.ASN1Util.newObject({seq:[{"int":{bigint:d.n}},{"int":{"int":d.e}}]});var c=b.getEncodedHex();this.asn1AlgId=new KJUR.asn1.x509.AlgorithmIdentifier({name:"rsaEncryption"});this.asn1SubjPKey=new KJUR.asn1.DERBitString({hex:"00"+c})};this._setEC=function(c){var b=new KJUR.asn1.DERObjectIdentifier({name:c.curveName});this.asn1AlgId=new KJUR.asn1.x509.AlgorithmIdentifier({name:"ecPublicKey",asn1params:b});this.asn1SubjPKey=new KJUR.asn1.DERBitString({hex:"00"+c.pubKeyHex})};this._setDSA=function(d){var c=new KJUR.asn1.ASN1Util.newObject({seq:[{"int":{bigint:d.p}},{"int":{bigint:d.q}},{"int":{bigint:d.g}}]});this.asn1AlgId=new KJUR.asn1.x509.AlgorithmIdentifier({name:"dsa",asn1params:c});var b=new KJUR.asn1.DERInteger({bigint:d.y});this.asn1SubjPKey=new KJUR.asn1.DERBitString({hex:"00"+b.getEncodedHex()})};if(typeof h!="undefined"){if(typeof RSAKey!="undefined"&&h instanceof RSAKey){this._setRSAKey(h)}else{if(typeof KJUR.crypto.ECDSA!="undefined"&&h instanceof KJUR.crypto.ECDSA){this._setEC(h)}else{if(typeof KJUR.crypto.DSA!="undefined"&&h instanceof KJUR.crypto.DSA){this._setDSA(h)}else{if(typeof h.rsakey!="undefined"){this.setRSAKey(h.rsakey)}else{if(typeof h.rsapem!="undefined"){this.setRSAPEM(h.rsapem)}}}}}}};YAHOO.lang.extend(KJUR.asn1.x509.SubjectPublicKeyInfo,KJUR.asn1.ASN1Object);KJUR.asn1.x509.Time=function(f){KJUR.asn1.x509.Time.superclass.constructor.call(this);var d=null;var e=null;this.setTimeParams=function(b){this.timeParams=b};this.getEncodedHex=function(){if(this.timeParams==null){throw"timeParams shall be specified. ({'str':'130403235959Z'}}"}var b=null;if(this.type=="utc"){b=new KJUR.asn1.DERUTCTime(this.timeParams)}else{b=new KJUR.asn1.DERGeneralizedTime(this.timeParams)}this.TLV=b.getEncodedHex();return this.TLV};this.type="utc";if(typeof f!="undefined"){if(typeof f.type!="undefined"){this.type=f.type}this.timeParams=f}};YAHOO.lang.extend(KJUR.asn1.x509.Time,KJUR.asn1.ASN1Object);
KJUR.asn1.x509.AlgorithmIdentifier=function(i){KJUR.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this);var h=null;var j=null;var f=null;var m=false;this.getEncodedHex=function(){if(this.nameAlg==null&&this.asn1Alg==null){throw"algorithm not specified"}if(this.nameAlg!=null&&this.asn1Alg==null){this.asn1Alg=KJUR.asn1.x509.OID.name2obj(this.nameAlg)}var c=[this.asn1Alg];if(!this.paramEmpty){c.push(this.asn1Params)}var b=new KJUR.asn1.DERSequence({array:c});this.hTLV=b.getEncodedHex();return this.hTLV};if(typeof i!="undefined"){if(typeof i.name!="undefined"){this.nameAlg=i.name}if(typeof i.asn1params!="undefined"){this.asn1Params=i.asn1params}if(typeof i.paramempty!="undefined"){this.paramEmpty=i.paramempty}}if(this.asn1Params==null){this.asn1Params=new KJUR.asn1.DERNull()}};YAHOO.lang.extend(KJUR.asn1.x509.AlgorithmIdentifier,KJUR.asn1.ASN1Object);KJUR.asn1.x509.GeneralName=function(h){KJUR.asn1.x509.GeneralName.superclass.constructor.call(this);var i=null;var e=null;var f={rfc822:"81",dns:"82",uri:"86"};this.setByParam=function(b){var c=null;var d=null;if(typeof b.rfc822!="undefined"){this.type="rfc822";d=new KJUR.asn1.DERIA5String({str:b[this.type]})}if(typeof b.dns!="undefined"){this.type="dns";d=new KJUR.asn1.DERIA5String({str:b[this.type]})}if(typeof b.uri!="undefined"){this.type="uri";d=new KJUR.asn1.DERIA5String({str:b[this.type]})}if(this.type==null){throw"unsupported type in params="+b}this.asn1Obj=new KJUR.asn1.DERTaggedObject({explicit:false,tag:f[this.type],obj:d})};this.getEncodedHex=function(){return this.asn1Obj.getEncodedHex()};if(typeof h!="undefined"){this.setByParam(h)}};YAHOO.lang.extend(KJUR.asn1.x509.GeneralName,KJUR.asn1.ASN1Object);KJUR.asn1.x509.GeneralNames=function(c){KJUR.asn1.x509.GeneralNames.superclass.constructor.call(this);var d=null;this.setByParamArray=function(b){for(var h=0;h<b.length;h++){var f=new KJUR.asn1.x509.GeneralName(b[h]);this.asn1Array.push(f)}};this.getEncodedHex=function(){var b=new KJUR.asn1.DERSequence({array:this.asn1Array});return b.getEncodedHex()};this.asn1Array=new Array();if(typeof c!="undefined"){this.setByParamArray(c)}};YAHOO.lang.extend(KJUR.asn1.x509.GeneralNames,KJUR.asn1.ASN1Object);KJUR.asn1.x509.DistributionPointName=function(f){KJUR.asn1.x509.DistributionPointName.superclass.constructor.call(this);var i=null;var m=null;var h=null;var j=null;this.getEncodedHex=function(){if(this.type!="full"){throw"currently type shall be 'full': "+this.type}this.asn1Obj=new KJUR.asn1.DERTaggedObject({explicit:false,tag:this.tag,obj:this.asn1V});this.hTLV=this.asn1Obj.getEncodedHex();return this.hTLV};if(typeof f!="undefined"){if(KJUR.asn1.x509.GeneralNames.prototype.isPrototypeOf(f)){this.type="full";this.tag="a0";this.asn1V=f}else{throw"This class supports GeneralNames only as argument"}}};YAHOO.lang.extend(KJUR.asn1.x509.DistributionPointName,KJUR.asn1.ASN1Object);KJUR.asn1.x509.DistributionPoint=function(c){KJUR.asn1.x509.DistributionPoint.superclass.constructor.call(this);var d=null;this.getEncodedHex=function(){var e=new KJUR.asn1.DERSequence();if(this.asn1DP!=null){var b=new KJUR.asn1.DERTaggedObject({explicit:true,tag:"a0",obj:this.asn1DP});e.appendASN1Object(b)}this.hTLV=e.getEncodedHex();return this.hTLV};if(typeof c!="undefined"){if(typeof c.dpobj!="undefined"){this.asn1DP=c.dpobj}}};YAHOO.lang.extend(KJUR.asn1.x509.DistributionPoint,KJUR.asn1.ASN1Object);KJUR.asn1.x509.OID=new function(b){this.atype2oidList={C:"2.5.4.6",O:"2.5.4.10",OU:"2.5.4.11",ST:"2.5.4.8",L:"2.5.4.7",CN:"2.5.4.3"};this.name2oidList={sha384:"2.16.840.1.101.3.4.2.2",sha224:"2.16.840.1.101.3.4.2.4",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",subjectKeyIdentifier:"2.5.29.14",countryName:"2.5.4.6",organization:"2.5.4.10",organizationalUnit:"2.5.4.11",stateOrProvinceName:"2.5.4.8",locality:"2.5.4.7",commonName:"2.5.4.3",keyUsage:"2.5.29.15",basicConstraints:"2.5.29.19",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",authorityKeyIdentifier:"2.5.29.35",extKeyUsage:"2.5.29.37",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",ecPublicKey:"1.2.840.10045.2.1",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7"};
this.objCache={};this.name2obj=function(e){if(typeof this.objCache[e]!="undefined"){return this.objCache[e]}if(typeof this.name2oidList[e]=="undefined"){throw"Name of ObjectIdentifier not defined: "+e}var h=this.name2oidList[e];var f=new KJUR.asn1.DERObjectIdentifier({oid:h});this.objCache[e]=f;return f};this.atype2obj=function(e){if(typeof this.objCache[e]!="undefined"){return this.objCache[e]}if(typeof this.atype2oidList[e]=="undefined"){throw"AttributeType name undefined: "+e}var h=this.atype2oidList[e];var f=new KJUR.asn1.DERObjectIdentifier({oid:h});this.objCache[e]=f;return f}};KJUR.asn1.x509.X509Util=new function(){this.getPKCS8PubKeyPEMfromRSAKey=function(r){var u=null;var w=KJUR.asn1.ASN1Util.bigIntToMinTwosComplementsHex(r.n);var o=KJUR.asn1.ASN1Util.integerToByteHex(r.e);var D=new KJUR.asn1.DERInteger({hex:w});var v=new KJUR.asn1.DERInteger({hex:o});var m=new KJUR.asn1.DERSequence({array:[D,v]});var B=m.getEncodedHex();var A=new KJUR.asn1.x509.AlgorithmIdentifier({name:"rsaEncryption"});var C=new KJUR.asn1.DERBitString({hex:"00"+B});var n=new KJUR.asn1.DERSequence({array:[A,C]});var y=n.getEncodedHex();var u=KJUR.asn1.ASN1Util.getPEMStringFromHex(y,"PUBLIC KEY");return u}};KJUR.asn1.x509.X509Util.newCertPEM=function(j){var o=KJUR.asn1.x509;var m=new o.TBSCertificate();if(j.serial!==undefined){m.setSerialNumberByParam(j.serial)}else{throw"serial number undefined."}if(typeof j.sigalg.name=="string"){m.setSignatureAlgByParam(j.sigalg)}else{throw"unproper signature algorithm name"}if(j.issuer!==undefined){m.setIssuerByParam(j.issuer)}else{throw"issuer name undefined."}if(j.notbefore!==undefined){m.setNotBeforeByParam(j.notbefore)}else{throw"notbefore undefined."}if(j.notafter!==undefined){m.setNotAfterByParam(j.notafter)}else{throw"notafter undefined."}if(j.subject!==undefined){m.setSubjectByParam(j.subject)}else{throw"subject name undefined."}if(j.sbjpubkey!==undefined){m.setSubjectPublicKeyByGetKey(j.sbjpubkey)}else{throw"subject public key undefined."}if(j.ext!==undefined&&j.ext.length!==undefined){for(var h=0;h<j.ext.length;h++){for(key in j.ext[h]){m.appendExtensionByName(key,j.ext[h][key])}}}if(j.cakey===undefined&&j.sighex===undefined){throw"param cakey and sighex undefined."}var n=null;var i=null;if(j.cakey){n=KEYUTIL.getKey.apply(null,j.cakey);i=new o.Certificate({tbscertobj:m,prvkeyobj:n});i.sign()}if(j.sighex){i=new o.Certificate({tbscertobj:m});i.setSignatureHex(j.sighex)}return i.getPEMString()};
;function Base64x(){}function stoBA(f){var e=new Array();for(var h=0;h<f.length;h++){e[h]=f.charCodeAt(h)}return e}function BAtos(e){var f="";for(var h=0;h<e.length;h++){f=f+String.fromCharCode(e[h])}return f}function BAtohex(f){var h="";for(var i=0;i<f.length;i++){var j=f[i].toString(16);if(j.length==1){j="0"+j}h=h+j}return h}function stohex(b){return BAtohex(stoBA(b))}function stob64(b){return hex2b64(stohex(b))}function stob64u(b){return b64tob64u(hex2b64(stohex(b)))}function b64utos(b){return BAtos(b64toBA(b64utob64(b)))}function b64tob64u(b){b=b.replace(/\=/g,"");b=b.replace(/\+/g,"-");b=b.replace(/\//g,"_");return b}function b64utob64(b){if(b.length%4==2){b=b+"=="}else{if(b.length%4==3){b=b+"="}}b=b.replace(/-/g,"+");b=b.replace(/_/g,"/");return b}function hextob64u(b){return b64tob64u(hex2b64(b))}function b64utohex(b){return b64tohex(b64utob64(b))}var utf8tob64u,b64utoutf8;if(typeof Buffer==="function"){utf8tob64u=function(b){return b64tob64u(new Buffer(b,"utf8").toString("base64"))};b64utoutf8=function(b){return new Buffer(b64utob64(b),"base64").toString("utf8")}}else{utf8tob64u=function(b){return hextob64u(uricmptohex(encodeURIComponentAll(b)))};b64utoutf8=function(b){return decodeURIComponent(hextouricmp(b64utohex(b)))}}function utf8tob64(b){return hex2b64(uricmptohex(encodeURIComponentAll(b)))}function b64toutf8(b){return decodeURIComponent(hextouricmp(b64tohex(b)))}function utf8tohex(b){return uricmptohex(encodeURIComponentAll(b))
}function hextoutf8(b){return decodeURIComponent(hextouricmp(b))}function hextorstr(f){var d="";for(var e=0;e<f.length-1;e+=2){d+=String.fromCharCode(parseInt(f.substr(e,2),16))}return d}function rstrtohex(f){var e="";for(var d=0;d<f.length;d++){e+=("0"+f.charCodeAt(d).toString(16)).slice(-2)}return e}function uricmptohex(b){return b.replace(/%/g,"")}function hextouricmp(b){return b.replace(/(..)/g,"%$1")}function encodeURIComponentAll(f){var h=encodeURIComponent(f);var e="";for(var i=0;i<h.length;i++){if(h[i]=="%"){e=e+h.substr(i,3);i=i+2}else{e=e+"%"+stohex(h[i])}}return e}function newline_toUnix(b){b=b.replace(/\r\n/mg,"\n");return b}function newline_toDos(b){b=b.replace(/\r\n/mg,"\n");b=b.replace(/\n/mg,"\r\n");return b}
;if(typeof KJUR=="undefined"||!KJUR){KJUR={}}if(typeof KJUR.crypto=="undefined"||!KJUR.crypto){KJUR.crypto={}}KJUR.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"};this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"};this.CRYPTOJSMESSAGEDIGESTNAME={md5:"CryptoJS.algo.MD5",sha1:"CryptoJS.algo.SHA1",sha224:"CryptoJS.algo.SHA224",sha256:"CryptoJS.algo.SHA256",sha384:"CryptoJS.algo.SHA384",sha512:"CryptoJS.algo.SHA512",ripemd160:"CryptoJS.algo.RIPEMD160"};this.getDigestInfoHex=function(d,c){if(typeof this.DIGESTINFOHEAD[c]=="undefined"){throw"alg not supported in Util.DIGESTINFOHEAD: "+c}return this.DIGESTINFOHEAD[c]+d};this.getPaddedDigestInfoHex=function(o,B,n){var y=this.getDigestInfoHex(o,B);var w=n/4;if(y.length+22>w){throw"key is too short for SigAlg: keylen="+n+","+B}var A="0001";var m="00"+y;var r="";var i=w-A.length-m.length;for(var u=0;u<i;u+=2){r+="ff"}var v=A+r+m;return v};this.hashString=function(e,f){var d=new KJUR.crypto.MessageDigest({alg:f});return d.digestString(e)};this.hashHex=function(d,f){var e=new KJUR.crypto.MessageDigest({alg:f});return e.digestHex(d)};this.sha1=function(d){var c=new KJUR.crypto.MessageDigest({alg:"sha1",prov:"cryptojs"});return c.digestString(d)};this.sha256=function(d){var c=new KJUR.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"});return c.digestString(d)};this.sha256Hex=function(d){var c=new KJUR.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"});return c.digestHex(d)};this.sha512=function(d){var c=new KJUR.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"});return c.digestString(d)};this.sha512Hex=function(d){var c=new KJUR.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"});return c.digestHex(d)};this.md5=function(d){var c=new KJUR.crypto.MessageDigest({alg:"md5",prov:"cryptojs"});return c.digestString(d)
};this.ripemd160=function(d){var c=new KJUR.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"});return c.digestString(d)};this.getCryptoJSMDByName=function(b){}};KJUR.crypto.MessageDigest=function(params){var md=null;var algName=null;var provName=null;this.setAlgAndProvider=function(alg,prov){if(alg!=null&&prov===undefined){prov=KJUR.crypto.Util.DEFAULTPROVIDER[alg]}if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(alg)!=-1&&prov=="cryptojs"){try{this.md=eval(KJUR.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[alg]).create()}catch(ex){throw"setAlgAndProvider hash alg set fail alg="+alg+"/"+ex}this.updateString=function(str){this.md.update(str)};this.updateHex=function(hex){var wHex=CryptoJS.enc.Hex.parse(hex);this.md.update(wHex)};this.digest=function(){var hash=this.md.finalize();return hash.toString(CryptoJS.enc.Hex)};this.digestString=function(str){this.updateString(str);return this.digest()};this.digestHex=function(hex){this.updateHex(hex);return this.digest()}}if(":sha256:".indexOf(alg)!=-1&&prov=="sjcl"){try{this.md=new sjcl.hash.sha256()}catch(ex){throw"setAlgAndProvider hash alg set fail alg="+alg+"/"+ex}this.updateString=function(str){this.md.update(str)};this.updateHex=function(hex){var baHex=sjcl.codec.hex.toBits(hex);this.md.update(baHex)};this.digest=function(){var hash=this.md.finalize();return sjcl.codec.hex.fromBits(hash)};this.digestString=function(str){this.updateString(str);return this.digest()};this.digestHex=function(hex){this.updateHex(hex);return this.digest()}}};this.updateString=function(str){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName};this.updateHex=function(hex){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName};this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName};this.digestString=function(str){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName};this.digestHex=function(hex){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName};if(params!==undefined){if(params.alg!==undefined){this.algName=params.alg;if(params.prov===undefined){this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]}this.setAlgAndProvider(this.algName,this.provName)}}};KJUR.crypto.Mac=function(params){var mac=null;var pass=null;var algName=null;var provName=null;var algProv=null;this.setAlgAndProvider=function(alg,prov){if(alg==null){alg="hmacsha1"}alg=alg.toLowerCase();if(alg.substr(0,4)!="hmac"){throw"setAlgAndProvider unsupported HMAC alg: "+alg}if(prov===undefined){prov=KJUR.crypto.Util.DEFAULTPROVIDER[alg]}this.algProv=alg+"/"+prov;var hashAlg=alg.substr(4);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(hashAlg)!=-1&&prov=="cryptojs"){try{var mdObj=eval(KJUR.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[hashAlg]);this.mac=CryptoJS.algo.HMAC.create(mdObj,this.pass)}catch(ex){throw"setAlgAndProvider hash alg set fail hashAlg="+hashAlg+"/"+ex}this.updateString=function(str){this.mac.update(str)};this.updateHex=function(hex){var wHex=CryptoJS.enc.Hex.parse(hex);this.mac.update(wHex)};this.doFinal=function(){var hash=this.mac.finalize();return hash.toString(CryptoJS.enc.Hex)};this.doFinalString=function(str){this.updateString(str);return this.doFinal()};this.doFinalHex=function(hex){this.updateHex(hex);return this.doFinal()}}};this.updateString=function(str){throw"updateString(str) not supported for this alg/prov: "+this.algProv};this.updateHex=function(hex){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv};this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv};this.doFinalString=function(str){throw"digestString(str) not supported for this alg/prov: "+this.algProv};this.doFinalHex=function(hex){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv};if(params!==undefined){if(params.pass!==undefined){this.pass=params.pass}if(params.alg!==undefined){this.algName=params.alg;
if(params.prov===undefined){this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]}this.setAlgAndProvider(this.algName,this.provName)}}};KJUR.crypto.Signature=function(y){var v=null;var A=null;var u=null;var L=null;var C=null;var K=null;var D=null;var G=null;var w=null;var J=null;var M=-1;var H=null;var E=null;var N=null;var F=null;var I=null;this._setAlgNames=function(){if(this.algName.match(/^(.+)with(.+)$/)){this.mdAlgName=RegExp.$1.toLowerCase();this.pubkeyAlgName=RegExp.$2.toLowerCase()}};this._zeroPaddingOfSignature=function(b,c){var d="";var f=c/4-b.length;for(var e=0;e<f;e++){d=d+"0"}return d+b};this.setAlgAndProvider=function(b,c){this._setAlgNames();if(c!="cryptojs/jsrsa"){throw"provider not supported: "+c}if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)!=-1){try{this.md=new KJUR.crypto.MessageDigest({alg:this.mdAlgName})}catch(d){throw"setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+d}this.init=function(f,e){var i=null;try{if(e===undefined){i=KEYUTIL.getKey(f)}else{i=KEYUTIL.getKey(f,e)}}catch(h){throw"init failed:"+h}if(i.isPrivate===true){this.prvKey=i;this.state="SIGN"}else{if(i.isPublic===true){this.pubKey=i;this.state="VERIFY"}else{throw"init failed.:"+i}}};this.initSign=function(e){if(typeof e.ecprvhex=="string"&&typeof e.eccurvename=="string"){this.ecprvhex=e.ecprvhex;this.eccurvename=e.eccurvename}else{this.prvKey=e}this.state="SIGN"};this.initVerifyByPublicKey=function(e){if(typeof e.ecpubhex=="string"&&typeof e.eccurvename=="string"){this.ecpubhex=e.ecpubhex;this.eccurvename=e.eccurvename}else{if(e instanceof KJUR.crypto.ECDSA){this.pubKey=e}else{if(e instanceof RSAKey){this.pubKey=e}}}this.state="VERIFY"};this.initVerifyByCertificatePEM=function(f){var e=new X509();e.readCertPEM(f);this.pubKey=e.subjectPublicKeyRSA;this.state="VERIFY"};this.updateString=function(e){this.md.updateString(e)};this.updateHex=function(e){this.md.updateHex(e)};this.sign=function(){this.sHashHex=this.md.digest();if(typeof this.ecprvhex!="undefined"&&typeof this.eccurvename!="undefined"){var e=new KJUR.crypto.ECDSA({curve:this.eccurvename});this.hSign=e.signHex(this.sHashHex,this.ecprvhex)}else{if(this.pubkeyAlgName=="rsaandmgf1"){this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen)}else{if(this.pubkeyAlgName=="rsa"){this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName)}else{if(this.prvKey instanceof KJUR.crypto.ECDSA){this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}else{if(this.prvKey instanceof KJUR.crypto.DSA){this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}else{throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}}}}return this.hSign};this.signString=function(e){this.updateString(e);this.sign()};this.signHex=function(e){this.updateHex(e);this.sign()};this.verify=function(f){this.sHashHex=this.md.digest();if(typeof this.ecpubhex!="undefined"&&typeof this.eccurvename!="undefined"){var e=new KJUR.crypto.ECDSA({curve:this.eccurvename});return e.verifyHex(this.sHashHex,f,this.ecpubhex)}else{if(this.pubkeyAlgName=="rsaandmgf1"){return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,f,this.mdAlgName,this.pssSaltLen)}else{if(this.pubkeyAlgName=="rsa"){return this.pubKey.verifyWithMessageHash(this.sHashHex,f)}else{if(this.pubKey instanceof KJUR.crypto.ECDSA){return this.pubKey.verifyWithMessageHash(this.sHashHex,f)}else{if(this.pubKey instanceof KJUR.crypto.DSA){return this.pubKey.verifyWithMessageHash(this.sHashHex,f)}else{throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}}}}}}};this.init=function(c,b){throw"init(key, pass) not supported for this alg:prov="+this.algProvName};this.initVerifyByPublicKey=function(b){throw"initVerifyByPublicKey(rsaPubKeyy) not supported for this alg:prov="+this.algProvName};this.initVerifyByCertificatePEM=function(b){throw"initVerifyByCertificatePEM(certPEM) not supported for this alg:prov="+this.algProvName};this.initSign=function(b){throw"initSign(prvKey) not supported for this alg:prov="+this.algProvName
};this.updateString=function(b){throw"updateString(str) not supported for this alg:prov="+this.algProvName};this.updateHex=function(b){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName};this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName};this.signString=function(b){throw"digestString(str) not supported for this alg:prov="+this.algProvName};this.signHex=function(b){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName};this.verify=function(b){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName};this.initParams=y;if(y!==undefined){if(y.alg!==undefined){this.algName=y.alg;if(y.prov===undefined){this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]}else{this.provName=y.prov}this.algProvName=this.algName+":"+this.provName;this.setAlgAndProvider(this.algName,this.provName);this._setAlgNames()}if(y.psssaltlen!==undefined){this.pssSaltLen=y.psssaltlen}if(y.prvkeypem!==undefined){if(y.prvkeypas!==undefined){throw"both prvkeypem and prvkeypas parameters not supported"}else{try{var v=new RSAKey();v.readPrivateKeyFromPEMString(y.prvkeypem);this.initSign(v)}catch(B){throw"fatal error to load pem private key: "+B}}}}};KJUR.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}};
;if(typeof KJUR=="undefined"||!KJUR){KJUR={}}if(typeof KJUR.crypto=="undefined"||!KJUR.crypto){KJUR.crypto={}}KJUR.crypto.ECDSA=function(m){var r="secp256r1";var n=null;var i=null;var o=null;var j=new SecureRandom();var u=null;this.type="EC";function v(d,w,e,y){var b=Math.max(w.bitLength(),y.bitLength());var c=d.add2D(e);var f=d.curve.getInfinity();for(var h=b-1;h>=0;--h){f=f.twice2D();f.z=BigInteger.ONE;if(w.testBit(h)){if(y.testBit(h)){f=f.add2D(c)}else{f=f.add2D(d)}}else{if(y.testBit(h)){f=f.add2D(e)}}}return f}this.getBigRandom=function(b){return new BigInteger(b.bitLength(),j).mod(b.subtract(BigInteger.ONE)).add(BigInteger.ONE)};this.setNamedCurve=function(b){this.ecparams=KJUR.crypto.ECParameterDB.getByName(b);this.prvKeyHex=null;this.pubKeyHex=null;this.curveName=b};this.setPrivateKeyHex=function(b){this.isPrivate=true;this.prvKeyHex=b};this.setPublicKeyHex=function(b){this.isPublic=true;this.pubKeyHex=b};this.generateKeyPairHex=function(){var y=this.ecparams.n;var f=this.getBigRandom(y);var w=this.ecparams.G.multiply(f);var c=w.getX().toBigInteger();var e=w.getY().toBigInteger();var B=this.ecparams.keylen/4;var h=("0000000000"+f.toString(16)).slice(-B);var b=("0000000000"+c.toString(16)).slice(-B);var d=("0000000000"+e.toString(16)).slice(-B);var A="04"+b+d;this.setPrivateKeyHex(h);this.setPublicKeyHex(A);return{ecprvhex:h,ecpubhex:A}};this.signWithMessageHash=function(b){return this.signHex(b,this.prvKeyHex)};this.signHex=function(d,h){var B=new BigInteger(h,16);var f=this.ecparams.n;var b=new BigInteger(d,16);do{var e=this.getBigRandom(f);var A=this.ecparams.G;var c=A.multiply(e);var w=c.getX().toBigInteger().mod(f)}while(w.compareTo(BigInteger.ZERO)<=0);var y=e.modInverse(f).multiply(b.add(B.multiply(w))).mod(f);return KJUR.crypto.ECDSA.biRSSigToASN1Sig(w,y)};this.sign=function(e,A){var b=A;var h=this.ecparams.n;var c=BigInteger.fromByteArrayUnsigned(e);do{var f=this.getBigRandom(h);var B=this.ecparams.G;var d=B.multiply(f);var w=d.getX().toBigInteger().mod(h)}while(w.compareTo(BigInteger.ZERO)<=0);var y=f.modInverse(h).multiply(c.add(b.multiply(w))).mod(h);return this.serializeSig(w,y)};this.verifyWithMessageHash=function(b,c){return this.verifyHex(b,c,this.pubKeyHex)};this.verifyHex=function(b,f,h){var c,e;
var w=KJUR.crypto.ECDSA.parseSigHex(f);c=w.r;e=w.s;var d;d=ECPointFp.decodeFromHex(this.ecparams.curve,h);var y=new BigInteger(b,16);return this.verifyRaw(y,c,e,d)};this.verify=function(w,h,e){var c,f;if(Bitcoin.Util.isArray(h)){var y=this.parseSig(h);c=y.r;f=y.s}else{if("object"===typeof h&&h.r&&h.s){c=h.r;f=h.s}else{throw"Invalid value for signature"}}var d;if(e instanceof ECPointFp){d=e}else{if(Bitcoin.Util.isArray(e)){d=ECPointFp.decodeFrom(this.ecparams.curve,e)}else{throw"Invalid format for pubkey value, must be byte array or ECPointFp"}}var b=BigInteger.fromByteArrayUnsigned(w);return this.verifyRaw(b,c,f,d)};this.verifyRaw=function(d,A,B,e){var f=this.ecparams.n;var C=this.ecparams.G;if(A.compareTo(BigInteger.ONE)<0||A.compareTo(f)>=0){return false}if(B.compareTo(BigInteger.ONE)<0||B.compareTo(f)>=0){return false}var c=B.modInverse(f);var h=d.multiply(c).mod(f);var y=A.multiply(c).mod(f);var b=C.multiply(h).add(e.multiply(y));var D=b.getX().toBigInteger().mod(f);return D.equals(A)};this.serializeSig=function(d,e){var c=d.toByteArraySigned();var f=e.toByteArraySigned();var b=[];b.push(2);b.push(c.length);b=b.concat(c);b.push(2);b.push(f.length);b=b.concat(f);b.unshift(b.length);b.unshift(48);return b};this.parseSig=function(h){var b;if(h[0]!=48){throw new Error("Signature not a valid DERSequence")}b=2;if(h[b]!=2){throw new Error("First element in signature must be a DERInteger")}var c=h.slice(b+2,b+2+h[b+1]);b+=2+h[b+1];if(h[b]!=2){throw new Error("Second element in signature must be a DERInteger")}var f=h.slice(b+2,b+2+h[b+1]);b+=2+h[b+1];var d=BigInteger.fromByteArrayUnsigned(c);var e=BigInteger.fromByteArrayUnsigned(f);return{r:d,s:e}};this.parseSigCompact=function(b){if(b.length!==65){throw"Signature has the wrong length"}var e=b[0]-27;if(e<0||e>7){throw"Invalid signature type"}var f=this.ecparams.n;var c=BigInteger.fromByteArrayUnsigned(b.slice(1,33)).mod(f);var d=BigInteger.fromByteArrayUnsigned(b.slice(33,65)).mod(f);return{r:c,s:d,i:e}};if(m!==undefined){if(m.curve!==undefined){this.curveName=m.curve}}if(this.curveName===undefined){this.curveName=r}this.setNamedCurve(this.curveName);if(m!==undefined){if(m.prv!==undefined){this.setPrivateKeyHex(m.prv)}if(m.pub!==undefined){this.setPublicKeyHex(m.pub)}}};KJUR.crypto.ECDSA.parseSigHex=function(f){var e=KJUR.crypto.ECDSA.parseSigHexInHexRS(f);var h=new BigInteger(e.r,16);var i=new BigInteger(e.s,16);return{r:h,s:i}};KJUR.crypto.ECDSA.parseSigHexInHexRS=function(o){if(o.substr(0,2)!="30"){throw"signature is not a ASN.1 sequence"}var h=ASN1HEX.getPosArrayOfChildren_AtObj(o,0);if(h.length!=2){throw"number of signature ASN.1 sequence elements seem wrong"}var i=h[0];var j=h[1];if(o.substr(i,2)!="02"){throw"1st item of sequene of signature is not ASN.1 integer"}if(o.substr(j,2)!="02"){throw"2nd item of sequene of signature is not ASN.1 integer"}var m=ASN1HEX.getHexOfV_AtObj(o,i);var n=ASN1HEX.getHexOfV_AtObj(o,j);return{r:m,s:n}};KJUR.crypto.ECDSA.asn1SigToConcatSig=function(i){var h=KJUR.crypto.ECDSA.parseSigHexInHexRS(i);var e=h.r;var f=h.s;if(e.substr(0,2)=="00"&&(((e.length/2)*8)%(16*8))==8){e=e.substr(2)}if(f.substr(0,2)=="00"&&(((f.length/2)*8)%(16*8))==8){f=f.substr(2)}if((((e.length/2)*8)%(16*8))!=0){throw"unknown ECDSA sig r length error"}if((((f.length/2)*8)%(16*8))!=0){throw"unknown ECDSA sig s length error"}return e+f};KJUR.crypto.ECDSA.concatSigToASN1Sig=function(e){if((((e.length/2)*8)%(16*8))!=0){throw"unknown ECDSA concatinated r-s sig  length error"}var f=e.substr(0,e.length/2);var d=e.substr(e.length/2);return KJUR.crypto.ECDSA.hexRSSigToASN1Sig(f,d)};KJUR.crypto.ECDSA.hexRSSigToASN1Sig=function(e,f){var h=new BigInteger(e,16);var i=new BigInteger(f,16);return KJUR.crypto.ECDSA.biRSSigToASN1Sig(h,i)};KJUR.crypto.ECDSA.biRSSigToASN1Sig=function(i,m){var f=new KJUR.asn1.DERInteger({bigint:i});var h=new KJUR.asn1.DERInteger({bigint:m});var j=new KJUR.asn1.DERSequence({array:[f,h]});return j.getEncodedHex()};
;
if(typeof KJUR=="undefined"||!KJUR){KJUR={}}if(typeof KJUR.crypto=="undefined"||!KJUR.crypto){KJUR.crypto={}}KJUR.crypto.ECParameterDB=new function(){var d={};var f={};function e(b){return new BigInteger(b,16)}this.getByName=function(b){var c=b;if(typeof f[c]!="undefined"){c=f[b]}if(typeof d[c]!="undefined"){return d[c]}throw"unregistered EC curve name: "+c};this.regist=function(G,J,H,M,I,O,L,N,K,B,P,h){d[G]={};var D=e(H);var b=e(M);var c=e(I);var C=e(O);var i=e(L);var E=new ECCurveFp(D,b,c);var F=E.decodePointHex("04"+N+K);d[G]["name"]=G;d[G]["keylen"]=J;d[G]["curve"]=E;d[G]["G"]=F;d[G]["n"]=C;d[G]["h"]=i;d[G]["oid"]=P;d[G]["info"]=h;for(var n=0;n<B.length;n++){f[B[n]]=G}}};KJUR.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field");KJUR.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field");KJUR.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field");KJUR.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]);KJUR.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]);KJUR.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]);KJUR.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]);KJUR.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]);KJUR.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]);
KJUR.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]);
;if(typeof KJUR=="undefined"||!KJUR){KJUR={}}if(typeof KJUR.crypto=="undefined"||!KJUR.crypto){KJUR.crypto={}}KJUR.crypto.DSA=function(){this.p=null;this.q=null;this.g=null;this.y=null;this.x=null;this.type="DSA";this.setPrivate=function(f,c,d,b,e){this.isPrivate=true;this.p=f;this.q=c;this.g=d;this.y=b;this.x=e};this.setPublic=function(b,c,d,e){this.isPublic=true;this.p=b;this.q=c;this.g=d;this.y=e;this.x=null};this.signWithMessageHash=function(f){var j=this.p;var n=this.q;var c=this.g;var b=this.y;var r=this.x;var e=f.substr(0,n.bitLength()/4);var d=new BigInteger(f,16);var h=w(BigInteger.ONE.add(BigInteger.ONE),n.subtract(BigInteger.ONE));var m=(c.modPow(h,j)).mod(n);var o=(h.modInverse(n).multiply(d.add(r.multiply(m)))).mod(n);var i=KJUR.asn1.ASN1Util.jsonToASN1HEX({seq:[{"int":{bigint:m}},{"int":{bigint:o}}]});return i};this.verifyWithMessageHash=function(c,d){var f=this.p;var r=this.q;var o=this.g;var n=this.y;var M=this.parseASN1Signature(d);var h=M[0];var i=M[1];var c=c.substr(0,r.bitLength()/4);var b=new BigInteger(c,16);if(BigInteger.ZERO.compareTo(h)>0||h.compareTo(r)>0||BigInteger.ZERO.compareTo(i)>0||i.compareTo(r)>0){throw"invalid DSA signature"}var j=i.modInverse(r);var e=b.multiply(j).mod(r);var m=h.multiply(j).mod(r);var L=o.modPow(e,f).multiply(n.modPow(m,f)).mod(f).mod(r);return L.compareTo(h)==0};this.parseASN1Signature=function(d){try{var e=new BigInteger(ASN1HEX.getVbyList(d,0,[0],"02"),16);var c=new BigInteger(ASN1HEX.getVbyList(d,0,[1],"02"),16);return[e,c]}catch(b){throw"malformed DSA signature"}};function F(r,i,d,j,n,c){var f=KJUR.crypto.Util.hashString(i,r.toLowerCase());var f=f.substr(0,n.bitLength()/4);var e=new BigInteger(f,16);var h=w(BigInteger.ONE.add(BigInteger.ONE),n.subtract(BigInteger.ONE));var o=(d.modPow(h,j)).mod(n);var b=(h.modInverse(n).multiply(e.add(c.multiply(o)))).mod(n);var m=new Array();m[0]=o;m[1]=b;return m}function u(b){var c=openpgp.config.config.prefer_hash_algorithm;switch(Math.round(b.bitLength()/8)){case 20:if(c!=2&&c>11&&c!=10&&c<8){return 2}return c;case 28:if(c>11&&c<8){return 11}return c;case 32:if(c>10&&c<8){return 8}return c;default:util.print_debug("DSA select hash algorithm: returning null for an unknown length of q");return null}}this.select_hash_algorithm=u;function y(j,h,i,d,f,r,L,o){var c=KJUR.crypto.Util.hashString(d,j.toLowerCase());var c=c.substr(0,r.bitLength()/4);var b=new BigInteger(c,16);if(BigInteger.ZERO.compareTo(h)>0||h.compareTo(r)>0||BigInteger.ZERO.compareTo(i)>0||i.compareTo(r)>0){util.print_error("invalid DSA Signature");return null}var n=i.modInverse(r);var e=b.multiply(n).mod(r);var m=h.multiply(n).mod(r);var M=L.modPow(e,f).multiply(o.modPow(m,f)).mod(f).mod(r);return M.compareTo(h)==0}function I(f){var b=new BigInteger(f,primeCenterie);var h=A(q,512);var e=J(p,q,f);var d;do{d=new BigInteger(q.bitCount(),rand)}while(x.compareTo(BigInteger.ZERO)!=1&&x.compareTo(q)!=-1);var c=g.modPow(x,p);return{x:d,q:b,p:h,g:e,y:c}}function A(f,e,b){if(e%64!=0){return false
}var d;var c;do{d=b(bitcount,true);c=d.subtract(BigInteger.ONE);d=d.subtract(c.remainder(f))}while(!d.isProbablePrime(primeCenterie)||d.bitLength()!=l);return d}function J(i,f,b,c){var e=i.subtract(BigInteger.ONE);var h=e.divide(f);var d;do{d=c(b)}while(d.compareTo(e)!=-1&&d.compareTo(BigInteger.ONE)!=1);return d.modPow(h,i)}function v(b,e,d){var c;do{c=d(e,false)}while(c.compareTo(b)!=-1&&c.compareTo(BigInteger.ZERO)!=1);return c}function B(c,b){k=v(c);var d=g.modPow(k,b).mod(c);return d}function C(i,c,h,d,f,e){var b=i(d);s=(c.modInverse(f).multiply(b.add(e.multiply(h)))).mod(f);return s}this.sign=F;this.verify=y;function w(b,d){if(d.compareTo(b)<=0){return}var c=d.subtract(b);var e=E(c.bitLength());while(e>c){e=E(c.bitLength())}return b.add(e)}function E(b){if(b<0){return null}var d=Math.floor((b+7)/8);var c=G(d);if(b%8>0){c=String.fromCharCode((Math.pow(2,b%8)-1)&c.charCodeAt(0))+c.substring(1)}return new BigInteger(D(c),16)}function G(b){var d="";for(var c=0;c<b;c++){d+=String.fromCharCode(H())}return d}function H(){var b=new Uint32Array(1);window.crypto.getRandomValues(b);return b[0]&255}function D(f){if(f==null){return""}var c=[];var b=f.length;var e=0;var d;while(e<b){d=f[e++].charCodeAt().toString(16);while(d.length<2){d="0"+d}c.push(""+d)}return c.join("")}this.getRandomBigIntegerInRange=w;this.getRandomBigInteger=E;this.getRandomBytes=G};
;var PKCS5PKEY=function(){var D=function(d,b,c){return v(CryptoJS.AES,d,b,c)};var C=function(d,b,c){return v(CryptoJS.TripleDES,d,b,c)};var v=function(c,h,m,e){var d=CryptoJS.enc.Hex.parse(h);var i=CryptoJS.enc.Hex.parse(m);var f=CryptoJS.enc.Hex.parse(e);var b={};b.key=i;b.iv=f;b.ciphertext=d;var j=c.decrypt(b,i,{iv:f});return CryptoJS.enc.Hex.stringify(j)};var u=function(d,b,c){return B(CryptoJS.AES,d,b,c)};var n=function(d,b,c){return B(CryptoJS.TripleDES,d,b,c)};var B=function(H,h,j,d){var b=CryptoJS.enc.Hex.parse(h);var i=CryptoJS.enc.Hex.parse(j);var e=CryptoJS.enc.Hex.parse(d);var f={};var m=H.encrypt(b,i,{iv:e});var c=CryptoJS.enc.Hex.parse(m.toString());var G=CryptoJS.enc.Base64.stringify(c);return G};var y={"AES-256-CBC":{proc:D,eproc:u,keylen:32,ivlen:16},"AES-192-CBC":{proc:D,eproc:u,keylen:24,ivlen:16},"AES-128-CBC":{proc:D,eproc:u,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:C,eproc:n,keylen:24,ivlen:8}};var E=function(b){return y[b]["proc"]};var r=function(d){var b=CryptoJS.lib.WordArray.random(d);var c=CryptoJS.enc.Hex.stringify(b);return c};var o=function(d){var c={};if(d.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"))){c.cipher=RegExp.$1;c.ivsalt=RegExp.$2}if(d.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"))){c.type=RegExp.$1}var e=-1;var b=0;if(d.indexOf("\r\n\r\n")!=-1){e=d.indexOf("\r\n\r\n");b=2}if(d.indexOf("\n\n")!=-1){e=d.indexOf("\n\n");b=1}var f=d.indexOf("-----END");if(e!=-1&&f!=-1){var h=d.substring(e+b*2,f-b);h=h.replace(/\s+/g,"");c.data=h}return c};var w=function(e,i,f){var G=f.substring(0,16);var b=CryptoJS.enc.Hex.parse(G);var d=CryptoJS.enc.Utf8.parse(i);var H=y[e]["keylen"]+y[e]["ivlen"];var j="";var m=null;for(;;){var c=CryptoJS.algo.MD5.create();if(m!=null){c.update(m)}c.update(d);c.update(b);m=c.finalize();j=j+CryptoJS.enc.Hex.stringify(m);if(j.length>=H*2){break}}var h={};h.keyhex=j.substr(0,y[e]["keylen"]*2);h.ivhex=j.substr(y[e]["keylen"]*2,y[e]["ivlen"]*2);return h};var F=function(j,c,h,b){var f=CryptoJS.enc.Base64.parse(j);var i=CryptoJS.enc.Hex.stringify(f);var d=y[c]["proc"];var e=d(i,h,b);return e};var A=function(h,d,f,b){var e=y[d]["eproc"];var c=e(h,f,b);return c};return{version:"1.0.5",getHexFromPEM:function(e,b){var d=e;if(d.indexOf("BEGIN "+b)==-1){throw"can't find PEM header: "+b}d=d.replace("-----BEGIN "+b+"-----","");d=d.replace("-----END "+b+"-----","");var c=d.replace(/\s+/g,"");var f=b64tohex(c);return f},getDecryptedKeyHexByKeyIV:function(e,b,c,d){var f=E(b);return f(e,c,d)},parsePKCS5PEM:function(b){return o(b)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(c,d,b){return w(c,d,b)
},decryptKeyB64:function(e,c,d,b){return F(e,c,d,b)},getDecryptedKeyHex:function(h,i){var e=o(h);var b=e.type;var d=e.cipher;var f=e.ivsalt;var c=e.data;var j=w(d,i,f);var m=j.keyhex;var G=F(c,d,m,f);return G},getRSAKeyFromEncryptedPKCS5PEM:function(c,d){var b=this.getDecryptedKeyHex(c,d);var e=new RSAKey();e.readPrivateKeyFromASN1HexString(b);return e},getEryptedPKCS5PEMFromPrvKeyHex:function(c,h,b,d){var f="";if(typeof b=="undefined"||b==null){b="AES-256-CBC"}if(typeof y[b]=="undefined"){throw"PKCS5PKEY unsupported algorithm: "+b}if(typeof d=="undefined"||d==null){var G=y[b]["ivlen"];var H=r(G);d=H.toUpperCase()}var i=w(b,h,d);var j=i.keyhex;var m=A(c,b,j,d);var e=m.replace(/(.{64})/g,"$1\r\n");var f="-----BEGIN RSA PRIVATE KEY-----\r\n";f+="Proc-Type: 4,ENCRYPTED\r\n";f+="DEK-Info: "+b+","+d+"\r\n";f+="\r\n";f+=e;f+="\r\n-----END RSA PRIVATE KEY-----\r\n";return f},getEryptedPKCS5PEMFromRSAKey:function(d,c,f,L){var h=new KJUR.asn1.DERInteger({"int":0});var H=new KJUR.asn1.DERInteger({bigint:d.n});var i=new KJUR.asn1.DERInteger({"int":d.e});var e=new KJUR.asn1.DERInteger({bigint:d.d});var J=new KJUR.asn1.DERInteger({bigint:d.p});var b=new KJUR.asn1.DERInteger({bigint:d.q});var j=new KJUR.asn1.DERInteger({bigint:d.dmp1});var I=new KJUR.asn1.DERInteger({bigint:d.dmq1});var m=new KJUR.asn1.DERInteger({bigint:d.coeff});var K=new KJUR.asn1.DERSequence({array:[h,H,i,e,J,b,j,I,m]});var G=K.getEncodedHex();return this.getEryptedPKCS5PEMFromPrvKeyHex(G,c,f,L)},newEncryptedPKCS5PEM:function(h,f,c,b){if(typeof f=="undefined"||f==null){f=1024}if(typeof c=="undefined"||c==null){c="10001"}var e=new RSAKey();e.generate(f,c);var d=null;if(typeof b=="undefined"||b==null){d=this.getEncryptedPKCS5PEMFromRSAKey(pkey,h)}else{d=this.getEncryptedPKCS5PEMFromRSAKey(pkey,h,b)}return d},getRSAKeyFromPlainPKCS8PEM:function(b){if(b.match(/ENCRYPTED/)){throw"pem shall be not ENCRYPTED"}var c=this.getHexFromPEM(b,"PRIVATE KEY");var d=this.getRSAKeyFromPlainPKCS8Hex(c);return d},getRSAKeyFromPlainPKCS8Hex:function(d){var e=ASN1HEX.getPosArrayOfChildren_AtObj(d,0);if(e.length!=3){throw"outer DERSequence shall have 3 elements: "+e.length}var f=ASN1HEX.getHexOfTLV_AtObj(d,e[1]);if(f!="300d06092a864886f70d0101010500"){throw"PKCS8 AlgorithmIdentifier is not rsaEnc: "+f}var f=ASN1HEX.getHexOfTLV_AtObj(d,e[1]);var c=ASN1HEX.getHexOfTLV_AtObj(d,e[2]);var b=ASN1HEX.getHexOfV_AtObj(c,0);var h=new RSAKey();h.readPrivateKeyFromASN1HexString(b);return h},parseHexOfEncryptedPKCS8:function(j){var c={};var d=ASN1HEX.getPosArrayOfChildren_AtObj(j,0);if(d.length!=2){throw"malformed format: SEQUENCE(0).items != 2: "+d.length}c.ciphertext=ASN1HEX.getHexOfV_AtObj(j,d[1]);var h=ASN1HEX.getPosArrayOfChildren_AtObj(j,d[0]);if(h.length!=2){throw"malformed format: SEQUENCE(0.0).items != 2: "+h.length}if(ASN1HEX.getHexOfV_AtObj(j,h[0])!="2a864886f70d01050d"){throw"this only supports pkcs5PBES2"}var f=ASN1HEX.getPosArrayOfChildren_AtObj(j,h[1]);if(h.length!=2){throw"malformed format: SEQUENCE(0.0.1).items != 2: "+f.length}var e=ASN1HEX.getPosArrayOfChildren_AtObj(j,f[1]);if(e.length!=2){throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+e.length}if(ASN1HEX.getHexOfV_AtObj(j,e[0])!="2a864886f70d0307"){throw"this only supports TripleDES"}c.encryptionSchemeAlg="TripleDES";c.encryptionSchemeIV=ASN1HEX.getHexOfV_AtObj(j,e[1]);var b=ASN1HEX.getPosArrayOfChildren_AtObj(j,f[0]);if(b.length!=2){throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+b.length}if(ASN1HEX.getHexOfV_AtObj(j,b[0])!="2a864886f70d01050c"){throw"this only supports pkcs5PBKDF2"}var i=ASN1HEX.getPosArrayOfChildren_AtObj(j,b[1]);if(i.length<2){throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+i.length}c.pbkdf2Salt=ASN1HEX.getHexOfV_AtObj(j,i[0]);var G=ASN1HEX.getHexOfV_AtObj(j,i[1]);try{c.pbkdf2Iter=parseInt(G,16)}catch(m){throw"malformed format pbkdf2Iter: "+G}return c},getPBKDF2KeyHexFromParam:function(b,h){var c=CryptoJS.enc.Hex.parse(b.pbkdf2Salt);var f=b.pbkdf2Iter;var d=CryptoJS.PBKDF2(h,c,{keySize:192/32,iterations:f});
var e=CryptoJS.enc.Hex.stringify(d);return e},getPlainPKCS8HexFromEncryptedPKCS8PEM:function(i,h){var d=this.getHexFromPEM(i,"ENCRYPTED PRIVATE KEY");var f=this.parseHexOfEncryptedPKCS8(d);var G=PKCS5PKEY.getPBKDF2KeyHexFromParam(f,h);var m={};m.ciphertext=CryptoJS.enc.Hex.parse(f.ciphertext);var b=CryptoJS.enc.Hex.parse(G);var c=CryptoJS.enc.Hex.parse(f.encryptionSchemeIV);var j=CryptoJS.TripleDES.decrypt(m,b,{iv:c});var e=CryptoJS.enc.Hex.stringify(j);return e},getRSAKeyFromEncryptedPKCS8PEM:function(b,c){var d=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(b,c);var e=this.getRSAKeyFromPlainPKCS8Hex(d);return e},getKeyFromEncryptedPKCS8PEM:function(b,d){var e=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(b,d);var c=this.getKeyFromPlainPrivatePKCS8Hex(e);return c},parsePlainPrivatePKCS8Hex:function(b){var d={};d.algparam=null;if(b.substr(0,2)!="30"){throw"malformed plain PKCS8 private key(code:001)"}var c=ASN1HEX.getPosArrayOfChildren_AtObj(b,0);if(c.length!=3){throw"malformed plain PKCS8 private key(code:002)"}if(b.substr(c[1],2)!="30"){throw"malformed PKCS8 private key(code:003)"}var e=ASN1HEX.getPosArrayOfChildren_AtObj(b,c[1]);if(e.length!=2){throw"malformed PKCS8 private key(code:004)"}if(b.substr(e[0],2)!="06"){throw"malformed PKCS8 private key(code:005)"}d.algoid=ASN1HEX.getHexOfV_AtObj(b,e[0]);if(b.substr(e[1],2)=="06"){d.algparam=ASN1HEX.getHexOfV_AtObj(b,e[1])}if(b.substr(c[2],2)!="04"){throw"malformed PKCS8 private key(code:006)"}d.keyidx=ASN1HEX.getStartPosOfV_AtObj(b,c[2]);return d},getKeyFromPlainPrivatePKCS8PEM:function(c){var d=this.getHexFromPEM(c,"PRIVATE KEY");var b=this.getKeyFromPlainPrivatePKCS8Hex(d);return b},getKeyFromPlainPrivatePKCS8Hex:function(f){var d=this.parsePlainPrivatePKCS8Hex(f);if(d.algoid=="2a864886f70d010101"){this.parsePrivateRawRSAKeyHexAtObj(f,d);var e=d.key;var c=new RSAKey();c.setPrivateEx(e.n,e.e,e.d,e.p,e.q,e.dp,e.dq,e.co);return c}else{if(d.algoid=="2a8648ce3d0201"){this.parsePrivateRawECKeyHexAtObj(f,d);if(KJUR.crypto.OID.oidhex2name[d.algparam]===undefined){throw"KJUR.crypto.OID.oidhex2name undefined: "+d.algparam}var b=KJUR.crypto.OID.oidhex2name[d.algparam];var c=new KJUR.crypto.ECDSA({curve:b,prv:d.key});return c}else{throw"unsupported private key algorithm"}}},getRSAKeyFromPublicPKCS8PEM:function(c){var b=this.getHexFromPEM(c,"PUBLIC KEY");var d=this.getRSAKeyFromPublicPKCS8Hex(b);return d},getKeyFromPublicPKCS8PEM:function(c){var b=this.getHexFromPEM(c,"PUBLIC KEY");var d=this.getKeyFromPublicPKCS8Hex(b);return d},getKeyFromPublicPKCS8Hex:function(e){var f=this.parsePublicPKCS8Hex(e);if(f.algoid=="2a864886f70d010101"){var b=this.parsePublicRawRSAKeyHex(f.key);var d=new RSAKey();d.setPublic(b.n,b.e);return d}else{if(f.algoid=="2a8648ce3d0201"){if(KJUR.crypto.OID.oidhex2name[f.algparam]===undefined){throw"KJUR.crypto.OID.oidhex2name undefined: "+f.algparam}var c=KJUR.crypto.OID.oidhex2name[f.algparam];var d=new KJUR.crypto.ECDSA({curve:c,pub:f.key});return d}else{throw"unsupported public key algorithm"}}},parsePublicRawRSAKeyHex:function(b){var d={};if(b.substr(0,2)!="30"){throw"malformed RSA key(code:001)"}var c=ASN1HEX.getPosArrayOfChildren_AtObj(b,0);if(c.length!=2){throw"malformed RSA key(code:002)"}if(b.substr(c[0],2)!="02"){throw"malformed RSA key(code:003)"}d.n=ASN1HEX.getHexOfV_AtObj(b,c[0]);if(b.substr(c[1],2)!="02"){throw"malformed RSA key(code:004)"}d.e=ASN1HEX.getHexOfV_AtObj(b,c[1]);return d},parsePrivateRawRSAKeyHexAtObj:function(d,b){var c=b.keyidx;if(d.substr(c,2)!="30"){throw"malformed RSA private key(code:001)"}var e=ASN1HEX.getPosArrayOfChildren_AtObj(d,c);if(e.length!=9){throw"malformed RSA private key(code:002)"}b.key={};b.key.n=ASN1HEX.getHexOfV_AtObj(d,e[1]);b.key.e=ASN1HEX.getHexOfV_AtObj(d,e[2]);b.key.d=ASN1HEX.getHexOfV_AtObj(d,e[3]);b.key.p=ASN1HEX.getHexOfV_AtObj(d,e[4]);b.key.q=ASN1HEX.getHexOfV_AtObj(d,e[5]);b.key.dp=ASN1HEX.getHexOfV_AtObj(d,e[6]);b.key.dq=ASN1HEX.getHexOfV_AtObj(d,e[7]);b.key.co=ASN1HEX.getHexOfV_AtObj(d,e[8])},parsePrivateRawECKeyHexAtObj:function(d,b){var c=b.keyidx;
if(d.substr(c,2)!="30"){throw"malformed ECC private key(code:001)"}var e=ASN1HEX.getPosArrayOfChildren_AtObj(d,c);if(e.length!=3){throw"malformed ECC private key(code:002)"}if(d.substr(e[1],2)!="04"){throw"malformed ECC private key(code:003)"}b.key=ASN1HEX.getHexOfV_AtObj(d,e[1])},parsePublicPKCS8Hex:function(c){var e={};e.algparam=null;var d=ASN1HEX.getPosArrayOfChildren_AtObj(c,0);if(d.length!=2){throw"outer DERSequence shall have 2 elements: "+d.length}var b=d[0];if(c.substr(b,2)!="30"){throw"malformed PKCS8 public key(code:001)"}var f=ASN1HEX.getPosArrayOfChildren_AtObj(c,b);if(f.length!=2){throw"malformed PKCS8 public key(code:002)"}if(c.substr(f[0],2)!="06"){throw"malformed PKCS8 public key(code:003)"}e.algoid=ASN1HEX.getHexOfV_AtObj(c,f[0]);if(c.substr(f[1],2)=="06"){e.algparam=ASN1HEX.getHexOfV_AtObj(c,f[1])}if(c.substr(d[1],2)!="03"){throw"malformed PKCS8 public key(code:004)"}e.key=ASN1HEX.getHexOfV_AtObj(c,d[1]).substr(2);return e},getRSAKeyFromPublicPKCS8Hex:function(e){var f=ASN1HEX.getPosArrayOfChildren_AtObj(e,0);if(f.length!=2){throw"outer DERSequence shall have 2 elements: "+f.length}var h=ASN1HEX.getHexOfTLV_AtObj(e,f[0]);if(h!="300d06092a864886f70d0101010500"){throw"PKCS8 AlgorithmId is not rsaEncryption"}if(e.substr(f[1],2)!="03"){throw"PKCS8 Public Key is not BITSTRING encapslated."}var c=ASN1HEX.getStartPosOfV_AtObj(e,f[1])+2;if(e.substr(c,2)!="30"){throw"PKCS8 Public Key is not SEQUENCE."}var j=ASN1HEX.getPosArrayOfChildren_AtObj(e,c);if(j.length!=2){throw"inner DERSequence shall have 2 elements: "+j.length}if(e.substr(j[0],2)!="02"){throw"N is not ASN.1 INTEGER"}if(e.substr(j[1],2)!="02"){throw"E is not ASN.1 INTEGER"}var b=ASN1HEX.getHexOfV_AtObj(e,j[0]);var d=ASN1HEX.getHexOfV_AtObj(e,j[1]);var i=new RSAKey();i.setPublic(b,d);return i}}}();
;var KEYUTIL=function(){var G=function(d,b,c){return y(CryptoJS.AES,d,b,c)};var F=function(d,b,c){return y(CryptoJS.TripleDES,d,b,c)};var J=function(d,b,c){return y(CryptoJS.DES,d,b,c)};var y=function(m,e,i,c){var b=CryptoJS.enc.Hex.parse(e);var f=CryptoJS.enc.Hex.parse(i);var d=CryptoJS.enc.Hex.parse(c);var j={};j.key=f;j.iv=d;j.ciphertext=b;var h=m.decrypt(j,f,{iv:d});return CryptoJS.enc.Hex.stringify(h)};var w=function(d,b,c){return D(CryptoJS.AES,d,b,c)};var r=function(d,b,c){return D(CryptoJS.TripleDES,d,b,c)};var E=function(d,b,c){return D(CryptoJS.DES,d,b,c)};var D=function(m,e,i,c){var n=CryptoJS.enc.Hex.parse(e);var f=CryptoJS.enc.Hex.parse(i);var d=CryptoJS.enc.Hex.parse(c);var h=m.encrypt(n,f,{iv:d});var b=CryptoJS.enc.Hex.parse(h.toString());var j=CryptoJS.enc.Base64.stringify(b);return j};var B={"AES-256-CBC":{proc:G,eproc:w,keylen:32,ivlen:16},"AES-192-CBC":{proc:G,eproc:w,keylen:24,ivlen:16},"AES-128-CBC":{proc:G,eproc:w,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:F,eproc:r,keylen:24,ivlen:8},"DES-CBC":{proc:J,eproc:E,keylen:8,ivlen:8}};var H=function(b){return B[b]["proc"]};var v=function(d){var b=CryptoJS.lib.WordArray.random(d);var c=CryptoJS.enc.Hex.stringify(b);return c};var u=function(d){var c={};if(d.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"))){c.cipher=RegExp.$1;c.ivsalt=RegExp.$2}if(d.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"))){c.type=RegExp.$1}var e=-1;var b=0;if(d.indexOf("\r\n\r\n")!=-1){e=d.indexOf("\r\n\r\n");b=2}if(d.indexOf("\n\n")!=-1){e=d.indexOf("\n\n");b=1}var f=d.indexOf("-----END");if(e!=-1&&f!=-1){var h=d.substring(e+b*2,f-b);h=h.replace(/\s+/g,"");c.data=h}return c};var A=function(c,f,d){var j=d.substring(0,16);var n=CryptoJS.enc.Hex.parse(j);var b=CryptoJS.enc.Utf8.parse(f);var m=B[c]["keylen"]+B[c]["ivlen"];var h="";var i=null;for(;;){var o=CryptoJS.algo.MD5.create();if(i!=null){o.update(i)}o.update(b);o.update(n);i=o.finalize();h=h+CryptoJS.enc.Hex.stringify(i);if(h.length>=m*2){break}}var e={};e.keyhex=h.substr(0,B[c]["keylen"]*2);e.ivhex=h.substr(B[c]["keylen"]*2,B[c]["ivlen"]*2);return e};var I=function(j,c,h,b){var f=CryptoJS.enc.Base64.parse(j);
var i=CryptoJS.enc.Hex.stringify(f);var d=B[c]["proc"];var e=d(i,h,b);return e};var C=function(h,d,f,b){var e=B[d]["eproc"];var c=e(h,f,b);return c};return{version:"1.0.0",getHexFromPEM:function(e,b){var d=e;if(d.indexOf("BEGIN "+b)==-1){throw"can't find PEM header: "+b}d=d.replace("-----BEGIN "+b+"-----","");d=d.replace("-----END "+b+"-----","");var c=d.replace(/\s+/g,"");var f=b64tohex(c);return f},getDecryptedKeyHexByKeyIV:function(e,b,c,d){var f=H(b);return f(e,c,d)},parsePKCS5PEM:function(b){return u(b)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(c,d,b){return A(c,d,b)},decryptKeyB64:function(e,c,d,b){return I(e,c,d,b)},getDecryptedKeyHex:function(e,f){var c=u(e);var m=c.type;var b=c.cipher;var d=c.ivsalt;var n=c.data;var h=A(b,f,d);var i=h.keyhex;var j=I(n,b,i,d);return j},getRSAKeyFromEncryptedPKCS5PEM:function(c,d){var b=this.getDecryptedKeyHex(c,d);var e=new RSAKey();e.readPrivateKeyFromASN1HexString(b);return e},getEncryptedPKCS5PEMFromPrvKeyHex:function(i,K,e,o,b){var d="";if(typeof o=="undefined"||o==null){o="AES-256-CBC"}if(typeof B[o]=="undefined"){throw"KEYUTIL unsupported algorithm: "+o}if(typeof b=="undefined"||b==null){var m=B[o]["ivlen"];var n=v(m);b=n.toUpperCase()}var f=A(o,e,b);var h=f.keyhex;var j=C(K,o,h,b);var c=j.replace(/(.{64})/g,"$1\r\n");var d="-----BEGIN "+i+" PRIVATE KEY-----\r\n";d+="Proc-Type: 4,ENCRYPTED\r\n";d+="DEK-Info: "+o+","+b+"\r\n";d+="\r\n";d+=c;d+="\r\n-----END "+i+" PRIVATE KEY-----\r\n";return d},getEncryptedPKCS5PEMFromRSAKey:function(b,N,c,L){var e=new KJUR.asn1.DERInteger({"int":0});var m=new KJUR.asn1.DERInteger({bigint:b.n});var f=new KJUR.asn1.DERInteger({"int":b.e});var d=new KJUR.asn1.DERInteger({bigint:b.d});var o=new KJUR.asn1.DERInteger({bigint:b.p});var M=new KJUR.asn1.DERInteger({bigint:b.q});var h=new KJUR.asn1.DERInteger({bigint:b.dmp1});var n=new KJUR.asn1.DERInteger({bigint:b.dmq1});var i=new KJUR.asn1.DERInteger({bigint:b.coeff});var K=new KJUR.asn1.DERSequence({array:[e,m,f,d,o,M,h,n,i]});var j=K.getEncodedHex();return this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",j,N,c,L)},newEncryptedPKCS5PEM:function(h,f,c,b){if(typeof f=="undefined"||f==null){f=1024}if(typeof c=="undefined"||c==null){c="10001"}var e=new RSAKey();e.generate(f,c);var d=null;if(typeof b=="undefined"||b==null){d=this.getEncryptedPKCS5PEMFromRSAKey(e,h)}else{d=this.getEncryptedPKCS5PEMFromRSAKey(e,h,b)}return d},getRSAKeyFromPlainPKCS8PEM:function(b){if(b.match(/ENCRYPTED/)){throw"pem shall be not ENCRYPTED"}var c=this.getHexFromPEM(b,"PRIVATE KEY");var d=this.getRSAKeyFromPlainPKCS8Hex(c);return d},getRSAKeyFromPlainPKCS8Hex:function(d){var e=ASN1HEX.getPosArrayOfChildren_AtObj(d,0);if(e.length!=3){throw"outer DERSequence shall have 3 elements: "+e.length}var f=ASN1HEX.getHexOfTLV_AtObj(d,e[1]);if(f!="300d06092a864886f70d0101010500"){throw"PKCS8 AlgorithmIdentifier is not rsaEnc: "+f}var f=ASN1HEX.getHexOfTLV_AtObj(d,e[1]);var c=ASN1HEX.getHexOfTLV_AtObj(d,e[2]);var b=ASN1HEX.getHexOfV_AtObj(c,0);var h=new RSAKey();h.readPrivateKeyFromASN1HexString(b);return h},parseHexOfEncryptedPKCS8:function(h){var n={};var b=ASN1HEX.getPosArrayOfChildren_AtObj(h,0);if(b.length!=2){throw"malformed format: SEQUENCE(0).items != 2: "+b.length}n.ciphertext=ASN1HEX.getHexOfV_AtObj(h,b[1]);var e=ASN1HEX.getPosArrayOfChildren_AtObj(h,b[0]);if(e.length!=2){throw"malformed format: SEQUENCE(0.0).items != 2: "+e.length}if(ASN1HEX.getHexOfV_AtObj(h,e[0])!="2a864886f70d01050d"){throw"this only supports pkcs5PBES2"}var d=ASN1HEX.getPosArrayOfChildren_AtObj(h,e[1]);if(e.length!=2){throw"malformed format: SEQUENCE(0.0.1).items != 2: "+d.length}var c=ASN1HEX.getPosArrayOfChildren_AtObj(h,d[1]);if(c.length!=2){throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+c.length}if(ASN1HEX.getHexOfV_AtObj(h,c[0])!="2a864886f70d0307"){throw"this only supports TripleDES"}n.encryptionSchemeAlg="TripleDES";n.encryptionSchemeIV=ASN1HEX.getHexOfV_AtObj(h,c[1]);var m=ASN1HEX.getPosArrayOfChildren_AtObj(h,d[0]);if(m.length!=2){throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+m.length
}if(ASN1HEX.getHexOfV_AtObj(h,m[0])!="2a864886f70d01050c"){throw"this only supports pkcs5PBKDF2"}var f=ASN1HEX.getPosArrayOfChildren_AtObj(h,m[1]);if(f.length<2){throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+f.length}n.pbkdf2Salt=ASN1HEX.getHexOfV_AtObj(h,f[0]);var j=ASN1HEX.getHexOfV_AtObj(h,f[1]);try{n.pbkdf2Iter=parseInt(j,16)}catch(i){throw"malformed format pbkdf2Iter: "+j}return n},getPBKDF2KeyHexFromParam:function(b,h){var c=CryptoJS.enc.Hex.parse(b.pbkdf2Salt);var f=b.pbkdf2Iter;var d=CryptoJS.PBKDF2(h,c,{keySize:192/32,iterations:f});var e=CryptoJS.enc.Hex.stringify(d);return e},getPlainPKCS8HexFromEncryptedPKCS8PEM:function(f,e){var b=this.getHexFromPEM(f,"ENCRYPTED PRIVATE KEY");var d=this.parseHexOfEncryptedPKCS8(b);var j=KEYUTIL.getPBKDF2KeyHexFromParam(d,e);var i={};i.ciphertext=CryptoJS.enc.Hex.parse(d.ciphertext);var m=CryptoJS.enc.Hex.parse(j);var n=CryptoJS.enc.Hex.parse(d.encryptionSchemeIV);var h=CryptoJS.TripleDES.decrypt(i,m,{iv:n});var c=CryptoJS.enc.Hex.stringify(h);return c},getRSAKeyFromEncryptedPKCS8PEM:function(b,c){var d=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(b,c);var e=this.getRSAKeyFromPlainPKCS8Hex(d);return e},getKeyFromEncryptedPKCS8PEM:function(b,d){var e=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(b,d);var c=this.getKeyFromPlainPrivatePKCS8Hex(e);return c},parsePlainPrivatePKCS8Hex:function(b){var d={};d.algparam=null;if(b.substr(0,2)!="30"){throw"malformed plain PKCS8 private key(code:001)"}var c=ASN1HEX.getPosArrayOfChildren_AtObj(b,0);if(c.length!=3){throw"malformed plain PKCS8 private key(code:002)"}if(b.substr(c[1],2)!="30"){throw"malformed PKCS8 private key(code:003)"}var e=ASN1HEX.getPosArrayOfChildren_AtObj(b,c[1]);if(e.length!=2){throw"malformed PKCS8 private key(code:004)"}if(b.substr(e[0],2)!="06"){throw"malformed PKCS8 private key(code:005)"}d.algoid=ASN1HEX.getHexOfV_AtObj(b,e[0]);if(b.substr(e[1],2)=="06"){d.algparam=ASN1HEX.getHexOfV_AtObj(b,e[1])}if(b.substr(c[2],2)!="04"){throw"malformed PKCS8 private key(code:006)"}d.keyidx=ASN1HEX.getStartPosOfV_AtObj(b,c[2]);return d},getKeyFromPlainPrivatePKCS8PEM:function(c){var d=this.getHexFromPEM(c,"PRIVATE KEY");var b=this.getKeyFromPlainPrivatePKCS8Hex(d);return b},getKeyFromPlainPrivatePKCS8Hex:function(e){var m=this.parsePlainPrivatePKCS8Hex(e);if(m.algoid=="2a864886f70d010101"){this.parsePrivateRawRSAKeyHexAtObj(e,m);var o=m.key;var h=new RSAKey();h.setPrivateEx(o.n,o.e,o.d,o.p,o.q,o.dp,o.dq,o.co);return h}else{if(m.algoid=="2a8648ce3d0201"){this.parsePrivateRawECKeyHexAtObj(e,m);if(KJUR.crypto.OID.oidhex2name[m.algparam]===undefined){throw"KJUR.crypto.OID.oidhex2name undefined: "+m.algparam}var n=KJUR.crypto.OID.oidhex2name[m.algparam];var h=new KJUR.crypto.ECDSA({curve:n});h.setPublicKeyHex(m.pubkey);h.setPrivateKeyHex(m.key);h.isPublic=false;return h}else{if(m.algoid=="2a8648ce380401"){var K=ASN1HEX.getVbyList(e,0,[1,1,0],"02");var L=ASN1HEX.getVbyList(e,0,[1,1,1],"02");var i=ASN1HEX.getVbyList(e,0,[1,1,2],"02");var d=ASN1HEX.getVbyList(e,0,[2,0],"02");var b=new BigInteger(K,16);var c=new BigInteger(L,16);var j=new BigInteger(i,16);var f=new BigInteger(d,16);var h=new KJUR.crypto.DSA();h.setPrivate(b,c,j,null,f);return h}else{throw"unsupported private key algorithm"}}}},getRSAKeyFromPublicPKCS8PEM:function(c){var b=this.getHexFromPEM(c,"PUBLIC KEY");var d=this.getRSAKeyFromPublicPKCS8Hex(b);return d},getKeyFromPublicPKCS8PEM:function(c){var b=this.getHexFromPEM(c,"PUBLIC KEY");var d=this.getKeyFromPublicPKCS8Hex(b);return d},getKeyFromPublicPKCS8Hex:function(h){var i=this.parsePublicPKCS8Hex(h);if(i.algoid=="2a864886f70d010101"){var c=this.parsePublicRawRSAKeyHex(i.key);var f=new RSAKey();f.setPublic(c.n,c.e);return f}else{if(i.algoid=="2a8648ce3d0201"){if(KJUR.crypto.OID.oidhex2name[i.algparam]===undefined){throw"KJUR.crypto.OID.oidhex2name undefined: "+i.algparam}var e=KJUR.crypto.OID.oidhex2name[i.algparam];var f=new KJUR.crypto.ECDSA({curve:e,pub:i.key});return f}else{if(i.algoid=="2a8648ce380401"){var d=i.algparam;
var b=ASN1HEX.getHexOfV_AtObj(i.key,0);var f=new KJUR.crypto.DSA();f.setPublic(new BigInteger(d.p,16),new BigInteger(d.q,16),new BigInteger(d.g,16),new BigInteger(b,16));return f}else{throw"unsupported public key algorithm"}}}},parsePublicRawRSAKeyHex:function(b){var d={};if(b.substr(0,2)!="30"){throw"malformed RSA key(code:001)"}var c=ASN1HEX.getPosArrayOfChildren_AtObj(b,0);if(c.length!=2){throw"malformed RSA key(code:002)"}if(b.substr(c[0],2)!="02"){throw"malformed RSA key(code:003)"}d.n=ASN1HEX.getHexOfV_AtObj(b,c[0]);if(b.substr(c[1],2)!="02"){throw"malformed RSA key(code:004)"}d.e=ASN1HEX.getHexOfV_AtObj(b,c[1]);return d},parsePrivateRawRSAKeyHexAtObj:function(d,b){var c=b.keyidx;if(d.substr(c,2)!="30"){throw"malformed RSA private key(code:001)"}var e=ASN1HEX.getPosArrayOfChildren_AtObj(d,c);if(e.length!=9){throw"malformed RSA private key(code:002)"}b.key={};b.key.n=ASN1HEX.getHexOfV_AtObj(d,e[1]);b.key.e=ASN1HEX.getHexOfV_AtObj(d,e[2]);b.key.d=ASN1HEX.getHexOfV_AtObj(d,e[3]);b.key.p=ASN1HEX.getHexOfV_AtObj(d,e[4]);b.key.q=ASN1HEX.getHexOfV_AtObj(d,e[5]);b.key.dp=ASN1HEX.getHexOfV_AtObj(d,e[6]);b.key.dq=ASN1HEX.getHexOfV_AtObj(d,e[7]);b.key.co=ASN1HEX.getHexOfV_AtObj(d,e[8])},parsePrivateRawECKeyHexAtObj:function(f,b){var e=b.keyidx;var d=ASN1HEX.getVbyList(f,e,[1],"04");var c=ASN1HEX.getVbyList(f,e,[2,0],"03").substr(2);b.key=d;b.pubkey=c},parsePublicPKCS8Hex:function(c){var e={};e.algparam=null;var d=ASN1HEX.getPosArrayOfChildren_AtObj(c,0);if(d.length!=2){throw"outer DERSequence shall have 2 elements: "+d.length}var b=d[0];if(c.substr(b,2)!="30"){throw"malformed PKCS8 public key(code:001)"}var f=ASN1HEX.getPosArrayOfChildren_AtObj(c,b);if(f.length!=2){throw"malformed PKCS8 public key(code:002)"}if(c.substr(f[0],2)!="06"){throw"malformed PKCS8 public key(code:003)"}e.algoid=ASN1HEX.getHexOfV_AtObj(c,f[0]);if(c.substr(f[1],2)=="06"){e.algparam=ASN1HEX.getHexOfV_AtObj(c,f[1])}else{if(c.substr(f[1],2)=="30"){e.algparam={};e.algparam.p=ASN1HEX.getVbyList(c,f[1],[0],"02");e.algparam.q=ASN1HEX.getVbyList(c,f[1],[1],"02");e.algparam.g=ASN1HEX.getVbyList(c,f[1],[2],"02")}}if(c.substr(d[1],2)!="03"){throw"malformed PKCS8 public key(code:004)"}e.key=ASN1HEX.getHexOfV_AtObj(c,d[1]).substr(2);return e},getRSAKeyFromPublicPKCS8Hex:function(e){var f=ASN1HEX.getPosArrayOfChildren_AtObj(e,0);if(f.length!=2){throw"outer DERSequence shall have 2 elements: "+f.length}var h=ASN1HEX.getHexOfTLV_AtObj(e,f[0]);if(h!="300d06092a864886f70d0101010500"){throw"PKCS8 AlgorithmId is not rsaEncryption"}if(e.substr(f[1],2)!="03"){throw"PKCS8 Public Key is not BITSTRING encapslated."}var c=ASN1HEX.getStartPosOfV_AtObj(e,f[1])+2;if(e.substr(c,2)!="30"){throw"PKCS8 Public Key is not SEQUENCE."}var j=ASN1HEX.getPosArrayOfChildren_AtObj(e,c);if(j.length!=2){throw"inner DERSequence shall have 2 elements: "+j.length}if(e.substr(j[0],2)!="02"){throw"N is not ASN.1 INTEGER"}if(e.substr(j[1],2)!="02"){throw"E is not ASN.1 INTEGER"}var b=ASN1HEX.getHexOfV_AtObj(e,j[0]);var d=ASN1HEX.getHexOfV_AtObj(e,j[1]);var i=new RSAKey();i.setPublic(b,d);return i}}}();KEYUTIL.getKey=function(G,r,B){if(typeof RSAKey!="undefined"&&G instanceof RSAKey){return G}if(typeof KJUR.crypto.ECDSA!="undefined"&&G instanceof KJUR.crypto.ECDSA){return G}if(typeof KJUR.crypto.DSA!="undefined"&&G instanceof KJUR.crypto.DSA){return G}if(G.xy!==undefined&&G.curve!==undefined){return new KJUR.crypto.ECDSA({prv:G.xy,curve:G.curve})}if(G.n!==undefined&&G.e!==undefined&&G.d!==undefined&&G.p!==undefined&&G.q!==undefined&&G.dp!==undefined&&G.dq!==undefined&&G.co!==undefined){var u=new RSAKey();u.setPrivateEx(G.n,G.e,G.d,G.p,G.q,G.dp,G.dq,G.co);return u}if(G.p!==undefined&&G.q!==undefined&&G.g!==undefined&&G.y!==undefined&&G.x!==undefined){var u=new KJUR.crypto.DSA();u.setPrivate(G.p,G.q,G.g,G.y,G.x);return u}if(G.d!==undefined&&G.curve!==undefined){return new KJUR.crypto.ECDSA({pub:G.d,curve:G.curve})}if(G.n!==undefined&&G.e){var u=new RSAKey();u.setPublic(G.n,G.e);return u}if(G.p!==undefined&&G.q!==undefined&&G.g!==undefined&&G.y!==undefined&&G.x===undefined){var u=new KJUR.crypto.DSA();
u.setPublic(G.p,G.q,G.g,G.y);return u}if(G.indexOf("-END CERTIFICATE-",0)!=-1||G.indexOf("-END X509 CERTIFICATE-",0)!=-1||G.indexOf("-END TRUSTED CERTIFICATE-",0)!=-1){return X509.getPublicKeyFromCertPEM(G)}if(B==="pkcs8pub"){return KEYUTIL.getKeyFromPublicPKCS8Hex(G)}if(G.indexOf("-END PUBLIC KEY-")!=-1){return KEYUTIL.getKeyFromPublicPKCS8PEM(G)}if(B==="pkcs5prv"){var u=new RSAKey();u.readPrivateKeyFromASN1HexString(G);return u}if(B==="pkcs5prv"){var u=new RSAKey();u.readPrivateKeyFromASN1HexString(G);return u}if(G.indexOf("-END RSA PRIVATE KEY-")!=-1&&G.indexOf("4,ENCRYPTED")==-1){var u=new RSAKey();u.readPrivateKeyFromPEMString(G);return u}if(G.indexOf("-END DSA PRIVATE KEY-")!=-1&&G.indexOf("4,ENCRYPTED")==-1){var v=this.getHexFromPEM(G,"DSA PRIVATE KEY");var H=ASN1HEX.getVbyList(v,0,[1],"02");var I=ASN1HEX.getVbyList(v,0,[2],"02");var E=ASN1HEX.getVbyList(v,0,[3],"02");var y=ASN1HEX.getVbyList(v,0,[4],"02");var w=ASN1HEX.getVbyList(v,0,[5],"02");var u=new KJUR.crypto.DSA();u.setPrivate(new BigInteger(H,16),new BigInteger(I,16),new BigInteger(E,16),new BigInteger(y,16),new BigInteger(w,16));return u}if(G.indexOf("-END PRIVATE KEY-")!=-1){return KEYUTIL.getKeyFromPlainPrivatePKCS8PEM(G)}if(G.indexOf("-END RSA PRIVATE KEY-")!=-1&&G.indexOf("4,ENCRYPTED")!=-1){return KEYUTIL.getRSAKeyFromEncryptedPKCS5PEM(G,r)}if(G.indexOf("-END EC PRIVATE KEY-")!=-1&&G.indexOf("4,ENCRYPTED")!=-1){var v=KEYUTIL.getDecryptedKeyHex(G,r);var u=ASN1HEX.getVbyList(v,0,[1],"04");var A=ASN1HEX.getVbyList(v,0,[2,0],"06");var F=ASN1HEX.getVbyList(v,0,[3,0],"03").substr(2);var C="";if(KJUR.crypto.OID.oidhex2name[A]!==undefined){C=KJUR.crypto.OID.oidhex2name[A]}else{throw"undefined OID(hex) in KJUR.crypto.OID: "+A}var D=new KJUR.crypto.ECDSA({name:C});D.setPublicKeyHex(F);D.setPrivateKeyHex(u);D.isPublic=false;return D}if(G.indexOf("-END DSA PRIVATE KEY-")!=-1&&G.indexOf("4,ENCRYPTED")!=-1){var v=KEYUTIL.getDecryptedKeyHex(G,r);var H=ASN1HEX.getVbyList(v,0,[1],"02");var I=ASN1HEX.getVbyList(v,0,[2],"02");var E=ASN1HEX.getVbyList(v,0,[3],"02");var y=ASN1HEX.getVbyList(v,0,[4],"02");var w=ASN1HEX.getVbyList(v,0,[5],"02");var u=new KJUR.crypto.DSA();u.setPrivate(new BigInteger(H,16),new BigInteger(I,16),new BigInteger(E,16),new BigInteger(y,16),new BigInteger(w,16));return u}if(G.indexOf("-END ENCRYPTED PRIVATE KEY-")!=-1){return KEYUTIL.getKeyFromEncryptedPKCS8PEM(G,r)}throw"not supported argument"};KEYUTIL.generateKeypair=function(C,A){if(C=="RSA"){var B=A;var r=new RSAKey();r.generate(B,"10001");var v=new RSAKey();var w=r.n.toString(16);var o=r.e.toString(16);v.setPublic(w,o);var m={};m.prvKeyObj=r;m.pubKeyObj=v;return m}else{if(C=="EC"){var y=A;var u=new KJUR.crypto.ECDSA({curve:y});var n=u.generateKeyPairHex();var r=new KJUR.crypto.ECDSA({curve:y});r.setPrivateKeyHex(n.ecprvhex);var v=new KJUR.crypto.ECDSA({curve:y});v.setPublicKeyHex(n.ecpubhex);var m={};m.prvKeyObj=r;m.pubKeyObj=v;return m}else{throw"unknown algorithm: "+C}}};KEYUTIL.getPEM=function(S,B,E,M,J){var w=KJUR.asn1;var y=KJUR.crypto;function D(c){var b=KJUR.asn1.ASN1Util.newObject({seq:[{"int":0},{"int":{bigint:c.n}},{"int":c.e},{"int":{bigint:c.d}},{"int":{bigint:c.p}},{"int":{bigint:c.q}},{"int":{bigint:c.dmp1}},{"int":{bigint:c.dmq1}},{"int":{bigint:c.coeff}}]});return b}function C(b){var c=KJUR.asn1.ASN1Util.newObject({seq:[{"int":1},{octstr:{hex:b.prvKeyHex}},{tag:["a0",true,{oid:{name:b.curveName}}]},{tag:["a1",true,{bitstr:{hex:"00"+b.pubKeyHex}}]}]});return c}function F(c){var b=KJUR.asn1.ASN1Util.newObject({seq:[{"int":0},{"int":{bigint:c.p}},{"int":{bigint:c.q}},{"int":{bigint:c.g}},{"int":{bigint:c.y}},{"int":{bigint:c.x}}]});return b}if(((typeof RSAKey!="undefined"&&S instanceof RSAKey)||(typeof y.DSA!="undefined"&&S instanceof y.DSA)||(typeof y.ECDSA!="undefined"&&S instanceof y.ECDSA))&&S.isPublic==true&&(B===undefined||B=="PKCS8PUB")){var A=new KJUR.asn1.x509.SubjectPublicKeyInfo(S);var G=A.getEncodedHex();return w.ASN1Util.getPEMStringFromHex(G,"PUBLIC KEY")}if(B=="PKCS1PRV"&&typeof RSAKey!="undefined"&&S instanceof RSAKey&&(E===undefined||E==null)&&S.isPrivate==true){var A=D(S);
var G=A.getEncodedHex();return w.ASN1Util.getPEMStringFromHex(G,"RSA PRIVATE KEY")}if(B=="PKCS1PRV"&&typeof RSAKey!="undefined"&&S instanceof KJUR.crypto.ECDSA&&(E===undefined||E==null)&&S.isPrivate==true){var N=new KJUR.asn1.DERObjectIdentifier({name:S.curveName});var H=N.getEncodedHex();var O=C(S);var I=O.getEncodedHex();var K="";K+=w.ASN1Util.getPEMStringFromHex(H,"EC PARAMETERS");K+=w.ASN1Util.getPEMStringFromHex(I,"EC PRIVATE KEY");return K}if(B=="PKCS1PRV"&&typeof KJUR.crypto.DSA!="undefined"&&S instanceof KJUR.crypto.DSA&&(E===undefined||E==null)&&S.isPrivate==true){var A=F(S);var G=A.getEncodedHex();return w.ASN1Util.getPEMStringFromHex(G,"DSA PRIVATE KEY")}if(B=="PKCS5PRV"&&typeof RSAKey!="undefined"&&S instanceof RSAKey&&(E!==undefined&&E!=null)&&S.isPrivate==true){var A=D(S);var G=A.getEncodedHex();if(M===undefined){M="DES-EDE3-CBC"}return this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",G,E,M)}if(B=="PKCS5PRV"&&typeof KJUR.crypto.ECDSA!="undefined"&&S instanceof KJUR.crypto.ECDSA&&(E!==undefined&&E!=null)&&S.isPrivate==true){var A=C(S);var G=A.getEncodedHex();if(M===undefined){M="DES-EDE3-CBC"}return this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",G,E,M)}if(B=="PKCS5PRV"&&typeof KJUR.crypto.DSA!="undefined"&&S instanceof KJUR.crypto.DSA&&(E!==undefined&&E!=null)&&S.isPrivate==true){var A=F(S);var G=A.getEncodedHex();if(M===undefined){M="DES-EDE3-CBC"}return this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",G,E,M)}var L=function(c,d){var e=R(c,d);var b=new KJUR.asn1.ASN1Util.newObject({seq:[{seq:[{oid:{name:"pkcs5PBES2"}},{seq:[{seq:[{oid:{name:"pkcs5PBKDF2"}},{seq:[{octstr:{hex:e.pbkdf2Salt}},{"int":e.pbkdf2Iter}]}]},{seq:[{oid:{name:"des-EDE3-CBC"}},{octstr:{hex:e.encryptionSchemeIV}}]}]}]},{octstr:{hex:e.ciphertext}}]});return b.getEncodedHex()};var R=function(b,m){var i=100;var c=CryptoJS.lib.WordArray.random(8);var d="DES-EDE3-CBC";var n=CryptoJS.lib.WordArray.random(8);var h=CryptoJS.PBKDF2(m,c,{keySize:192/32,iterations:i});var f=CryptoJS.enc.Hex.parse(b);var e=CryptoJS.TripleDES.encrypt(f,h,{iv:n})+"";var j={};j.ciphertext=e;j.pbkdf2Salt=CryptoJS.enc.Hex.stringify(c);j.pbkdf2Iter=i;j.encryptionSchemeAlg=d;j.encryptionSchemeIV=CryptoJS.enc.Hex.stringify(n);return j};if(B=="PKCS8PRV"&&typeof RSAKey!="undefined"&&S instanceof RSAKey&&S.isPrivate==true){var P=D(S);var Q=P.getEncodedHex();var A=KJUR.asn1.ASN1Util.newObject({seq:[{"int":0},{seq:[{oid:{name:"rsaEncryption"}},{"null":true}]},{octstr:{hex:Q}}]});var G=A.getEncodedHex();if(E===undefined||E==null){return w.ASN1Util.getPEMStringFromHex(G,"PRIVATE KEY")}else{var I=L(G,E);return w.ASN1Util.getPEMStringFromHex(I,"ENCRYPTED PRIVATE KEY")}}if(B=="PKCS8PRV"&&typeof KJUR.crypto.ECDSA!="undefined"&&S instanceof KJUR.crypto.ECDSA&&S.isPrivate==true){var P=new KJUR.asn1.ASN1Util.newObject({seq:[{"int":1},{octstr:{hex:S.prvKeyHex}},{tag:["a1",true,{bitstr:{hex:"00"+S.pubKeyHex}}]}]});var Q=P.getEncodedHex();var A=KJUR.asn1.ASN1Util.newObject({seq:[{"int":0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:S.curveName}}]},{octstr:{hex:Q}}]});var G=A.getEncodedHex();if(E===undefined||E==null){return w.ASN1Util.getPEMStringFromHex(G,"PRIVATE KEY")}else{var I=L(G,E);return w.ASN1Util.getPEMStringFromHex(I,"ENCRYPTED PRIVATE KEY")}}if(B=="PKCS8PRV"&&typeof KJUR.crypto.DSA!="undefined"&&S instanceof KJUR.crypto.DSA&&S.isPrivate==true){var P=new KJUR.asn1.DERInteger({bigint:S.x});var Q=P.getEncodedHex();var A=KJUR.asn1.ASN1Util.newObject({seq:[{"int":0},{seq:[{oid:{name:"dsa"}},{seq:[{"int":{bigint:S.p}},{"int":{bigint:S.q}},{"int":{bigint:S.g}}]}]},{octstr:{hex:Q}}]});var G=A.getEncodedHex();if(E===undefined||E==null){return w.ASN1Util.getPEMStringFromHex(G,"PRIVATE KEY")}else{var I=L(G,E);return w.ASN1Util.getPEMStringFromHex(I,"ENCRYPTED PRIVATE KEY")}}throw"unsupported object nor format"};KEYUTIL.getKeyFromCSRPEM=function(d){var e=KEYUTIL.getHexFromPEM(d,"CERTIFICATE REQUEST");var f=KEYUTIL.getKeyFromCSRHex(e);return f};KEYUTIL.getKeyFromCSRHex=function(e){var f=KEYUTIL.parseCSRHex(e);
var d=KEYUTIL.getKey(f.p8pubkeyhex,null,"pkcs8pub");return d};KEYUTIL.parseCSRHex=function(m){var f={};var i=m;if(i.substr(0,2)!="30"){throw"malformed CSR(code:001)"}var j=ASN1HEX.getPosArrayOfChildren_AtObj(i,0);if(j.length<1){throw"malformed CSR(code:002)"}if(i.substr(j[0],2)!="30"){throw"malformed CSR(code:003)"}var h=ASN1HEX.getPosArrayOfChildren_AtObj(i,j[0]);if(h.length<3){throw"malformed CSR(code:004)"}f.p8pubkeyhex=ASN1HEX.getHexOfTLV_AtObj(i,h[2]);return f};
;function _rsapem_pemToBase64(c){var d=c;d=d.replace("-----BEGIN RSA PRIVATE KEY-----","");d=d.replace("-----END RSA PRIVATE KEY-----","");d=d.replace(/[ \n]+/g,"");return d}function _rsapem_getPosArrayOfChildrenFromHex(A){var o=new Array();var n=ASN1HEX.getStartPosOfV_AtObj(A,0);var w=ASN1HEX.getPosOfNextSibling_AtObj(A,n);var u=ASN1HEX.getPosOfNextSibling_AtObj(A,w);var C=ASN1HEX.getPosOfNextSibling_AtObj(A,u);var m=ASN1HEX.getPosOfNextSibling_AtObj(A,C);var y=ASN1HEX.getPosOfNextSibling_AtObj(A,m);var v=ASN1HEX.getPosOfNextSibling_AtObj(A,y);var B=ASN1HEX.getPosOfNextSibling_AtObj(A,v);var r=ASN1HEX.getPosOfNextSibling_AtObj(A,B);o.push(n,w,u,C,m,y,v,B,r);return o}function _rsapem_getHexValueArrayOfChildrenFromHex(y){var e=_rsapem_getPosArrayOfChildrenFromHex(y);var d=ASN1HEX.getHexOfV_AtObj(y,e[0]);var C=ASN1HEX.getHexOfV_AtObj(y,e[1]);var w=ASN1HEX.getHexOfV_AtObj(y,e[2]);var v=ASN1HEX.getHexOfV_AtObj(y,e[3]);var D=ASN1HEX.getHexOfV_AtObj(y,e[4]);var E=ASN1HEX.getHexOfV_AtObj(y,e[5]);var A=ASN1HEX.getHexOfV_AtObj(y,e[6]);var B=ASN1HEX.getHexOfV_AtObj(y,e[7]);var u=ASN1HEX.getHexOfV_AtObj(y,e[8]);var n=new Array();n.push(d,C,w,v,D,E,A,B,u);return n}function _rsapem_readPrivateKeyFromASN1HexString(e){var d=_rsapem_getHexValueArrayOfChildrenFromHex(e);this.setPrivateEx(d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8])}function _rsapem_readPrivateKeyFromPEMString(h){var j=_rsapem_pemToBase64(h);var i=b64tohex(j);var f=_rsapem_getHexValueArrayOfChildrenFromHex(i);this.setPrivateEx(f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8])}RSAKey.prototype.readPrivateKeyFromPEMString=_rsapem_readPrivateKeyFromPEMString;RSAKey.prototype.readPrivateKeyFromASN1HexString=_rsapem_readPrivateKeyFromASN1HexString;
;var _RE_HEXDECONLY=new RegExp("");_RE_HEXDECONLY.compile("[^0-9a-f]","gi");function _rsasign_getHexPaddedDigestInfoForString(j,i,h){var f=function(b){return KJUR.crypto.Util.hashString(b,h)};var m=f(j);return KJUR.crypto.Util.getPaddedDigestInfoHex(m,h,i)}function _zeroPaddingOfSignature(i,j){var m="";var h=j/4-i.length;for(var f=0;f<h;f++){m=m+"0"}return m+i}function _rsasign_signString(h,f){var e=function(b){return KJUR.crypto.Util.hashString(b,f)};var i=e(h);return this.signWithMessageHash(i,f)}function _rsasign_signWithMessageHash(m,o){var j=KJUR.crypto.Util.getPaddedDigestInfoHex(m,o,this.n.bitLength());var h=parseBigInt(j,16);var n=this.doPrivate(h);var i=n.toString(16);return _zeroPaddingOfSignature(i,this.n.bitLength())}function _rsasign_signStringWithSHA1(b){return _rsasign_signString.call(this,b,"sha1")}function _rsasign_signStringWithSHA256(b){return _rsasign_signString.call(this,b,"sha256")}function pss_mgf1_str(m,h,i){var f="",j=0;while(f.length<h){f+=hextorstr(i(rstrtohex(m+String.fromCharCode.apply(String,[(j&4278190080)>>24,(j&16711680)>>16,(j&65280)>>8,j&255]))));j+=1}return f}function _rsasign_signStringPSS(i,h,j){var m=function(b){return KJUR.crypto.Util.hashHex(b,h)};var f=m(rstrtohex(i));if(j===undefined){j=-1}return this.signWithMessageHashPSS(f,h,j)}function _rsasign_signWithMessageHashPSS(y,J,A){var I=hextorstr(y);var D=I.length;var w=this.n.bitLength()-1;var H=Math.ceil(w/8);var G;var u=function(b){return KJUR.crypto.Util.hashHex(b,J)};if(A===-1||A===undefined){A=D}else{if(A===-2){A=H-D-2}else{if(A<-2){throw"invalid salt length"}}}if(H<(D+A+2)){throw"data too long"}var E="";if(A>0){E=new Array(A);new SecureRandom().nextBytes(E);
E=String.fromCharCode.apply(String,E)}var v=hextorstr(u(rstrtohex("\x00\x00\x00\x00\x00\x00\x00\x00"+I+E)));var B=[];for(G=0;G<H-A-D-2;G+=1){B[G]=0}var F=String.fromCharCode.apply(String,B)+"\x01"+E;var C=pss_mgf1_str(v,F.length,u);var i=[];for(G=0;G<F.length;G+=1){i[G]=F.charCodeAt(G)^C.charCodeAt(G)}var r=(65280>>(8*H-w))&255;i[0]&=~r;for(G=0;G<D;G++){i.push(v.charCodeAt(G))}i.push(188);return _zeroPaddingOfSignature(this.doPrivate(new BigInteger(i)).toString(16),this.n.bitLength())}function _rsasign_getDecryptSignatureBI(h,j,m){var f=new RSAKey();f.setPublic(j,m);var i=f.doPublic(h);return i}function _rsasign_getHexDigestInfoFromSig(h,m,f){var i=_rsasign_getDecryptSignatureBI(h,m,f);var j=i.toString(16).replace(/^1f+00/,"");return j}function _rsasign_getAlgNameAndHashFromHexDisgestInfo(i){for(var j in KJUR.crypto.Util.DIGESTINFOHEAD){var m=KJUR.crypto.Util.DIGESTINFOHEAD[j];var h=m.length;if(i.substring(0,h)==m){var n=[j,i.substring(h)];return n}}return[]}function _rsasign_verifySignatureWithArgs(u,A,r,m){var v=_rsasign_getHexDigestInfoFromSig(A,r,m);var o=_rsasign_getAlgNameAndHashFromHexDisgestInfo(v);if(o.length==0){return false}var w=o[0];var n=o[1];var B=function(b){return KJUR.crypto.Util.hashString(b,w)};var y=B(u);return(n==y)}function _rsasign_verifyHexSignatureForMessage(i,e){var h=parseBigInt(i,16);var f=_rsasign_verifySignatureWithArgs(e,h,this.n.toString(16),this.e.toString(16));return f}function _rsasign_verifyString(u,m){m=m.replace(_RE_HEXDECONLY,"");m=m.replace(/[ \n]+/g,"");var A=parseBigInt(m,16);if(A.bitLength()>this.n.bitLength()){return 0}var n=this.doPublic(A);var v=n.toString(16).replace(/^1f+00/,"");var r=_rsasign_getAlgNameAndHashFromHexDisgestInfo(v);if(r.length==0){return false}var w=r[0];var o=r[1];var B=function(b){return KJUR.crypto.Util.hashString(b,w)};var y=B(u);return(o==y)}function _rsasign_verifyWithMessageHash(r,j){j=j.replace(_RE_HEXDECONLY,"");j=j.replace(/[ \n]+/g,"");var i=parseBigInt(j,16);if(i.bitLength()>this.n.bitLength()){return 0}var m=this.doPublic(i);var n=m.toString(16).replace(/^1f+00/,"");var v=_rsasign_getAlgNameAndHashFromHexDisgestInfo(n);if(v.length==0){return false}var u=v[0];var o=v[1];return(o==r)}function _rsasign_verifyStringPSS(o,h,i,j){var m=function(b){return KJUR.crypto.Util.hashHex(b,i)};var n=m(rstrtohex(o));if(j===undefined){j=-1}return this.verifyWithMessageHashPSS(n,h,i,j)}function _rsasign_verifyWithMessageHashPSS(H,i,C,K){var D=new BigInteger(i,16);if(D.bitLength()>this.n.bitLength()){return false}var u=function(b){return KJUR.crypto.Util.hashHex(b,C)};var E=hextorstr(H);var F=E.length;var G=this.n.bitLength()-1;var B=Math.ceil(G/8);var v;if(K===-1||K===undefined){K=F}else{if(K===-2){K=B-F-2}else{if(K<-2){throw"invalid salt length"}}}if(B<(F+K+2)){throw"data too long"}var M=this.doPublic(D).toByteArray();for(v=0;v<M.length;v+=1){M[v]&=255}while(M.length<B){M.unshift(0)}if(M[B-1]!==188){throw"encoded message does not end in 0xbc"}M=String.fromCharCode.apply(String,M);var J=M.substr(0,B-F-1);var I=M.substr(J.length,F);var w=(65280>>(8*B-G))&255;if((J.charCodeAt(0)&w)!==0){throw"bits beyond keysize not zero"}var A=pss_mgf1_str(I,J.length,u);var y=[];for(v=0;v<J.length;v+=1){y[v]=J.charCodeAt(v)^A.charCodeAt(v)}y[0]&=~w;var L=B-F-K-2;for(v=0;v<L;v+=1){if(y[v]!==0){throw"leftmost octets not zero"}}if(y[L]!==1){throw"0x01 marker not found"}return I===hextorstr(u(rstrtohex("\x00\x00\x00\x00\x00\x00\x00\x00"+E+String.fromCharCode.apply(String,y.slice(-K)))))}RSAKey.prototype.signWithMessageHash=_rsasign_signWithMessageHash;RSAKey.prototype.signString=_rsasign_signString;RSAKey.prototype.signStringWithSHA1=_rsasign_signStringWithSHA1;RSAKey.prototype.signStringWithSHA256=_rsasign_signStringWithSHA256;RSAKey.prototype.sign=_rsasign_signString;RSAKey.prototype.signWithSHA1=_rsasign_signStringWithSHA1;RSAKey.prototype.signWithSHA256=_rsasign_signStringWithSHA256;RSAKey.prototype.signWithMessageHashPSS=_rsasign_signWithMessageHashPSS;RSAKey.prototype.signStringPSS=_rsasign_signStringPSS;
RSAKey.prototype.signPSS=_rsasign_signStringPSS;RSAKey.SALT_LEN_HLEN=-1;RSAKey.SALT_LEN_MAX=-2;RSAKey.prototype.verifyWithMessageHash=_rsasign_verifyWithMessageHash;RSAKey.prototype.verifyString=_rsasign_verifyString;RSAKey.prototype.verifyHexSignatureForMessage=_rsasign_verifyHexSignatureForMessage;RSAKey.prototype.verify=_rsasign_verifyString;RSAKey.prototype.verifyHexSignatureForByteArrayMessage=_rsasign_verifyHexSignatureForMessage;RSAKey.prototype.verifyWithMessageHashPSS=_rsasign_verifyWithMessageHashPSS;RSAKey.prototype.verifyStringPSS=_rsasign_verifyStringPSS;RSAKey.prototype.verifyPSS=_rsasign_verifyStringPSS;RSAKey.SALT_LEN_RECOVER=-2;
;function X509(){this.subjectPublicKeyRSA=null;this.subjectPublicKeyRSA_hN=null;this.subjectPublicKeyRSA_hE=null;this.hex=null;this.getSerialNumberHex=function(){return ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,1])};this.getIssuerHex=function(){return ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,3])};this.getIssuerString=function(){return X509.hex2dn(ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,3]))};this.getSubjectHex=function(){return ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,5])};this.getSubjectString=function(){return X509.hex2dn(ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,5]))};this.getNotBefore=function(){var b=ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,4,0]);b=b.replace(/(..)/g,"%$1");b=decodeURIComponent(b);return b};this.getNotAfter=function(){var b=ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,4,1]);b=b.replace(/(..)/g,"%$1");b=decodeURIComponent(b);return b};this.readCertPEM=function(j){var h=X509.pemToHex(j);var f=X509.getPublicKeyHexArrayFromCertHex(h);var i=new RSAKey();i.setPublic(f[0],f[1]);this.subjectPublicKeyRSA=i;this.subjectPublicKeyRSA_hN=f[0];this.subjectPublicKeyRSA_hE=f[1];this.hex=h};this.readCertPEMWithoutRSAInit=function(h){var f=X509.pemToHex(h);var e=X509.getPublicKeyHexArrayFromCertHex(f);this.subjectPublicKeyRSA.setPublic(e[0],e[1]);this.subjectPublicKeyRSA_hN=e[0];this.subjectPublicKeyRSA_hE=e[1];this.hex=f}}X509.pemToBase64=function(d){var c=d;c=c.replace("-----BEGIN CERTIFICATE-----","");c=c.replace("-----END CERTIFICATE-----","");c=c.replace(/[ \n]+/g,"");return c};X509.pemToHex=function(e){var f=X509.pemToBase64(e);var d=b64tohex(f);return d};X509.getSubjectPublicKeyPosFromCertHex=function(i){var j=X509.getSubjectPublicKeyInfoPosFromCertHex(i);if(j==-1){return -1}var h=ASN1HEX.getPosArrayOfChildren_AtObj(i,j);if(h.length!=2){return -1}var m=h[1];if(i.substring(m,m+2)!="03"){return -1}var n=ASN1HEX.getStartPosOfV_AtObj(i,m);if(i.substring(n,n+2)!="00"){return -1}return n+2};X509.getSubjectPublicKeyInfoPosFromCertHex=function(f){var h=ASN1HEX.getStartPosOfV_AtObj(f,0);var e=ASN1HEX.getPosArrayOfChildren_AtObj(f,h);if(e.length<1){return -1}if(f.substring(e[0],e[0]+10)=="a003020102"){if(e.length<6){return -1}return e[6]}else{if(e.length<5){return -1}return e[5]}};X509.getPublicKeyHexArrayFromCertHex=function(i){var j=X509.getSubjectPublicKeyPosFromCertHex(i);var h=ASN1HEX.getPosArrayOfChildren_AtObj(i,j);if(h.length!=2){return[]}var m=ASN1HEX.getHexOfV_AtObj(i,h[0]);var n=ASN1HEX.getHexOfV_AtObj(i,h[1]);if(m!=null&&n!=null){return[m,n]}else{return[]}};X509.getHexTbsCertificateFromCert=function(c){var d=ASN1HEX.getStartPosOfV_AtObj(c,0);return d};X509.getPublicKeyHexArrayFromCertPEM=function(h){var f=X509.pemToHex(h);var e=X509.getPublicKeyHexArrayFromCertHex(f);return e};X509.hex2dn=function(j){var i="";var n=ASN1HEX.getPosArrayOfChildren_AtObj(j,0);for(var m=0;m<n.length;m++){var h=ASN1HEX.getHexOfTLV_AtObj(j,n[m]);i=i+"/"+X509.hex2rdn(h)}return i};X509.hex2rdn=function(i){var j=ASN1HEX.getDecendantHexTLVByNthList(i,0,[0,0]);var m=ASN1HEX.getDecendantHexVByNthList(i,0,[0,1]);var o="";try{o=X509.DN_ATTRHEX[j]}catch(h){o=j}m=m.replace(/(..)/g,"%$1");var n=decodeURIComponent(m);return o+"="+n};X509.DN_ATTRHEX={"0603550406":"C","060355040a":"O","060355040b":"OU","0603550403":"CN","0603550405":"SN","0603550408":"ST","0603550407":"L"};
X509.getPublicKeyFromCertPEM=function(r){var w=X509.getPublicKeyInfoPropOfCertPEM(r);if(w.algoid=="2a864886f70d010101"){var n=KEYUTIL.parsePublicRawRSAKeyHex(w.keyhex);var m=new RSAKey();m.setPublic(n.n,n.e);return m}else{if(w.algoid=="2a8648ce3d0201"){var u=KJUR.crypto.OID.oidhex2name[w.algparam];var m=new KJUR.crypto.ECDSA({curve:u,info:w.keyhex});m.setPublicKeyHex(w.keyhex);return m}else{if(w.algoid=="2a8648ce380401"){var y=ASN1HEX.getVbyList(w.algparam,0,[0],"02");var A=ASN1HEX.getVbyList(w.algparam,0,[1],"02");var v=ASN1HEX.getVbyList(w.algparam,0,[2],"02");var o=ASN1HEX.getHexOfV_AtObj(w.keyhex,0);o=o.substr(2);var m=new KJUR.crypto.DSA();m.setPublic(new BigInteger(y,16),new BigInteger(A,16),new BigInteger(v,16),new BigInteger(o,16));return m}else{throw"unsupported key"}}}};X509.getPublicKeyInfoPropOfCertPEM=function(r){var v={};v.algparam=null;var n=X509.pemToHex(r);var u=ASN1HEX.getPosArrayOfChildren_AtObj(n,0);if(u.length!=3){throw"malformed X.509 certificate PEM (code:001)"}if(n.substr(u[0],2)!="30"){throw"malformed X.509 certificate PEM (code:002)"}var i=ASN1HEX.getPosArrayOfChildren_AtObj(n,u[0]);if(i.length<7){throw"malformed X.509 certificate PEM (code:003)"}var m=ASN1HEX.getPosArrayOfChildren_AtObj(n,i[6]);if(m.length!=2){throw"malformed X.509 certificate PEM (code:004)"}var o=ASN1HEX.getPosArrayOfChildren_AtObj(n,m[0]);if(o.length!=2){throw"malformed X.509 certificate PEM (code:005)"}v.algoid=ASN1HEX.getHexOfV_AtObj(n,o[0]);if(n.substr(o[1],2)=="06"){v.algparam=ASN1HEX.getHexOfV_AtObj(n,o[1])}else{if(n.substr(o[1],2)=="30"){v.algparam=ASN1HEX.getHexOfTLV_AtObj(n,o[1])}}if(n.substr(m[1],2)!="03"){throw"malformed X.509 certificate PEM (code:006)"}var j=ASN1HEX.getHexOfV_AtObj(n,m[1]);v.keyhex=j.substr(2);return v};function certParser(h){var r=h.split("\n");var b=false;var c=false;var d=false;var m="";var e={};e.info="";e.salt="";e.iv;e.b64="";e.aes=false;e.mode="";e.bits=0;for(var j=0;j<r.length;j++){m=r[j].substr(0,9);if(j==1&&m!="Proc-Type"&&m.indexOf("M")==0){c=true}switch(m){case"-----BEGI":b=true;break;case"Proc-Type":if(b){e.info=r[j]}break;case"DEK-Info:":if(b){var f=r[j].split(",");var o=f[0].split(": ");var n=o[1].split("-");e.aes=(n[0]=="AES")?true:false;e.mode=n[2];e.bits=parseInt(n[1]);e.salt=f[1].substr(0,16);e.iv=f[1]}break;case"":if(b){c=true}break;case"-----END ":if(b){c=false;b=false}break;default:if(b&&c){e.b64+=cgjsCryptUtil.stripLineFeeds(r[j])}}}return e}cgjsCrypt.CertEncrypt=function(b,j,f){var d={};var r="";var e="";var i="";d=certParser(b);if(d.b64){var m=cgjsCryptUtil.decodeBase64(d.b64);var h=new cgjsCrypt.RSA();var c=cgjsCrypt.ASN1.decode(cgjsCryptUtil.toByteArray(m));var o=c.toHexTree();h.setPublicKeyFromASN(o);var n=new Date();i=h.encrypt(j);i=cgjsCryptUtil.fragment(cgjsCryptUtil.encodeBase64(cgjsCryptUtil.convertFromHex(i)),64)}else{throw ("9003")}return i};cgjsCrypt.PEMCertEncrypt=function(d,m,e){var b={};var o="";var c="";var h="";var i=X509.pemToHex(d);var j=X509.getPublicKeyHexArrayFromCertHex(i);var f=new RSAKey();f.setPublic(j[0],j[1]);var n=new Date();h=f.encrypt(m);h=cgjsCryptUtil.fragment(cgjsCryptUtil.encodeBase64(cgjsCryptUtil.convertFromHex(h)),64);return h};